(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();function to(s){const t=Object.create(null);for(const e of s.split(","))t[e]=1;return e=>e in t}const gt={},Os=[],Me=()=>{},Na=()=>!1,bn=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&(s.charCodeAt(2)>122||s.charCodeAt(2)<97),eo=s=>s.startsWith("onUpdate:"),zt=Object.assign,so=(s,t)=>{const e=s.indexOf(t);e>-1&&s.splice(e,1)},qh=Object.prototype.hasOwnProperty,ft=(s,t)=>qh.call(s,t),tt=Array.isArray,Ls=s=>Ei(s)==="[object Map]",Ws=s=>Ei(s)==="[object Set]",Wo=s=>Ei(s)==="[object Date]",rt=s=>typeof s=="function",Lt=s=>typeof s=="string",me=s=>typeof s=="symbol",yt=s=>s!==null&&typeof s=="object",$a=s=>(yt(s)||rt(s))&&rt(s.then)&&rt(s.catch),Da=Object.prototype.toString,Ei=s=>Da.call(s),Wh=s=>Ei(s).slice(8,-1),Ia=s=>Ei(s)==="[object Object]",io=s=>Lt(s)&&s!=="NaN"&&s[0]!=="-"&&""+parseInt(s,10)===s,si=to(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),yn=s=>{const t=Object.create(null);return(e=>t[e]||(t[e]=s(e)))},Hh=/-\w/g,os=yn(s=>s.replace(Hh,t=>t.slice(1).toUpperCase())),Kh=/\B([A-Z])/g,as=yn(s=>s.replace(Kh,"-$1").toLowerCase()),Ba=yn(s=>s.charAt(0).toUpperCase()+s.slice(1)),Fn=yn(s=>s?`on${Ba(s)}`:""),is=(s,t)=>!Object.is(s,t),Yi=(s,...t)=>{for(let e=0;e<s.length;e++)s[e](...t)},Va=(s,t,e,i=!1)=>{Object.defineProperty(s,t,{configurable:!0,enumerable:!1,writable:i,value:e})},_n=s=>{const t=parseFloat(s);return isNaN(t)?s:t};let Ho;const wn=()=>Ho||(Ho=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Sn(s){if(tt(s)){const t={};for(let e=0;e<s.length;e++){const i=s[e],n=Lt(i)?Xh(i):Sn(i);if(n)for(const r in n)t[r]=n[r]}return t}else if(Lt(s)||yt(s))return s}const jh=/;(?![^(]*\))/g,Gh=/:([^]+)/,Jh=/\/\*[^]*?\*\//g;function Xh(s){const t={};return s.replace(Jh,"").split(jh).forEach(e=>{if(e){const i=e.split(Gh);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function bs(s){let t="";if(Lt(s))t=s;else if(tt(s))for(let e=0;e<s.length;e++){const i=bs(s[e]);i&&(t+=i+" ")}else if(yt(s))for(const e in s)s[e]&&(t+=e+" ");return t.trim()}const Yh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Qh=to(Yh);function Fa(s){return!!s||s===""}function Zh(s,t){if(s.length!==t.length)return!1;let e=!0;for(let i=0;e&&i<s.length;i++)e=Ti(s[i],t[i]);return e}function Ti(s,t){if(s===t)return!0;let e=Wo(s),i=Wo(t);if(e||i)return e&&i?s.getTime()===t.getTime():!1;if(e=me(s),i=me(t),e||i)return s===t;if(e=tt(s),i=tt(t),e||i)return e&&i?Zh(s,t):!1;if(e=yt(s),i=yt(t),e||i){if(!e||!i)return!1;const n=Object.keys(s).length,r=Object.keys(t).length;if(n!==r)return!1;for(const o in s){const l=s.hasOwnProperty(o),a=t.hasOwnProperty(o);if(l&&!a||!l&&a||!Ti(s[o],t[o]))return!1}}return String(s)===String(t)}function no(s,t){return s.findIndex(e=>Ti(e,t))}const Ua=s=>!!(s&&s.__v_isRef===!0),x=s=>Lt(s)?s:s==null?"":tt(s)||yt(s)&&(s.toString===Da||!rt(s.toString))?Ua(s)?x(s.value):JSON.stringify(s,za,2):String(s),za=(s,t)=>Ua(t)?za(s,t.value):Ls(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[i,n],r)=>(e[Un(i,r)+" =>"]=n,e),{})}:Ws(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Un(e))}:me(t)?Un(t):yt(t)&&!tt(t)&&!Ia(t)?String(t):t,Un=(s,t="")=>{var e;return me(s)?`Symbol(${(e=s.description)!=null?e:t})`:s};let se;class tc{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=se,!t&&se&&(this.index=(se.scopes||(se.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=se;try{return se=this,t()}finally{se=e}}}on(){++this._on===1&&(this.prevScope=se,se=this)}off(){this._on>0&&--this._on===0&&(se=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,i;for(e=0,i=this.effects.length;e<i;e++)this.effects[e].stop();for(this.effects.length=0,e=0,i=this.cleanups.length;e<i;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function ec(){return se}let wt;const zn=new WeakSet;class qa{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,se&&se.active&&se.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,zn.has(this)&&(zn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ha(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ko(this),Ka(this);const t=wt,e=fe;wt=this,fe=!0;try{return this.fn()}finally{ja(this),wt=t,fe=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)lo(t);this.deps=this.depsTail=void 0,Ko(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?zn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){xr(this)&&this.run()}get dirty(){return xr(this)}}let Wa=0,ii,ni;function Ha(s,t=!1){if(s.flags|=8,t){s.next=ni,ni=s;return}s.next=ii,ii=s}function ro(){Wa++}function oo(){if(--Wa>0)return;if(ni){let t=ni;for(ni=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let s;for(;ii;){let t=ii;for(ii=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){s||(s=i)}t=e}}if(s)throw s}function Ka(s){for(let t=s.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function ja(s){let t,e=s.depsTail,i=e;for(;i;){const n=i.prevDep;i.version===-1?(i===e&&(e=n),lo(i),sc(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=n}s.deps=t,s.depsTail=e}function xr(s){for(let t=s.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ga(t.dep.computed)||t.dep.version!==t.version))return!0;return!!s._dirty}function Ga(s){if(s.flags&4&&!(s.flags&16)||(s.flags&=-17,s.globalVersion===fi)||(s.globalVersion=fi,!s.isSSR&&s.flags&128&&(!s.deps&&!s._dirty||!xr(s))))return;s.flags|=2;const t=s.dep,e=wt,i=fe;wt=s,fe=!0;try{Ka(s);const n=s.fn(s._value);(t.version===0||is(n,s._value))&&(s.flags|=128,s._value=n,t.version++)}catch(n){throw t.version++,n}finally{wt=e,fe=i,ja(s),s.flags&=-3}}function lo(s,t=!1){const{dep:e,prevSub:i,nextSub:n}=s;if(i&&(i.nextSub=n,s.prevSub=void 0),n&&(n.prevSub=i,s.nextSub=void 0),e.subs===s&&(e.subs=i,!i&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)lo(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function sc(s){const{prevDep:t,nextDep:e}=s;t&&(t.nextDep=e,s.prevDep=void 0),e&&(e.prevDep=t,s.nextDep=void 0)}let fe=!0;const Ja=[];function qe(){Ja.push(fe),fe=!1}function We(){const s=Ja.pop();fe=s===void 0?!0:s}function Ko(s){const{cleanup:t}=s;if(s.cleanup=void 0,t){const e=wt;wt=void 0;try{t()}finally{wt=e}}}let fi=0;class ic{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ao{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!wt||!fe||wt===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==wt)e=this.activeLink=new ic(wt,this),wt.deps?(e.prevDep=wt.depsTail,wt.depsTail.nextDep=e,wt.depsTail=e):wt.deps=wt.depsTail=e,Xa(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const i=e.nextDep;i.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=i),e.prevDep=wt.depsTail,e.nextDep=void 0,wt.depsTail.nextDep=e,wt.depsTail=e,wt.deps===e&&(wt.deps=i)}return e}trigger(t){this.version++,fi++,this.notify(t)}notify(t){ro();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{oo()}}}function Xa(s){if(s.dep.sc++,s.sub.flags&4){const t=s.dep.computed;if(t&&!s.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)Xa(i)}const e=s.dep.subs;e!==s&&(s.prevSub=e,e&&(e.nextSub=s)),s.dep.subs=s}}const Cr=new WeakMap,ms=Symbol(""),Er=Symbol(""),pi=Symbol("");function Vt(s,t,e){if(fe&&wt){let i=Cr.get(s);i||Cr.set(s,i=new Map);let n=i.get(e);n||(i.set(e,n=new ao),n.map=i,n.key=e),n.track()}}function Be(s,t,e,i,n,r){const o=Cr.get(s);if(!o){fi++;return}const l=a=>{a&&a.trigger()};if(ro(),t==="clear")o.forEach(l);else{const a=tt(s),u=a&&io(e);if(a&&e==="length"){const c=Number(i);o.forEach((d,f)=>{(f==="length"||f===pi||!me(f)&&f>=c)&&l(d)})}else switch((e!==void 0||o.has(void 0))&&l(o.get(e)),u&&l(o.get(pi)),t){case"add":a?u&&l(o.get("length")):(l(o.get(ms)),Ls(s)&&l(o.get(Er)));break;case"delete":a||(l(o.get(ms)),Ls(s)&&l(o.get(Er)));break;case"set":Ls(s)&&l(o.get(ms));break}}oo()}function Cs(s){const t=dt(s);return t===s?t:(Vt(t,"iterate",pi),ce(s)?t:t.map(ve))}function xn(s){return Vt(s=dt(s),"iterate",pi),s}function Qe(s,t){return He(s)?vs(s)?Ds(ve(t)):Ds(t):ve(t)}const nc={__proto__:null,[Symbol.iterator](){return qn(this,Symbol.iterator,s=>Qe(this,s))},concat(...s){return Cs(this).concat(...s.map(t=>tt(t)?Cs(t):t))},entries(){return qn(this,"entries",s=>(s[1]=Qe(this,s[1]),s))},every(s,t){return $e(this,"every",s,t,void 0,arguments)},filter(s,t){return $e(this,"filter",s,t,e=>e.map(i=>Qe(this,i)),arguments)},find(s,t){return $e(this,"find",s,t,e=>Qe(this,e),arguments)},findIndex(s,t){return $e(this,"findIndex",s,t,void 0,arguments)},findLast(s,t){return $e(this,"findLast",s,t,e=>Qe(this,e),arguments)},findLastIndex(s,t){return $e(this,"findLastIndex",s,t,void 0,arguments)},forEach(s,t){return $e(this,"forEach",s,t,void 0,arguments)},includes(...s){return Wn(this,"includes",s)},indexOf(...s){return Wn(this,"indexOf",s)},join(s){return Cs(this).join(s)},lastIndexOf(...s){return Wn(this,"lastIndexOf",s)},map(s,t){return $e(this,"map",s,t,void 0,arguments)},pop(){return Js(this,"pop")},push(...s){return Js(this,"push",s)},reduce(s,...t){return jo(this,"reduce",s,t)},reduceRight(s,...t){return jo(this,"reduceRight",s,t)},shift(){return Js(this,"shift")},some(s,t){return $e(this,"some",s,t,void 0,arguments)},splice(...s){return Js(this,"splice",s)},toReversed(){return Cs(this).toReversed()},toSorted(s){return Cs(this).toSorted(s)},toSpliced(...s){return Cs(this).toSpliced(...s)},unshift(...s){return Js(this,"unshift",s)},values(){return qn(this,"values",s=>Qe(this,s))}};function qn(s,t,e){const i=xn(s),n=i[t]();return i!==s&&!ce(s)&&(n._next=n.next,n.next=()=>{const r=n._next();return r.done||(r.value=e(r.value)),r}),n}const rc=Array.prototype;function $e(s,t,e,i,n,r){const o=xn(s),l=o!==s&&!ce(s),a=o[t];if(a!==rc[t]){const d=a.apply(s,r);return l?ve(d):d}let u=e;o!==s&&(l?u=function(d,f){return e.call(this,Qe(s,d),f,s)}:e.length>2&&(u=function(d,f){return e.call(this,d,f,s)}));const c=a.call(o,u,i);return l&&n?n(c):c}function jo(s,t,e,i){const n=xn(s);let r=e;return n!==s&&(ce(s)?e.length>3&&(r=function(o,l,a){return e.call(this,o,l,a,s)}):r=function(o,l,a){return e.call(this,o,Qe(s,l),a,s)}),n[t](r,...i)}function Wn(s,t,e){const i=dt(s);Vt(i,"iterate",pi);const n=i[t](...e);return(n===-1||n===!1)&&co(e[0])?(e[0]=dt(e[0]),i[t](...e)):n}function Js(s,t,e=[]){qe(),ro();const i=dt(s)[t].apply(s,e);return oo(),We(),i}const oc=to("__proto__,__v_isRef,__isVue"),Ya=new Set(Object.getOwnPropertyNames(Symbol).filter(s=>s!=="arguments"&&s!=="caller").map(s=>Symbol[s]).filter(me));function lc(s){me(s)||(s=String(s));const t=dt(this);return Vt(t,"has",s),t.hasOwnProperty(s)}class Qa{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,i){if(e==="__v_skip")return t.__v_skip;const n=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!n;if(e==="__v_isReadonly")return n;if(e==="__v_isShallow")return r;if(e==="__v_raw")return i===(n?r?gc:su:r?eu:tu).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const o=tt(t);if(!n){let a;if(o&&(a=nc[e]))return a;if(e==="hasOwnProperty")return lc}const l=Reflect.get(t,e,Ut(t)?t:i);if((me(e)?Ya.has(e):oc(e))||(n||Vt(t,"get",e),r))return l;if(Ut(l)){const a=o&&io(e)?l:l.value;return n&&yt(a)?kr(a):a}return yt(l)?n?kr(l):Gt(l):l}}class Za extends Qa{constructor(t=!1){super(!1,t)}set(t,e,i,n){let r=t[e];const o=tt(t)&&io(e);if(!this._isShallow){const u=He(r);if(!ce(i)&&!He(i)&&(r=dt(r),i=dt(i)),!o&&Ut(r)&&!Ut(i))return u||(r.value=i),!0}const l=o?Number(e)<t.length:ft(t,e),a=Reflect.set(t,e,i,Ut(t)?t:n);return t===dt(n)&&(l?is(i,r)&&Be(t,"set",e,i):Be(t,"add",e,i)),a}deleteProperty(t,e){const i=ft(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&i&&Be(t,"delete",e,void 0),n}has(t,e){const i=Reflect.has(t,e);return(!me(e)||!Ya.has(e))&&Vt(t,"has",e),i}ownKeys(t){return Vt(t,"iterate",tt(t)?"length":ms),Reflect.ownKeys(t)}}class ac extends Qa{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const uc=new Za,hc=new ac,cc=new Za(!0);const Tr=s=>s,Ri=s=>Reflect.getPrototypeOf(s);function dc(s,t,e){return function(...i){const n=this.__v_raw,r=dt(n),o=Ls(r),l=s==="entries"||s===Symbol.iterator&&o,a=s==="keys"&&o,u=n[s](...i),c=e?Tr:t?Ds:ve;return!t&&Vt(r,"iterate",a?Er:ms),{next(){const{value:d,done:f}=u.next();return f?{value:d,done:f}:{value:l?[c(d[0]),c(d[1])]:c(d),done:f}},[Symbol.iterator](){return this}}}}function Ni(s){return function(...t){return s==="delete"?!1:s==="clear"?void 0:this}}function fc(s,t){const e={get(n){const r=this.__v_raw,o=dt(r),l=dt(n);s||(is(n,l)&&Vt(o,"get",n),Vt(o,"get",l));const{has:a}=Ri(o),u=t?Tr:s?Ds:ve;if(a.call(o,n))return u(r.get(n));if(a.call(o,l))return u(r.get(l));r!==o&&r.get(n)},get size(){const n=this.__v_raw;return!s&&Vt(dt(n),"iterate",ms),n.size},has(n){const r=this.__v_raw,o=dt(r),l=dt(n);return s||(is(n,l)&&Vt(o,"has",n),Vt(o,"has",l)),n===l?r.has(n):r.has(n)||r.has(l)},forEach(n,r){const o=this,l=o.__v_raw,a=dt(l),u=t?Tr:s?Ds:ve;return!s&&Vt(a,"iterate",ms),l.forEach((c,d)=>n.call(r,u(c),u(d),o))}};return zt(e,s?{add:Ni("add"),set:Ni("set"),delete:Ni("delete"),clear:Ni("clear")}:{add(n){!t&&!ce(n)&&!He(n)&&(n=dt(n));const r=dt(this);return Ri(r).has.call(r,n)||(r.add(n),Be(r,"add",n,n)),this},set(n,r){!t&&!ce(r)&&!He(r)&&(r=dt(r));const o=dt(this),{has:l,get:a}=Ri(o);let u=l.call(o,n);u||(n=dt(n),u=l.call(o,n));const c=a.call(o,n);return o.set(n,r),u?is(r,c)&&Be(o,"set",n,r):Be(o,"add",n,r),this},delete(n){const r=dt(this),{has:o,get:l}=Ri(r);let a=o.call(r,n);a||(n=dt(n),a=o.call(r,n)),l&&l.call(r,n);const u=r.delete(n);return a&&Be(r,"delete",n,void 0),u},clear(){const n=dt(this),r=n.size!==0,o=n.clear();return r&&Be(n,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=dc(n,s,t)}),e}function uo(s,t){const e=fc(s,t);return(i,n,r)=>n==="__v_isReactive"?!s:n==="__v_isReadonly"?s:n==="__v_raw"?i:Reflect.get(ft(e,n)&&n in i?e:i,n,r)}const pc={get:uo(!1,!1)},mc={get:uo(!1,!0)},vc={get:uo(!0,!1)};const tu=new WeakMap,eu=new WeakMap,su=new WeakMap,gc=new WeakMap;function bc(s){switch(s){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function yc(s){return s.__v_skip||!Object.isExtensible(s)?0:bc(Wh(s))}function Gt(s){return He(s)?s:ho(s,!1,uc,pc,tu)}function iu(s){return ho(s,!1,cc,mc,eu)}function kr(s){return ho(s,!0,hc,vc,su)}function ho(s,t,e,i,n){if(!yt(s)||s.__v_raw&&!(t&&s.__v_isReactive))return s;const r=yc(s);if(r===0)return s;const o=n.get(s);if(o)return o;const l=new Proxy(s,r===2?i:e);return n.set(s,l),l}function vs(s){return He(s)?vs(s.__v_raw):!!(s&&s.__v_isReactive)}function He(s){return!!(s&&s.__v_isReadonly)}function ce(s){return!!(s&&s.__v_isShallow)}function co(s){return s?!!s.__v_raw:!1}function dt(s){const t=s&&s.__v_raw;return t?dt(t):s}function _c(s){return!ft(s,"__v_skip")&&Object.isExtensible(s)&&Va(s,"__v_skip",!0),s}const ve=s=>yt(s)?Gt(s):s,Ds=s=>yt(s)?kr(s):s;function Ut(s){return s?s.__v_isRef===!0:!1}function $(s){return nu(s,!1)}function wc(s){return nu(s,!0)}function nu(s,t){return Ut(s)?s:new Sc(s,t)}class Sc{constructor(t,e){this.dep=new ao,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:dt(t),this._value=e?t:ve(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,i=this.__v_isShallow||ce(t)||He(t);t=i?t:dt(t),is(t,e)&&(this._rawValue=t,this._value=i?t:ve(t),this.dep.trigger())}}function Ct(s){return Ut(s)?s.value:s}const xc={get:(s,t,e)=>t==="__v_raw"?s:Ct(Reflect.get(s,t,e)),set:(s,t,e,i)=>{const n=s[t];return Ut(n)&&!Ut(e)?(n.value=e,!0):Reflect.set(s,t,e,i)}};function ru(s){return vs(s)?s:new Proxy(s,xc)}class Cc{constructor(t,e,i){this.fn=t,this.setter=e,this._value=void 0,this.dep=new ao(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=fi-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&wt!==this)return Ha(this,!0),!0}get value(){const t=this.dep.track();return Ga(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Ec(s,t,e=!1){let i,n;return rt(s)?i=s:(i=s.get,n=s.set),new Cc(i,n,e)}const $i={},an=new WeakMap;let fs;function Tc(s,t=!1,e=fs){if(e){let i=an.get(e);i||an.set(e,i=[]),i.push(s)}}function kc(s,t,e=gt){const{immediate:i,deep:n,once:r,scheduler:o,augmentJob:l,call:a}=e,u=D=>n?D:ce(D)||n===!1||n===0?Ve(D,1):Ve(D);let c,d,f,p,v=!1,g=!1;if(Ut(s)?(d=()=>s.value,v=ce(s)):vs(s)?(d=()=>u(s),v=!0):tt(s)?(g=!0,v=s.some(D=>vs(D)||ce(D)),d=()=>s.map(D=>{if(Ut(D))return D.value;if(vs(D))return u(D);if(rt(D))return a?a(D,2):D()})):rt(s)?t?d=a?()=>a(s,2):s:d=()=>{if(f){qe();try{f()}finally{We()}}const D=fs;fs=c;try{return a?a(s,3,[p]):s(p)}finally{fs=D}}:d=Me,t&&n){const D=d,X=n===!0?1/0:n;d=()=>Ve(D(),X)}const _=ec(),w=()=>{c.stop(),_&&_.active&&so(_.effects,c)};if(r&&t){const D=t;t=(...X)=>{D(...X),w()}}let y=g?new Array(s.length).fill($i):$i;const M=D=>{if(!(!(c.flags&1)||!c.dirty&&!D))if(t){const X=c.run();if(n||v||(g?X.some((nt,Z)=>is(nt,y[Z])):is(X,y))){f&&f();const nt=fs;fs=c;try{const Z=[X,y===$i?void 0:g&&y[0]===$i?[]:y,p];y=X,a?a(t,3,Z):t(...Z)}finally{fs=nt}}}else c.run()};return l&&l(M),c=new qa(d),c.scheduler=o?()=>o(M,!1):M,p=D=>Tc(D,!1,c),f=c.onStop=()=>{const D=an.get(c);if(D){if(a)a(D,4);else for(const X of D)X();an.delete(c)}},t?i?M(!0):y=c.run():o?o(M.bind(null,!0),!0):c.run(),w.pause=c.pause.bind(c),w.resume=c.resume.bind(c),w.stop=w,w}function Ve(s,t=1/0,e){if(t<=0||!yt(s)||s.__v_skip||(e=e||new Map,(e.get(s)||0)>=t))return s;if(e.set(s,t),t--,Ut(s))Ve(s.value,t,e);else if(tt(s))for(let i=0;i<s.length;i++)Ve(s[i],t,e);else if(Ws(s)||Ls(s))s.forEach(i=>{Ve(i,t,e)});else if(Ia(s)){for(const i in s)Ve(s[i],t,e);for(const i of Object.getOwnPropertySymbols(s))Object.prototype.propertyIsEnumerable.call(s,i)&&Ve(s[i],t,e)}return s}function ki(s,t,e,i){try{return i?s(...i):s()}catch(n){Cn(n,t,e)}}function Le(s,t,e,i){if(rt(s)){const n=ki(s,t,e,i);return n&&$a(n)&&n.catch(r=>{Cn(r,t,e)}),n}if(tt(s)){const n=[];for(let r=0;r<s.length;r++)n.push(Le(s[r],t,e,i));return n}}function Cn(s,t,e,i=!0){const n=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||gt;if(t){let l=t.parent;const a=t.proxy,u=`https://vuejs.org/error-reference/#runtime-${e}`;for(;l;){const c=l.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](s,a,u)===!1)return}l=l.parent}if(r){qe(),ki(r,null,10,[s,a,u]),We();return}}Mc(s,e,n,i,o)}function Mc(s,t,e,i=!0,n=!1){if(n)throw s;console.error(s)}const Kt=[];let Ee=-1;const Ps=[];let Ze=null,Ts=0;const ou=Promise.resolve();let un=null;function Is(s){const t=un||ou;return s?t.then(this?s.bind(this):s):t}function Ac(s){let t=Ee+1,e=Kt.length;for(;t<e;){const i=t+e>>>1,n=Kt[i],r=mi(n);r<s||r===s&&n.flags&2?t=i+1:e=i}return t}function fo(s){if(!(s.flags&1)){const t=mi(s),e=Kt[Kt.length-1];!e||!(s.flags&2)&&t>=mi(e)?Kt.push(s):Kt.splice(Ac(t),0,s),s.flags|=1,lu()}}function lu(){un||(un=ou.then(uu))}function Oc(s){tt(s)?Ps.push(...s):Ze&&s.id===-1?Ze.splice(Ts+1,0,s):s.flags&1||(Ps.push(s),s.flags|=1),lu()}function Go(s,t,e=Ee+1){for(;e<Kt.length;e++){const i=Kt[e];if(i&&i.flags&2){if(s&&i.id!==s.uid)continue;Kt.splice(e,1),e--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function au(s){if(Ps.length){const t=[...new Set(Ps)].sort((e,i)=>mi(e)-mi(i));if(Ps.length=0,Ze){Ze.push(...t);return}for(Ze=t,Ts=0;Ts<Ze.length;Ts++){const e=Ze[Ts];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Ze=null,Ts=0}}const mi=s=>s.id==null?s.flags&2?-1:1/0:s.id;function uu(s){try{for(Ee=0;Ee<Kt.length;Ee++){const t=Kt[Ee];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),ki(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ee<Kt.length;Ee++){const t=Kt[Ee];t&&(t.flags&=-2)}Ee=-1,Kt.length=0,au(),un=null,(Kt.length||Ps.length)&&uu()}}let Ft=null,hu=null;function hn(s){const t=Ft;return Ft=s,hu=s&&s.type.__scopeId||null,t}function bt(s,t=Ft,e){if(!t||s._n)return s;const i=(...n)=>{i._d&&fn(-1);const r=hn(t);let o;try{o=s(...n)}finally{hn(r),i._d&&fn(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function et(s,t){if(Ft===null)return s;const e=Mn(Ft),i=s.dirs||(s.dirs=[]);for(let n=0;n<t.length;n++){let[r,o,l,a=gt]=t[n];r&&(rt(r)&&(r={mounted:r,updated:r}),r.deep&&Ve(o),i.push({dir:r,instance:e,value:o,oldValue:void 0,arg:l,modifiers:a}))}return s}function us(s,t,e,i){const n=s.dirs,r=t&&t.dirs;for(let o=0;o<n.length;o++){const l=n[o];r&&(l.oldValue=r[o].value);let a=l.dir[i];a&&(qe(),Le(a,e,8,[s.el,l,s,t]),We())}}function Qi(s,t){if(jt){let e=jt.provides;const i=jt.parent&&jt.parent.provides;i===e&&(e=jt.provides=Object.create(i)),e[s]=t}}function pe(s,t,e=!1){const i=kd();if(i||Ns){let n=Ns?Ns._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(n&&s in n)return n[s];if(arguments.length>1)return e&&rt(t)?t.call(i&&i.proxy):t}}const Lc=Symbol.for("v-scx"),Pc=()=>pe(Lc);function ns(s,t,e){return cu(s,t,e)}function cu(s,t,e=gt){const{immediate:i,deep:n,flush:r,once:o}=e,l=zt({},e),a=t&&i||!t&&r!=="post";let u;if(bi){if(r==="sync"){const p=Pc();u=p.__watcherHandles||(p.__watcherHandles=[])}else if(!a){const p=()=>{};return p.stop=Me,p.resume=Me,p.pause=Me,p}}const c=jt;l.call=(p,v,g)=>Le(p,c,v,g);let d=!1;r==="post"?l.scheduler=p=>{oe(p,c&&c.suspense)}:r!=="sync"&&(d=!0,l.scheduler=(p,v)=>{v?p():fo(p)}),l.augmentJob=p=>{t&&(p.flags|=4),d&&(p.flags|=2,c&&(p.id=c.uid,p.i=c))};const f=kc(s,t,l);return bi&&(u?u.push(f):a&&f()),f}function Rc(s,t,e){const i=this.proxy,n=Lt(s)?s.includes(".")?du(i,s):()=>i[s]:s.bind(i,i);let r;rt(t)?r=t:(r=t.handler,e=t);const o=Mi(this),l=cu(n,r.bind(i),e);return o(),l}function du(s,t){const e=t.split(".");return()=>{let i=s;for(let n=0;n<e.length&&i;n++)i=i[e[n]];return i}}const Nc=Symbol("_vte"),$c=s=>s.__isTeleport,Dc=Symbol("_leaveCb");function po(s,t){s.shapeFlag&6&&s.component?(s.transition=t,po(s.component.subTree,t)):s.shapeFlag&128?(s.ssContent.transition=t.clone(s.ssContent),s.ssFallback.transition=t.clone(s.ssFallback)):s.transition=t}function fu(s,t){return rt(s)?zt({name:s.name},t,{setup:s}):s}function pu(s){s.ids=[s.ids[0]+s.ids[2]+++"-",0,0]}const cn=new WeakMap;function ri(s,t,e,i,n=!1){if(tt(s)){s.forEach((v,g)=>ri(v,t&&(tt(t)?t[g]:t),e,i,n));return}if(Rs(i)&&!n){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&ri(s,t,e,i.component.subTree);return}const r=i.shapeFlag&4?Mn(i.component):i.el,o=n?null:r,{i:l,r:a}=s,u=t&&t.r,c=l.refs===gt?l.refs={}:l.refs,d=l.setupState,f=dt(d),p=d===gt?Na:v=>ft(f,v);if(u!=null&&u!==a){if(Jo(t),Lt(u))c[u]=null,p(u)&&(d[u]=null);else if(Ut(u)){u.value=null;const v=t;v.k&&(c[v.k]=null)}}if(rt(a))ki(a,l,12,[o,c]);else{const v=Lt(a),g=Ut(a);if(v||g){const _=()=>{if(s.f){const w=v?p(a)?d[a]:c[a]:a.value;if(n)tt(w)&&so(w,r);else if(tt(w))w.includes(r)||w.push(r);else if(v)c[a]=[r],p(a)&&(d[a]=c[a]);else{const y=[r];a.value=y,s.k&&(c[s.k]=y)}}else v?(c[a]=o,p(a)&&(d[a]=o)):g&&(a.value=o,s.k&&(c[s.k]=o))};if(o){const w=()=>{_(),cn.delete(s)};w.id=-1,cn.set(s,w),oe(w,e)}else Jo(s),_()}}}function Jo(s){const t=cn.get(s);t&&(t.flags|=8,cn.delete(s))}wn().requestIdleCallback;wn().cancelIdleCallback;const Rs=s=>!!s.type.__asyncLoader,mu=s=>s.type.__isKeepAlive;function Ic(s,t){vu(s,"a",t)}function Bc(s,t){vu(s,"da",t)}function vu(s,t,e=jt){const i=s.__wdc||(s.__wdc=()=>{let n=e;for(;n;){if(n.isDeactivated)return;n=n.parent}return s()});if(En(t,i,e),e){let n=e.parent;for(;n&&n.parent;)mu(n.parent.vnode)&&Vc(i,t,e,n),n=n.parent}}function Vc(s,t,e,i){const n=En(t,s,i,!0);Hs(()=>{so(i[t],n)},e)}function En(s,t,e=jt,i=!1){if(e){const n=e[s]||(e[s]=[]),r=t.__weh||(t.__weh=(...o)=>{qe();const l=Mi(e),a=Le(t,e,s,o);return l(),We(),a});return i?n.unshift(r):n.push(r),r}}const je=s=>(t,e=jt)=>{(!bi||s==="sp")&&En(s,(...i)=>t(...i),e)},Fc=je("bm"),ae=je("m"),Uc=je("bu"),zc=je("u"),gu=je("bum"),Hs=je("um"),qc=je("sp"),Wc=je("rtg"),Hc=je("rtc");function Kc(s,t=jt){En("ec",s,t)}const jc=Symbol.for("v-ndc");function Jt(s,t,e,i){let n;const r=e,o=tt(s);if(o||Lt(s)){const l=o&&vs(s);let a=!1,u=!1;l&&(a=!ce(s),u=He(s),s=xn(s)),n=new Array(s.length);for(let c=0,d=s.length;c<d;c++)n[c]=t(a?u?Ds(ve(s[c])):ve(s[c]):s[c],c,void 0,r)}else if(typeof s=="number"){n=new Array(s);for(let l=0;l<s;l++)n[l]=t(l+1,l,void 0,r)}else if(yt(s))if(s[Symbol.iterator])n=Array.from(s,(l,a)=>t(l,a,void 0,r));else{const l=Object.keys(s);n=new Array(l.length);for(let a=0,u=l.length;a<u;a++){const c=l[a];n[a]=t(s[c],c,a,r)}}else n=[];return n}function bu(s,t,e={},i,n){if(Ft.ce||Ft.parent&&Rs(Ft.parent)&&Ft.parent.ce){const u=Object.keys(e).length>0;return C(),Xt(pt,null,[at("slot",e,i)],u?-2:64)}let r=s[t];r&&r._c&&(r._d=!1),C();const o=r&&yu(r(e)),l=e.key||o&&o.key,a=Xt(pt,{key:(l&&!me(l)?l:`_${t}`)+(!o&&i?"_fb":"")},o||[],o&&s._===1?64:-2);return a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function yu(s){return s.some(t=>gi(t)?!(t.type===Ke||t.type===pt&&!yu(t.children)):!0)?s:null}const Mr=s=>s?Bu(s)?Mn(s):Mr(s.parent):null,oi=zt(Object.create(null),{$:s=>s,$el:s=>s.vnode.el,$data:s=>s.data,$props:s=>s.props,$attrs:s=>s.attrs,$slots:s=>s.slots,$refs:s=>s.refs,$parent:s=>Mr(s.parent),$root:s=>Mr(s.root),$host:s=>s.ce,$emit:s=>s.emit,$options:s=>wu(s),$forceUpdate:s=>s.f||(s.f=()=>{fo(s.update)}),$nextTick:s=>s.n||(s.n=Is.bind(s.proxy)),$watch:s=>Rc.bind(s)}),Hn=(s,t)=>s!==gt&&!s.__isScriptSetup&&ft(s,t),Gc={get({_:s},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:i,data:n,props:r,accessCache:o,type:l,appContext:a}=s;if(t[0]!=="$"){const f=o[t];if(f!==void 0)switch(f){case 1:return i[t];case 2:return n[t];case 4:return e[t];case 3:return r[t]}else{if(Hn(i,t))return o[t]=1,i[t];if(n!==gt&&ft(n,t))return o[t]=2,n[t];if(ft(r,t))return o[t]=3,r[t];if(e!==gt&&ft(e,t))return o[t]=4,e[t];Ar&&(o[t]=0)}}const u=oi[t];let c,d;if(u)return t==="$attrs"&&Vt(s.attrs,"get",""),u(s);if((c=l.__cssModules)&&(c=c[t]))return c;if(e!==gt&&ft(e,t))return o[t]=4,e[t];if(d=a.config.globalProperties,ft(d,t))return d[t]},set({_:s},t,e){const{data:i,setupState:n,ctx:r}=s;return Hn(n,t)?(n[t]=e,!0):i!==gt&&ft(i,t)?(i[t]=e,!0):ft(s.props,t)||t[0]==="$"&&t.slice(1)in s?!1:(r[t]=e,!0)},has({_:{data:s,setupState:t,accessCache:e,ctx:i,appContext:n,props:r,type:o}},l){let a;return!!(e[l]||s!==gt&&l[0]!=="$"&&ft(s,l)||Hn(t,l)||ft(r,l)||ft(i,l)||ft(oi,l)||ft(n.config.globalProperties,l)||(a=o.__cssModules)&&a[l])},defineProperty(s,t,e){return e.get!=null?s._.accessCache[t]=0:ft(e,"value")&&this.set(s,t,e.value,null),Reflect.defineProperty(s,t,e)}};function Xo(s){return tt(s)?s.reduce((t,e)=>(t[e]=null,t),{}):s}let Ar=!0;function Jc(s){const t=wu(s),e=s.proxy,i=s.ctx;Ar=!1,t.beforeCreate&&Yo(t.beforeCreate,s,"bc");const{data:n,computed:r,methods:o,watch:l,provide:a,inject:u,created:c,beforeMount:d,mounted:f,beforeUpdate:p,updated:v,activated:g,deactivated:_,beforeDestroy:w,beforeUnmount:y,destroyed:M,unmounted:D,render:X,renderTracked:nt,renderTriggered:Z,errorCaptured:V,serverPrefetch:O,expose:B,inheritAttrs:mt,components:Tt,directives:At,filters:Qt}=t;if(u&&Xc(u,i,null),o)for(const R in o){const G=o[R];rt(G)&&(i[R]=G.bind(e))}if(n){const R=n.call(e,e);yt(R)&&(s.data=Gt(R))}if(Ar=!0,r)for(const R in r){const G=r[R],It=rt(G)?G.bind(e,e):rt(G.get)?G.get.bind(e,e):Me,Nt=!rt(G)&&rt(G.set)?G.set.bind(e):Me,Bt=ht({get:It,set:Nt});Object.defineProperty(i,R,{enumerable:!0,configurable:!0,get:()=>Bt.value,set:Rt=>Bt.value=Rt})}if(l)for(const R in l)_u(l[R],i,e,R);if(a){const R=rt(a)?a.call(e):a;Reflect.ownKeys(R).forEach(G=>{Qi(G,R[G])})}c&&Yo(c,s,"c");function W(R,G){tt(G)?G.forEach(It=>R(It.bind(e))):G&&R(G.bind(e))}if(W(Fc,d),W(ae,f),W(Uc,p),W(zc,v),W(Ic,g),W(Bc,_),W(Kc,V),W(Hc,nt),W(Wc,Z),W(gu,y),W(Hs,D),W(qc,O),tt(B))if(B.length){const R=s.exposed||(s.exposed={});B.forEach(G=>{Object.defineProperty(R,G,{get:()=>e[G],set:It=>e[G]=It,enumerable:!0})})}else s.exposed||(s.exposed={});X&&s.render===Me&&(s.render=X),mt!=null&&(s.inheritAttrs=mt),Tt&&(s.components=Tt),At&&(s.directives=At),O&&pu(s)}function Xc(s,t,e=Me){tt(s)&&(s=Or(s));for(const i in s){const n=s[i];let r;yt(n)?"default"in n?r=pe(n.from||i,n.default,!0):r=pe(n.from||i):r=pe(n),Ut(r)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[i]=r}}function Yo(s,t,e){Le(tt(s)?s.map(i=>i.bind(t.proxy)):s.bind(t.proxy),t,e)}function _u(s,t,e,i){let n=i.includes(".")?du(e,i):()=>e[i];if(Lt(s)){const r=t[s];rt(r)&&ns(n,r)}else if(rt(s))ns(n,s.bind(e));else if(yt(s))if(tt(s))s.forEach(r=>_u(r,t,e,i));else{const r=rt(s.handler)?s.handler.bind(e):t[s.handler];rt(r)&&ns(n,r,s)}}function wu(s){const t=s.type,{mixins:e,extends:i}=t,{mixins:n,optionsCache:r,config:{optionMergeStrategies:o}}=s.appContext,l=r.get(t);let a;return l?a=l:!n.length&&!e&&!i?a=t:(a={},n.length&&n.forEach(u=>dn(a,u,o,!0)),dn(a,t,o)),yt(t)&&r.set(t,a),a}function dn(s,t,e,i=!1){const{mixins:n,extends:r}=t;r&&dn(s,r,e,!0),n&&n.forEach(o=>dn(s,o,e,!0));for(const o in t)if(!(i&&o==="expose")){const l=Yc[o]||e&&e[o];s[o]=l?l(s[o],t[o]):t[o]}return s}const Yc={data:Qo,props:Zo,emits:Zo,methods:ti,computed:ti,beforeCreate:Wt,created:Wt,beforeMount:Wt,mounted:Wt,beforeUpdate:Wt,updated:Wt,beforeDestroy:Wt,beforeUnmount:Wt,destroyed:Wt,unmounted:Wt,activated:Wt,deactivated:Wt,errorCaptured:Wt,serverPrefetch:Wt,components:ti,directives:ti,watch:Zc,provide:Qo,inject:Qc};function Qo(s,t){return t?s?function(){return zt(rt(s)?s.call(this,this):s,rt(t)?t.call(this,this):t)}:t:s}function Qc(s,t){return ti(Or(s),Or(t))}function Or(s){if(tt(s)){const t={};for(let e=0;e<s.length;e++)t[s[e]]=s[e];return t}return s}function Wt(s,t){return s?[...new Set([].concat(s,t))]:t}function ti(s,t){return s?zt(Object.create(null),s,t):t}function Zo(s,t){return s?tt(s)&&tt(t)?[...new Set([...s,...t])]:zt(Object.create(null),Xo(s),Xo(t??{})):t}function Zc(s,t){if(!s)return t;if(!t)return s;const e=zt(Object.create(null),s);for(const i in t)e[i]=Wt(s[i],t[i]);return e}function Su(){return{app:null,config:{isNativeTag:Na,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let td=0;function ed(s,t){return function(i,n=null){rt(i)||(i=zt({},i)),n!=null&&!yt(n)&&(n=null);const r=Su(),o=new WeakSet,l=[];let a=!1;const u=r.app={_uid:td++,_component:i,_props:n,_container:null,_context:r,_instance:null,version:Rd,get config(){return r.config},set config(c){},use(c,...d){return o.has(c)||(c&&rt(c.install)?(o.add(c),c.install(u,...d)):rt(c)&&(o.add(c),c(u,...d))),u},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),u},component(c,d){return d?(r.components[c]=d,u):r.components[c]},directive(c,d){return d?(r.directives[c]=d,u):r.directives[c]},mount(c,d,f){if(!a){const p=u._ceVNode||at(i,n);return p.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),s(p,c,f),a=!0,u._container=c,c.__vue_app__=u,Mn(p.component)}},onUnmount(c){l.push(c)},unmount(){a&&(Le(l,u._instance,16),s(null,u._container),delete u._container.__vue_app__)},provide(c,d){return r.provides[c]=d,u},runWithContext(c){const d=Ns;Ns=u;try{return c()}finally{Ns=d}}};return u}}let Ns=null;const sd=(s,t)=>t==="modelValue"||t==="model-value"?s.modelModifiers:s[`${t}Modifiers`]||s[`${os(t)}Modifiers`]||s[`${as(t)}Modifiers`];function id(s,t,...e){if(s.isUnmounted)return;const i=s.vnode.props||gt;let n=e;const r=t.startsWith("update:"),o=r&&sd(i,t.slice(7));o&&(o.trim&&(n=e.map(c=>Lt(c)?c.trim():c)),o.number&&(n=e.map(_n)));let l,a=i[l=Fn(t)]||i[l=Fn(os(t))];!a&&r&&(a=i[l=Fn(as(t))]),a&&Le(a,s,6,n);const u=i[l+"Once"];if(u){if(!s.emitted)s.emitted={};else if(s.emitted[l])return;s.emitted[l]=!0,Le(u,s,6,n)}}const nd=new WeakMap;function xu(s,t,e=!1){const i=e?nd:t.emitsCache,n=i.get(s);if(n!==void 0)return n;const r=s.emits;let o={},l=!1;if(!rt(s)){const a=u=>{const c=xu(u,t,!0);c&&(l=!0,zt(o,c))};!e&&t.mixins.length&&t.mixins.forEach(a),s.extends&&a(s.extends),s.mixins&&s.mixins.forEach(a)}return!r&&!l?(yt(s)&&i.set(s,null),null):(tt(r)?r.forEach(a=>o[a]=null):zt(o,r),yt(s)&&i.set(s,o),o)}function Tn(s,t){return!s||!bn(t)?!1:(t=t.slice(2).replace(/Once$/,""),ft(s,t[0].toLowerCase()+t.slice(1))||ft(s,as(t))||ft(s,t))}function tl(s){const{type:t,vnode:e,proxy:i,withProxy:n,propsOptions:[r],slots:o,attrs:l,emit:a,render:u,renderCache:c,props:d,data:f,setupState:p,ctx:v,inheritAttrs:g}=s,_=hn(s);let w,y;try{if(e.shapeFlag&4){const D=n||i,X=D;w=Te(u.call(X,D,c,d,p,f,v)),y=l}else{const D=t;w=Te(D.length>1?D(d,{attrs:l,slots:o,emit:a}):D(d,null)),y=t.props?l:rd(l)}}catch(D){li.length=0,Cn(D,s,1),w=at(Ke)}let M=w;if(y&&g!==!1){const D=Object.keys(y),{shapeFlag:X}=M;D.length&&X&7&&(r&&D.some(eo)&&(y=od(y,r)),M=Bs(M,y,!1,!0))}return e.dirs&&(M=Bs(M,null,!1,!0),M.dirs=M.dirs?M.dirs.concat(e.dirs):e.dirs),e.transition&&po(M,e.transition),w=M,hn(_),w}const rd=s=>{let t;for(const e in s)(e==="class"||e==="style"||bn(e))&&((t||(t={}))[e]=s[e]);return t},od=(s,t)=>{const e={};for(const i in s)(!eo(i)||!(i.slice(9)in t))&&(e[i]=s[i]);return e};function ld(s,t,e){const{props:i,children:n,component:r}=s,{props:o,children:l,patchFlag:a}=t,u=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&a>=0){if(a&1024)return!0;if(a&16)return i?el(i,o,u):!!o;if(a&8){const c=t.dynamicProps;for(let d=0;d<c.length;d++){const f=c[d];if(o[f]!==i[f]&&!Tn(u,f))return!0}}}else return(n||l)&&(!l||!l.$stable)?!0:i===o?!1:i?o?el(i,o,u):!0:!!o;return!1}function el(s,t,e){const i=Object.keys(t);if(i.length!==Object.keys(s).length)return!0;for(let n=0;n<i.length;n++){const r=i[n];if(t[r]!==s[r]&&!Tn(e,r))return!0}return!1}function ad({vnode:s,parent:t},e){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===s&&(i.el=s.el),i===s)(s=t.vnode).el=e,t=t.parent;else break}}const Cu={},Eu=()=>Object.create(Cu),Tu=s=>Object.getPrototypeOf(s)===Cu;function ud(s,t,e,i=!1){const n={},r=Eu();s.propsDefaults=Object.create(null),ku(s,t,n,r);for(const o in s.propsOptions[0])o in n||(n[o]=void 0);e?s.props=i?n:iu(n):s.type.props?s.props=n:s.props=r,s.attrs=r}function hd(s,t,e,i){const{props:n,attrs:r,vnode:{patchFlag:o}}=s,l=dt(n),[a]=s.propsOptions;let u=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=s.vnode.dynamicProps;for(let d=0;d<c.length;d++){let f=c[d];if(Tn(s.emitsOptions,f))continue;const p=t[f];if(a)if(ft(r,f))p!==r[f]&&(r[f]=p,u=!0);else{const v=os(f);n[v]=Lr(a,l,v,p,s,!1)}else p!==r[f]&&(r[f]=p,u=!0)}}}else{ku(s,t,n,r)&&(u=!0);let c;for(const d in l)(!t||!ft(t,d)&&((c=as(d))===d||!ft(t,c)))&&(a?e&&(e[d]!==void 0||e[c]!==void 0)&&(n[d]=Lr(a,l,d,void 0,s,!0)):delete n[d]);if(r!==l)for(const d in r)(!t||!ft(t,d))&&(delete r[d],u=!0)}u&&Be(s.attrs,"set","")}function ku(s,t,e,i){const[n,r]=s.propsOptions;let o=!1,l;if(t)for(let a in t){if(si(a))continue;const u=t[a];let c;n&&ft(n,c=os(a))?!r||!r.includes(c)?e[c]=u:(l||(l={}))[c]=u:Tn(s.emitsOptions,a)||(!(a in i)||u!==i[a])&&(i[a]=u,o=!0)}if(r){const a=dt(e),u=l||gt;for(let c=0;c<r.length;c++){const d=r[c];e[d]=Lr(n,a,d,u[d],s,!ft(u,d))}}return o}function Lr(s,t,e,i,n,r){const o=s[e];if(o!=null){const l=ft(o,"default");if(l&&i===void 0){const a=o.default;if(o.type!==Function&&!o.skipFactory&&rt(a)){const{propsDefaults:u}=n;if(e in u)i=u[e];else{const c=Mi(n);i=u[e]=a.call(null,t),c()}}else i=a;n.ce&&n.ce._setProp(e,i)}o[0]&&(r&&!l?i=!1:o[1]&&(i===""||i===as(e))&&(i=!0))}return i}const cd=new WeakMap;function Mu(s,t,e=!1){const i=e?cd:t.propsCache,n=i.get(s);if(n)return n;const r=s.props,o={},l=[];let a=!1;if(!rt(s)){const c=d=>{a=!0;const[f,p]=Mu(d,t,!0);zt(o,f),p&&l.push(...p)};!e&&t.mixins.length&&t.mixins.forEach(c),s.extends&&c(s.extends),s.mixins&&s.mixins.forEach(c)}if(!r&&!a)return yt(s)&&i.set(s,Os),Os;if(tt(r))for(let c=0;c<r.length;c++){const d=os(r[c]);sl(d)&&(o[d]=gt)}else if(r)for(const c in r){const d=os(c);if(sl(d)){const f=r[c],p=o[d]=tt(f)||rt(f)?{type:f}:zt({},f),v=p.type;let g=!1,_=!0;if(tt(v))for(let w=0;w<v.length;++w){const y=v[w],M=rt(y)&&y.name;if(M==="Boolean"){g=!0;break}else M==="String"&&(_=!1)}else g=rt(v)&&v.name==="Boolean";p[0]=g,p[1]=_,(g||ft(p,"default"))&&l.push(d)}}const u=[o,l];return yt(s)&&i.set(s,u),u}function sl(s){return s[0]!=="$"&&!si(s)}const mo=s=>s==="_"||s==="_ctx"||s==="$stable",vo=s=>tt(s)?s.map(Te):[Te(s)],dd=(s,t,e)=>{if(t._n)return t;const i=bt((...n)=>vo(t(...n)),e);return i._c=!1,i},Au=(s,t,e)=>{const i=s._ctx;for(const n in s){if(mo(n))continue;const r=s[n];if(rt(r))t[n]=dd(n,r,i);else if(r!=null){const o=vo(r);t[n]=()=>o}}},Ou=(s,t)=>{const e=vo(t);s.slots.default=()=>e},Lu=(s,t,e)=>{for(const i in t)(e||!mo(i))&&(s[i]=t[i])},fd=(s,t,e)=>{const i=s.slots=Eu();if(s.vnode.shapeFlag&32){const n=t._;n?(Lu(i,t,e),e&&Va(i,"_",n,!0)):Au(t,i)}else t&&Ou(s,t)},pd=(s,t,e)=>{const{vnode:i,slots:n}=s;let r=!0,o=gt;if(i.shapeFlag&32){const l=t._;l?e&&l===1?r=!1:Lu(n,t,e):(r=!t.$stable,Au(t,n)),o=t}else t&&(Ou(s,t),o={default:1});if(r)for(const l in n)!mo(l)&&o[l]==null&&delete n[l]},oe=yd;function md(s){return vd(s)}function vd(s,t){const e=wn();e.__VUE__=!0;const{insert:i,remove:n,patchProp:r,createElement:o,createText:l,createComment:a,setText:u,setElementText:c,parentNode:d,nextSibling:f,setScopeId:p=Me,insertStaticContent:v}=s,g=(m,b,S,A=null,L=null,P=null,H=void 0,q=null,z=!!b.dynamicChildren)=>{if(m===b)return;m&&!Xs(m,b)&&(A=N(m),Rt(m,L,P,!0),m=null),b.patchFlag===-2&&(z=!1,b.dynamicChildren=null);const{type:I,ref:Q,shapeFlag:j}=b;switch(I){case kn:_(m,b,S,A);break;case Ke:w(m,b,S,A);break;case Zi:m==null&&y(b,S,A,H);break;case pt:Tt(m,b,S,A,L,P,H,q,z);break;default:j&1?X(m,b,S,A,L,P,H,q,z):j&6?At(m,b,S,A,L,P,H,q,z):(j&64||j&128)&&I.process(m,b,S,A,L,P,H,q,z,F)}Q!=null&&L?ri(Q,m&&m.ref,P,b||m,!b):Q==null&&m&&m.ref!=null&&ri(m.ref,null,P,m,!0)},_=(m,b,S,A)=>{if(m==null)i(b.el=l(b.children),S,A);else{const L=b.el=m.el;b.children!==m.children&&u(L,b.children)}},w=(m,b,S,A)=>{m==null?i(b.el=a(b.children||""),S,A):b.el=m.el},y=(m,b,S,A)=>{[m.el,m.anchor]=v(m.children,b,S,A,m.el,m.anchor)},M=({el:m,anchor:b},S,A)=>{let L;for(;m&&m!==b;)L=f(m),i(m,S,A),m=L;i(b,S,A)},D=({el:m,anchor:b})=>{let S;for(;m&&m!==b;)S=f(m),n(m),m=S;n(b)},X=(m,b,S,A,L,P,H,q,z)=>{if(b.type==="svg"?H="svg":b.type==="math"&&(H="mathml"),m==null)nt(b,S,A,L,P,H,q,z);else{const I=m.el&&m.el._isVueCE?m.el:null;try{I&&I._beginPatch(),O(m,b,L,P,H,q,z)}finally{I&&I._endPatch()}}},nt=(m,b,S,A,L,P,H,q)=>{let z,I;const{props:Q,shapeFlag:j,transition:Y,dirs:it}=m;if(z=m.el=o(m.type,P,Q&&Q.is,Q),j&8?c(z,m.children):j&16&&V(m.children,z,null,A,L,Kn(m,P),H,q),it&&us(m,null,A,"created"),Z(z,m,m.scopeId,H,A),Q){for(const _t in Q)_t!=="value"&&!si(_t)&&r(z,_t,null,Q[_t],P,A);"value"in Q&&r(z,"value",null,Q.value,P),(I=Q.onVnodeBeforeMount)&&xe(I,A,m)}it&&us(m,null,A,"beforeMount");const ut=gd(L,Y);ut&&Y.beforeEnter(z),i(z,b,S),((I=Q&&Q.onVnodeMounted)||ut||it)&&oe(()=>{I&&xe(I,A,m),ut&&Y.enter(z),it&&us(m,null,A,"mounted")},L)},Z=(m,b,S,A,L)=>{if(S&&p(m,S),A)for(let P=0;P<A.length;P++)p(m,A[P]);if(L){let P=L.subTree;if(b===P||$u(P.type)&&(P.ssContent===b||P.ssFallback===b)){const H=L.vnode;Z(m,H,H.scopeId,H.slotScopeIds,L.parent)}}},V=(m,b,S,A,L,P,H,q,z=0)=>{for(let I=z;I<m.length;I++){const Q=m[I]=q?ts(m[I]):Te(m[I]);g(null,Q,b,S,A,L,P,H,q)}},O=(m,b,S,A,L,P,H)=>{const q=b.el=m.el;let{patchFlag:z,dynamicChildren:I,dirs:Q}=b;z|=m.patchFlag&16;const j=m.props||gt,Y=b.props||gt;let it;if(S&&hs(S,!1),(it=Y.onVnodeBeforeUpdate)&&xe(it,S,b,m),Q&&us(b,m,S,"beforeUpdate"),S&&hs(S,!0),(j.innerHTML&&Y.innerHTML==null||j.textContent&&Y.textContent==null)&&c(q,""),I?B(m.dynamicChildren,I,q,S,A,Kn(b,L),P):H||G(m,b,q,null,S,A,Kn(b,L),P,!1),z>0){if(z&16)mt(q,j,Y,S,L);else if(z&2&&j.class!==Y.class&&r(q,"class",null,Y.class,L),z&4&&r(q,"style",j.style,Y.style,L),z&8){const ut=b.dynamicProps;for(let _t=0;_t<ut.length;_t++){const vt=ut[_t],te=j[vt],ee=Y[vt];(ee!==te||vt==="value")&&r(q,vt,te,ee,L,S)}}z&1&&m.children!==b.children&&c(q,b.children)}else!H&&I==null&&mt(q,j,Y,S,L);((it=Y.onVnodeUpdated)||Q)&&oe(()=>{it&&xe(it,S,b,m),Q&&us(b,m,S,"updated")},A)},B=(m,b,S,A,L,P,H)=>{for(let q=0;q<b.length;q++){const z=m[q],I=b[q],Q=z.el&&(z.type===pt||!Xs(z,I)||z.shapeFlag&198)?d(z.el):S;g(z,I,Q,null,A,L,P,H,!0)}},mt=(m,b,S,A,L)=>{if(b!==S){if(b!==gt)for(const P in b)!si(P)&&!(P in S)&&r(m,P,b[P],null,L,A);for(const P in S){if(si(P))continue;const H=S[P],q=b[P];H!==q&&P!=="value"&&r(m,P,q,H,L,A)}"value"in S&&r(m,"value",b.value,S.value,L)}},Tt=(m,b,S,A,L,P,H,q,z)=>{const I=b.el=m?m.el:l(""),Q=b.anchor=m?m.anchor:l("");let{patchFlag:j,dynamicChildren:Y,slotScopeIds:it}=b;it&&(q=q?q.concat(it):it),m==null?(i(I,S,A),i(Q,S,A),V(b.children||[],S,Q,L,P,H,q,z)):j>0&&j&64&&Y&&m.dynamicChildren&&m.dynamicChildren.length===Y.length?(B(m.dynamicChildren,Y,S,L,P,H,q),(b.key!=null||L&&b===L.subTree)&&Pu(m,b,!0)):G(m,b,S,Q,L,P,H,q,z)},At=(m,b,S,A,L,P,H,q,z)=>{b.slotScopeIds=q,m==null?b.shapeFlag&512?L.ctx.activate(b,S,A,H,z):Qt(b,S,A,L,P,H,z):qt(m,b,z)},Qt=(m,b,S,A,L,P,H)=>{const q=m.component=Td(m,A,L);if(mu(m)&&(q.ctx.renderer=F),Md(q,!1,H),q.asyncDep){if(L&&L.registerDep(q,W,H),!m.el){const z=q.subTree=at(Ke);w(null,z,b,S),m.placeholder=z.el}}else W(q,m,b,S,L,P,H)},qt=(m,b,S)=>{const A=b.component=m.component;if(ld(m,b,S))if(A.asyncDep&&!A.asyncResolved){R(A,b,S);return}else A.next=b,A.update();else b.el=m.el,A.vnode=b},W=(m,b,S,A,L,P,H)=>{const q=()=>{if(m.isMounted){let{next:j,bu:Y,u:it,parent:ut,vnode:_t}=m;{const we=Ru(m);if(we){j&&(j.el=_t.el,R(m,j,H)),we.asyncDep.then(()=>{m.isUnmounted||q()});return}}let vt=j,te;hs(m,!1),j?(j.el=_t.el,R(m,j,H)):j=_t,Y&&Yi(Y),(te=j.props&&j.props.onVnodeBeforeUpdate)&&xe(te,ut,j,_t),hs(m,!0);const ee=tl(m),_e=m.subTree;m.subTree=ee,g(_e,ee,d(_e.el),N(_e),m,L,P),j.el=ee.el,vt===null&&ad(m,ee.el),it&&oe(it,L),(te=j.props&&j.props.onVnodeUpdated)&&oe(()=>xe(te,ut,j,_t),L)}else{let j;const{el:Y,props:it}=b,{bm:ut,m:_t,parent:vt,root:te,type:ee}=m,_e=Rs(b);hs(m,!1),ut&&Yi(ut),!_e&&(j=it&&it.onVnodeBeforeMount)&&xe(j,vt,b),hs(m,!0);{te.ce&&te.ce._def.shadowRoot!==!1&&te.ce._injectChildStyle(ee);const we=m.subTree=tl(m);g(null,we,S,A,m,L,P),b.el=we.el}if(_t&&oe(_t,L),!_e&&(j=it&&it.onVnodeMounted)){const we=b;oe(()=>xe(j,vt,we),L)}(b.shapeFlag&256||vt&&Rs(vt.vnode)&&vt.vnode.shapeFlag&256)&&m.a&&oe(m.a,L),m.isMounted=!0,b=S=A=null}};m.scope.on();const z=m.effect=new qa(q);m.scope.off();const I=m.update=z.run.bind(z),Q=m.job=z.runIfDirty.bind(z);Q.i=m,Q.id=m.uid,z.scheduler=()=>fo(Q),hs(m,!0),I()},R=(m,b,S)=>{b.component=m;const A=m.vnode.props;m.vnode=b,m.next=null,hd(m,b.props,A,S),pd(m,b.children,S),qe(),Go(m),We()},G=(m,b,S,A,L,P,H,q,z=!1)=>{const I=m&&m.children,Q=m?m.shapeFlag:0,j=b.children,{patchFlag:Y,shapeFlag:it}=b;if(Y>0){if(Y&128){Nt(I,j,S,A,L,P,H,q,z);return}else if(Y&256){It(I,j,S,A,L,P,H,q,z);return}}it&8?(Q&16&&Zt(I,L,P),j!==I&&c(S,j)):Q&16?it&16?Nt(I,j,S,A,L,P,H,q,z):Zt(I,L,P,!0):(Q&8&&c(S,""),it&16&&V(j,S,A,L,P,H,q,z))},It=(m,b,S,A,L,P,H,q,z)=>{m=m||Os,b=b||Os;const I=m.length,Q=b.length,j=Math.min(I,Q);let Y;for(Y=0;Y<j;Y++){const it=b[Y]=z?ts(b[Y]):Te(b[Y]);g(m[Y],it,S,null,L,P,H,q,z)}I>Q?Zt(m,L,P,!0,!1,j):V(b,S,A,L,P,H,q,z,j)},Nt=(m,b,S,A,L,P,H,q,z)=>{let I=0;const Q=b.length;let j=m.length-1,Y=Q-1;for(;I<=j&&I<=Y;){const it=m[I],ut=b[I]=z?ts(b[I]):Te(b[I]);if(Xs(it,ut))g(it,ut,S,null,L,P,H,q,z);else break;I++}for(;I<=j&&I<=Y;){const it=m[j],ut=b[Y]=z?ts(b[Y]):Te(b[Y]);if(Xs(it,ut))g(it,ut,S,null,L,P,H,q,z);else break;j--,Y--}if(I>j){if(I<=Y){const it=Y+1,ut=it<Q?b[it].el:A;for(;I<=Y;)g(null,b[I]=z?ts(b[I]):Te(b[I]),S,ut,L,P,H,q,z),I++}}else if(I>Y)for(;I<=j;)Rt(m[I],L,P,!0),I++;else{const it=I,ut=I,_t=new Map;for(I=ut;I<=Y;I++){const re=b[I]=z?ts(b[I]):Te(b[I]);re.key!=null&&_t.set(re.key,I)}let vt,te=0;const ee=Y-ut+1;let _e=!1,we=0;const Gs=new Array(ee);for(I=0;I<ee;I++)Gs[I]=0;for(I=it;I<=j;I++){const re=m[I];if(te>=ee){Rt(re,L,P,!0);continue}let Se;if(re.key!=null)Se=_t.get(re.key);else for(vt=ut;vt<=Y;vt++)if(Gs[vt-ut]===0&&Xs(re,b[vt])){Se=vt;break}Se===void 0?Rt(re,L,P,!0):(Gs[Se-ut]=I+1,Se>=we?we=Se:_e=!0,g(re,b[Se],S,null,L,P,H,q,z),te++)}const Uo=_e?bd(Gs):Os;for(vt=Uo.length-1,I=ee-1;I>=0;I--){const re=ut+I,Se=b[re],zo=b[re+1],qo=re+1<Q?zo.el||Nu(zo):A;Gs[I]===0?g(null,Se,S,qo,L,P,H,q,z):_e&&(vt<0||I!==Uo[vt]?Bt(Se,S,qo,2):vt--)}}},Bt=(m,b,S,A,L=null)=>{const{el:P,type:H,transition:q,children:z,shapeFlag:I}=m;if(I&6){Bt(m.component.subTree,b,S,A);return}if(I&128){m.suspense.move(b,S,A);return}if(I&64){H.move(m,b,S,F);return}if(H===pt){i(P,b,S);for(let j=0;j<z.length;j++)Bt(z[j],b,S,A);i(m.anchor,b,S);return}if(H===Zi){M(m,b,S);return}if(A!==2&&I&1&&q)if(A===0)q.beforeEnter(P),i(P,b,S),oe(()=>q.enter(P),L);else{const{leave:j,delayLeave:Y,afterLeave:it}=q,ut=()=>{m.ctx.isUnmounted?n(P):i(P,b,S)},_t=()=>{P._isLeaving&&P[Dc](!0),j(P,()=>{ut(),it&&it()})};Y?Y(P,ut,_t):_t()}else i(P,b,S)},Rt=(m,b,S,A=!1,L=!1)=>{const{type:P,props:H,ref:q,children:z,dynamicChildren:I,shapeFlag:Q,patchFlag:j,dirs:Y,cacheIndex:it}=m;if(j===-2&&(L=!1),q!=null&&(qe(),ri(q,null,S,m,!0),We()),it!=null&&(b.renderCache[it]=void 0),Q&256){b.ctx.deactivate(m);return}const ut=Q&1&&Y,_t=!Rs(m);let vt;if(_t&&(vt=H&&H.onVnodeBeforeUnmount)&&xe(vt,b,m),Q&6)Ne(m.component,S,A);else{if(Q&128){m.suspense.unmount(S,A);return}ut&&us(m,null,b,"beforeUnmount"),Q&64?m.type.remove(m,b,S,F,A):I&&!I.hasOnce&&(P!==pt||j>0&&j&64)?Zt(I,b,S,!1,!0):(P===pt&&j&384||!L&&Q&16)&&Zt(z,b,S),A&&ye(m)}(_t&&(vt=H&&H.onVnodeUnmounted)||ut)&&oe(()=>{vt&&xe(vt,b,m),ut&&us(m,null,b,"unmounted")},S)},ye=m=>{const{type:b,el:S,anchor:A,transition:L}=m;if(b===pt){Re(S,A);return}if(b===Zi){D(m);return}const P=()=>{n(S),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(m.shapeFlag&1&&L&&!L.persisted){const{leave:H,delayLeave:q}=L,z=()=>H(S,P);q?q(m.el,P,z):z()}else P()},Re=(m,b)=>{let S;for(;m!==b;)S=f(m),n(m),m=S;n(b)},Ne=(m,b,S)=>{const{bum:A,scope:L,job:P,subTree:H,um:q,m:z,a:I}=m;il(z),il(I),A&&Yi(A),L.stop(),P&&(P.flags|=8,Rt(H,m,b,S)),q&&oe(q,b),oe(()=>{m.isUnmounted=!0},b)},Zt=(m,b,S,A=!1,L=!1,P=0)=>{for(let H=P;H<m.length;H++)Rt(m[H],b,S,A,L)},N=m=>{if(m.shapeFlag&6)return N(m.component.subTree);if(m.shapeFlag&128)return m.suspense.next();const b=f(m.anchor||m.el),S=b&&b[Nc];return S?f(S):b};let T=!1;const E=(m,b,S)=>{let A;m==null?b._vnode&&(Rt(b._vnode,null,null,!0),A=b._vnode.component):g(b._vnode||null,m,b,null,null,null,S),b._vnode=m,T||(T=!0,Go(A),au(),T=!1)},F={p:g,um:Rt,m:Bt,r:ye,mt:Qt,mc:V,pc:G,pbc:B,n:N,o:s};return{render:E,hydrate:void 0,createApp:ed(E)}}function Kn({type:s,props:t},e){return e==="svg"&&s==="foreignObject"||e==="mathml"&&s==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function hs({effect:s,job:t},e){e?(s.flags|=32,t.flags|=4):(s.flags&=-33,t.flags&=-5)}function gd(s,t){return(!s||s&&!s.pendingBranch)&&t&&!t.persisted}function Pu(s,t,e=!1){const i=s.children,n=t.children;if(tt(i)&&tt(n))for(let r=0;r<i.length;r++){const o=i[r];let l=n[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=n[r]=ts(n[r]),l.el=o.el),!e&&l.patchFlag!==-2&&Pu(o,l)),l.type===kn&&(l.patchFlag!==-1?l.el=o.el:l.__elIndex=r+(s.type===pt?1:0)),l.type===Ke&&!l.el&&(l.el=o.el)}}function bd(s){const t=s.slice(),e=[0];let i,n,r,o,l;const a=s.length;for(i=0;i<a;i++){const u=s[i];if(u!==0){if(n=e[e.length-1],s[n]<u){t[i]=n,e.push(i);continue}for(r=0,o=e.length-1;r<o;)l=r+o>>1,s[e[l]]<u?r=l+1:o=l;u<s[e[r]]&&(r>0&&(t[i]=e[r-1]),e[r]=i)}}for(r=e.length,o=e[r-1];r-- >0;)e[r]=o,o=t[o];return e}function Ru(s){const t=s.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Ru(t)}function il(s){if(s)for(let t=0;t<s.length;t++)s[t].flags|=8}function Nu(s){if(s.placeholder)return s.placeholder;const t=s.component;return t?Nu(t.subTree):null}const $u=s=>s.__isSuspense;function yd(s,t){t&&t.pendingBranch?tt(s)?t.effects.push(...s):t.effects.push(s):Oc(s)}const pt=Symbol.for("v-fgt"),kn=Symbol.for("v-txt"),Ke=Symbol.for("v-cmt"),Zi=Symbol.for("v-stc"),li=[];let le=null;function C(s=!1){li.push(le=s?null:[])}function _d(){li.pop(),le=li[li.length-1]||null}let vi=1;function fn(s,t=!1){vi+=s,s<0&&le&&t&&(le.hasOnce=!0)}function Du(s){return s.dynamicChildren=vi>0?le||Os:null,_d(),vi>0&&le&&le.push(s),s}function k(s,t,e,i,n,r){return Du(h(s,t,e,i,n,r,!0))}function Xt(s,t,e,i,n){return Du(at(s,t,e,i,n,!0))}function gi(s){return s?s.__v_isVNode===!0:!1}function Xs(s,t){return s.type===t.type&&s.key===t.key}const Iu=({key:s})=>s??null,tn=({ref:s,ref_key:t,ref_for:e})=>(typeof s=="number"&&(s=""+s),s!=null?Lt(s)||Ut(s)||rt(s)?{i:Ft,r:s,k:t,f:!!e}:s:null);function h(s,t=null,e=null,i=0,n=null,r=s===pt?0:1,o=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:s,props:t,key:t&&Iu(t),ref:t&&tn(t),scopeId:hu,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:i,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Ft};return l?(bo(a,e),r&128&&s.normalize(a)):e&&(a.shapeFlag|=Lt(e)?8:16),vi>0&&!o&&le&&(a.patchFlag>0||r&6)&&a.patchFlag!==32&&le.push(a),a}const at=wd;function wd(s,t=null,e=null,i=0,n=null,r=!1){if((!s||s===jc)&&(s=Ke),gi(s)){const l=Bs(s,t,!0);return e&&bo(l,e),vi>0&&!r&&le&&(l.shapeFlag&6?le[le.indexOf(s)]=l:le.push(l)),l.patchFlag=-2,l}if(Pd(s)&&(s=s.__vccOpts),t){t=Sd(t);let{class:l,style:a}=t;l&&!Lt(l)&&(t.class=bs(l)),yt(a)&&(co(a)&&!tt(a)&&(a=zt({},a)),t.style=Sn(a))}const o=Lt(s)?1:$u(s)?128:$c(s)?64:yt(s)?4:rt(s)?2:0;return h(s,t,e,i,n,o,r,!0)}function Sd(s){return s?co(s)||Tu(s)?zt({},s):s:null}function Bs(s,t,e=!1,i=!1){const{props:n,ref:r,patchFlag:o,children:l,transition:a}=s,u=t?xd(n||{},t):n,c={__v_isVNode:!0,__v_skip:!0,type:s.type,props:u,key:u&&Iu(u),ref:t&&t.ref?e&&r?tt(r)?r.concat(tn(t)):[r,tn(t)]:tn(t):r,scopeId:s.scopeId,slotScopeIds:s.slotScopeIds,children:l,target:s.target,targetStart:s.targetStart,targetAnchor:s.targetAnchor,staticCount:s.staticCount,shapeFlag:s.shapeFlag,patchFlag:t&&s.type!==pt?o===-1?16:o|16:o,dynamicProps:s.dynamicProps,dynamicChildren:s.dynamicChildren,appContext:s.appContext,dirs:s.dirs,transition:a,component:s.component,suspense:s.suspense,ssContent:s.ssContent&&Bs(s.ssContent),ssFallback:s.ssFallback&&Bs(s.ssFallback),placeholder:s.placeholder,el:s.el,anchor:s.anchor,ctx:s.ctx,ce:s.ce};return a&&i&&po(c,a.clone(c)),c}function kt(s=" ",t=0){return at(kn,null,s,t)}function go(s,t){const e=at(Zi,null,s);return e.staticCount=t,e}function K(s="",t=!1){return t?(C(),Xt(Ke,null,s)):at(Ke,null,s)}function Te(s){return s==null||typeof s=="boolean"?at(Ke):tt(s)?at(pt,null,s.slice()):gi(s)?ts(s):at(kn,null,String(s))}function ts(s){return s.el===null&&s.patchFlag!==-1||s.memo?s:Bs(s)}function bo(s,t){let e=0;const{shapeFlag:i}=s;if(t==null)t=null;else if(tt(t))e=16;else if(typeof t=="object")if(i&65){const n=t.default;n&&(n._c&&(n._d=!1),bo(s,n()),n._c&&(n._d=!0));return}else{e=32;const n=t._;!n&&!Tu(t)?t._ctx=Ft:n===3&&Ft&&(Ft.slots._===1?t._=1:(t._=2,s.patchFlag|=1024))}else rt(t)?(t={default:t,_ctx:Ft},e=32):(t=String(t),i&64?(e=16,t=[kt(t)]):e=8);s.children=t,s.shapeFlag|=e}function xd(...s){const t={};for(let e=0;e<s.length;e++){const i=s[e];for(const n in i)if(n==="class")t.class!==i.class&&(t.class=bs([t.class,i.class]));else if(n==="style")t.style=Sn([t.style,i.style]);else if(bn(n)){const r=t[n],o=i[n];o&&r!==o&&!(tt(r)&&r.includes(o))&&(t[n]=r?[].concat(r,o):o)}else n!==""&&(t[n]=i[n])}return t}function xe(s,t,e,i=null){Le(s,t,7,[e,i])}const Cd=Su();let Ed=0;function Td(s,t,e){const i=s.type,n=(t?t.appContext:s.appContext)||Cd,r={uid:Ed++,vnode:s,type:i,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new tc(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Mu(i,n),emitsOptions:xu(i,n),emit:null,emitted:null,propsDefaults:gt,inheritAttrs:i.inheritAttrs,ctx:gt,data:gt,props:gt,attrs:gt,slots:gt,refs:gt,setupState:gt,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=id.bind(null,r),s.ce&&s.ce(r),r}let jt=null;const kd=()=>jt||Ft;let pn,Pr;{const s=wn(),t=(e,i)=>{let n;return(n=s[e])||(n=s[e]=[]),n.push(i),r=>{n.length>1?n.forEach(o=>o(r)):n[0](r)}};pn=t("__VUE_INSTANCE_SETTERS__",e=>jt=e),Pr=t("__VUE_SSR_SETTERS__",e=>bi=e)}const Mi=s=>{const t=jt;return pn(s),s.scope.on(),()=>{s.scope.off(),pn(t)}},nl=()=>{jt&&jt.scope.off(),pn(null)};function Bu(s){return s.vnode.shapeFlag&4}let bi=!1;function Md(s,t=!1,e=!1){t&&Pr(t);const{props:i,children:n}=s.vnode,r=Bu(s);ud(s,i,r,t),fd(s,n,e||t);const o=r?Ad(s,t):void 0;return t&&Pr(!1),o}function Ad(s,t){const e=s.type;s.accessCache=Object.create(null),s.proxy=new Proxy(s.ctx,Gc);const{setup:i}=e;if(i){qe();const n=s.setupContext=i.length>1?Ld(s):null,r=Mi(s),o=ki(i,s,0,[s.props,n]),l=$a(o);if(We(),r(),(l||s.sp)&&!Rs(s)&&pu(s),l){if(o.then(nl,nl),t)return o.then(a=>{rl(s,a)}).catch(a=>{Cn(a,s,0)});s.asyncDep=o}else rl(s,o)}else Vu(s)}function rl(s,t,e){rt(t)?s.type.__ssrInlineRender?s.ssrRender=t:s.render=t:yt(t)&&(s.setupState=ru(t)),Vu(s)}function Vu(s,t,e){const i=s.type;s.render||(s.render=i.render||Me);{const n=Mi(s);qe();try{Jc(s)}finally{We(),n()}}}const Od={get(s,t){return Vt(s,"get",""),s[t]}};function Ld(s){const t=e=>{s.exposed=e||{}};return{attrs:new Proxy(s.attrs,Od),slots:s.slots,emit:s.emit,expose:t}}function Mn(s){return s.exposed?s.exposeProxy||(s.exposeProxy=new Proxy(ru(_c(s.exposed)),{get(t,e){if(e in t)return t[e];if(e in oi)return oi[e](s)},has(t,e){return e in t||e in oi}})):s.proxy}function Pd(s){return rt(s)&&"__vccOpts"in s}const ht=(s,t)=>Ec(s,t,bi);function Fu(s,t,e){try{fn(-1);const i=arguments.length;return i===2?yt(t)&&!tt(t)?gi(t)?at(s,null,[t]):at(s,t):at(s,null,t):(i>3?e=Array.prototype.slice.call(arguments,2):i===3&&gi(e)&&(e=[e]),at(s,t,e))}finally{fn(1)}}const Rd="3.5.26";let Rr;const ol=typeof window<"u"&&window.trustedTypes;if(ol)try{Rr=ol.createPolicy("vue",{createHTML:s=>s})}catch{}const Uu=Rr?s=>Rr.createHTML(s):s=>s,Nd="http://www.w3.org/2000/svg",$d="http://www.w3.org/1998/Math/MathML",Ie=typeof document<"u"?document:null,ll=Ie&&Ie.createElement("template"),Dd={insert:(s,t,e)=>{t.insertBefore(s,e||null)},remove:s=>{const t=s.parentNode;t&&t.removeChild(s)},createElement:(s,t,e,i)=>{const n=t==="svg"?Ie.createElementNS(Nd,s):t==="mathml"?Ie.createElementNS($d,s):e?Ie.createElement(s,{is:e}):Ie.createElement(s);return s==="select"&&i&&i.multiple!=null&&n.setAttribute("multiple",i.multiple),n},createText:s=>Ie.createTextNode(s),createComment:s=>Ie.createComment(s),setText:(s,t)=>{s.nodeValue=t},setElementText:(s,t)=>{s.textContent=t},parentNode:s=>s.parentNode,nextSibling:s=>s.nextSibling,querySelector:s=>Ie.querySelector(s),setScopeId(s,t){s.setAttribute(t,"")},insertStaticContent(s,t,e,i,n,r){const o=e?e.previousSibling:t.lastChild;if(n&&(n===r||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),e),!(n===r||!(n=n.nextSibling)););else{ll.innerHTML=Uu(i==="svg"?`<svg>${s}</svg>`:i==="mathml"?`<math>${s}</math>`:s);const l=ll.content;if(i==="svg"||i==="mathml"){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}t.insertBefore(l,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},Id=Symbol("_vtc");function Bd(s,t,e){const i=s[Id];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?s.removeAttribute("class"):e?s.setAttribute("class",t):s.className=t}const al=Symbol("_vod"),Vd=Symbol("_vsh"),Fd=Symbol(""),Ud=/(?:^|;)\s*display\s*:/;function zd(s,t,e){const i=s.style,n=Lt(e);let r=!1;if(e&&!n){if(t)if(Lt(t))for(const o of t.split(";")){const l=o.slice(0,o.indexOf(":")).trim();e[l]==null&&en(i,l,"")}else for(const o in t)e[o]==null&&en(i,o,"");for(const o in e)o==="display"&&(r=!0),en(i,o,e[o])}else if(n){if(t!==e){const o=i[Fd];o&&(e+=";"+o),i.cssText=e,r=Ud.test(e)}}else t&&s.removeAttribute("style");al in s&&(s[al]=r?i.display:"",s[Vd]&&(i.display="none"))}const ul=/\s*!important$/;function en(s,t,e){if(tt(e))e.forEach(i=>en(s,t,i));else if(e==null&&(e=""),t.startsWith("--"))s.setProperty(t,e);else{const i=qd(s,t);ul.test(e)?s.setProperty(as(i),e.replace(ul,""),"important"):s[i]=e}}const hl=["Webkit","Moz","ms"],jn={};function qd(s,t){const e=jn[t];if(e)return e;let i=os(t);if(i!=="filter"&&i in s)return jn[t]=i;i=Ba(i);for(let n=0;n<hl.length;n++){const r=hl[n]+i;if(r in s)return jn[t]=r}return t}const cl="http://www.w3.org/1999/xlink";function dl(s,t,e,i,n,r=Qh(t)){i&&t.startsWith("xlink:")?e==null?s.removeAttributeNS(cl,t.slice(6,t.length)):s.setAttributeNS(cl,t,e):e==null||r&&!Fa(e)?s.removeAttribute(t):s.setAttribute(t,r?"":me(e)?String(e):e)}function fl(s,t,e,i,n){if(t==="innerHTML"||t==="textContent"){e!=null&&(s[t]=t==="innerHTML"?Uu(e):e);return}const r=s.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?s.getAttribute("value")||"":s.value,a=e==null?s.type==="checkbox"?"on":"":String(e);(l!==a||!("_value"in s))&&(s.value=a),e==null&&s.removeAttribute(t),s._value=e;return}let o=!1;if(e===""||e==null){const l=typeof s[t];l==="boolean"?e=Fa(e):e==null&&l==="string"?(e="",o=!0):l==="number"&&(e=0,o=!0)}try{s[t]=e}catch{}o&&s.removeAttribute(n||t)}function ss(s,t,e,i){s.addEventListener(t,e,i)}function Wd(s,t,e,i){s.removeEventListener(t,e,i)}const pl=Symbol("_vei");function Hd(s,t,e,i,n=null){const r=s[pl]||(s[pl]={}),o=r[t];if(i&&o)o.value=i;else{const[l,a]=Kd(t);if(i){const u=r[t]=Jd(i,n);ss(s,l,u,a)}else o&&(Wd(s,l,o,a),r[t]=void 0)}}const ml=/(?:Once|Passive|Capture)$/;function Kd(s){let t;if(ml.test(s)){t={};let i;for(;i=s.match(ml);)s=s.slice(0,s.length-i[0].length),t[i[0].toLowerCase()]=!0}return[s[2]===":"?s.slice(3):as(s.slice(2)),t]}let Gn=0;const jd=Promise.resolve(),Gd=()=>Gn||(jd.then(()=>Gn=0),Gn=Date.now());function Jd(s,t){const e=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=e.attached)return;Le(Xd(i,e.value),t,5,[i])};return e.value=s,e.attached=Gd(),e}function Xd(s,t){if(tt(t)){const e=s.stopImmediatePropagation;return s.stopImmediatePropagation=()=>{e.call(s),s._stopped=!0},t.map(i=>n=>!n._stopped&&i&&i(n))}else return t}const vl=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&s.charCodeAt(2)>96&&s.charCodeAt(2)<123,Yd=(s,t,e,i,n,r)=>{const o=n==="svg";t==="class"?Bd(s,i,o):t==="style"?zd(s,e,i):bn(t)?eo(t)||Hd(s,t,e,i,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Qd(s,t,i,o))?(fl(s,t,i),!s.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&dl(s,t,i,o,r,t!=="value")):s._isVueCE&&(/[A-Z]/.test(t)||!Lt(i))?fl(s,os(t),i,r,t):(t==="true-value"?s._trueValue=i:t==="false-value"&&(s._falseValue=i),dl(s,t,i,o))};function Qd(s,t,e,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in s&&vl(t)&&rt(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&s.tagName==="IFRAME"||t==="form"||t==="list"&&s.tagName==="INPUT"||t==="type"&&s.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const n=s.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return vl(t)&&Lt(e)?!1:t in s}const Vs=s=>{const t=s.props["onUpdate:modelValue"]||!1;return tt(t)?e=>Yi(t,e):t};function Zd(s){s.target.composing=!0}function gl(s){const t=s.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ze=Symbol("_assign");function bl(s,t,e){return t&&(s=s.trim()),e&&(s=_n(s)),s}const lt={created(s,{modifiers:{lazy:t,trim:e,number:i}},n){s[ze]=Vs(n);const r=i||n.props&&n.props.type==="number";ss(s,t?"change":"input",o=>{o.target.composing||s[ze](bl(s.value,e,r))}),(e||r)&&ss(s,"change",()=>{s.value=bl(s.value,e,r)}),t||(ss(s,"compositionstart",Zd),ss(s,"compositionend",gl),ss(s,"change",gl))},mounted(s,{value:t}){s.value=t??""},beforeUpdate(s,{value:t,oldValue:e,modifiers:{lazy:i,trim:n,number:r}},o){if(s[ze]=Vs(o),s.composing)return;const l=(r||s.type==="number")&&!/^0\d/.test(s.value)?_n(s.value):s.value,a=t??"";l!==a&&(document.activeElement===s&&s.type!=="range"&&(i&&t===e||n&&s.value.trim()===a)||(s.value=a))}},tf={deep:!0,created(s,t,e){s[ze]=Vs(e),ss(s,"change",()=>{const i=s._modelValue,n=yi(s),r=s.checked,o=s[ze];if(tt(i)){const l=no(i,n),a=l!==-1;if(r&&!a)o(i.concat(n));else if(!r&&a){const u=[...i];u.splice(l,1),o(u)}}else if(Ws(i)){const l=new Set(i);r?l.add(n):l.delete(n),o(l)}else o(zu(s,r))})},mounted:yl,beforeUpdate(s,t,e){s[ze]=Vs(e),yl(s,t,e)}};function yl(s,{value:t,oldValue:e},i){s._modelValue=t;let n;if(tt(t))n=no(t,i.props.value)>-1;else if(Ws(t))n=t.has(i.props.value);else{if(t===e)return;n=Ti(t,zu(s,!0))}s.checked!==n&&(s.checked=n)}const Ae={deep:!0,created(s,{value:t,modifiers:{number:e}},i){const n=Ws(t);ss(s,"change",()=>{const r=Array.prototype.filter.call(s.options,o=>o.selected).map(o=>e?_n(yi(o)):yi(o));s[ze](s.multiple?n?new Set(r):r:r[0]),s._assigning=!0,Is(()=>{s._assigning=!1})}),s[ze]=Vs(i)},mounted(s,{value:t}){_l(s,t)},beforeUpdate(s,t,e){s[ze]=Vs(e)},updated(s,{value:t}){s._assigning||_l(s,t)}};function _l(s,t){const e=s.multiple,i=tt(t);if(!(e&&!i&&!Ws(t))){for(let n=0,r=s.options.length;n<r;n++){const o=s.options[n],l=yi(o);if(e)if(i){const a=typeof l;a==="string"||a==="number"?o.selected=t.some(u=>String(u)===String(l)):o.selected=no(t,l)>-1}else o.selected=t.has(l);else if(Ti(yi(o),t)){s.selectedIndex!==n&&(s.selectedIndex=n);return}}!e&&s.selectedIndex!==-1&&(s.selectedIndex=-1)}}function yi(s){return"_value"in s?s._value:s.value}function zu(s,t){const e=t?"_trueValue":"_falseValue";return e in s?s[e]:t}const ef=["ctrl","shift","alt","meta"],sf={stop:s=>s.stopPropagation(),prevent:s=>s.preventDefault(),self:s=>s.target!==s.currentTarget,ctrl:s=>!s.ctrlKey,shift:s=>!s.shiftKey,alt:s=>!s.altKey,meta:s=>!s.metaKey,left:s=>"button"in s&&s.button!==0,middle:s=>"button"in s&&s.button!==1,right:s=>"button"in s&&s.button!==2,exact:(s,t)=>ef.some(e=>s[`${e}Key`]&&!t.includes(e))},ys=(s,t)=>{const e=s._withMods||(s._withMods={}),i=t.join(".");return e[i]||(e[i]=((n,...r)=>{for(let o=0;o<t.length;o++){const l=sf[t[o]];if(l&&l(n,t))return}return s(n,...r)}))},nf={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},yo=(s,t)=>{const e=s._withKeys||(s._withKeys={}),i=t.join(".");return e[i]||(e[i]=(n=>{if(!("key"in n))return;const r=as(n.key);if(t.some(o=>o===r||nf[o]===r))return s(n)}))},rf=zt({patchProp:Yd},Dd);let wl;function of(){return wl||(wl=md(rf))}const lf=((...s)=>{const t=of().createApp(...s),{mount:e}=t;return t.mount=i=>{const n=uf(i);if(!n)return;const r=t._component;!rt(r)&&!r.render&&!r.template&&(r.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const o=e(n,!1,af(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t});function af(s){if(s instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&s instanceof MathMLElement)return"mathml"}function uf(s){return Lt(s)?document.querySelector(s):s}const ks=typeof document<"u";function qu(s){return typeof s=="object"||"displayName"in s||"props"in s||"__vccOpts"in s}function hf(s){return s.__esModule||s[Symbol.toStringTag]==="Module"||s.default&&qu(s.default)}const ct=Object.assign;function Jn(s,t){const e={};for(const i in t){const n=t[i];e[i]=ge(n)?n.map(s):s(n)}return e}const ai=()=>{},ge=Array.isArray;function Sl(s,t){const e={};for(const i in s)e[i]=i in t?t[i]:s[i];return e}const Wu=/#/g,cf=/&/g,df=/\//g,ff=/=/g,pf=/\?/g,Hu=/\+/g,mf=/%5B/g,vf=/%5D/g,Ku=/%5E/g,gf=/%60/g,ju=/%7B/g,bf=/%7C/g,Gu=/%7D/g,yf=/%20/g;function _o(s){return s==null?"":encodeURI(""+s).replace(bf,"|").replace(mf,"[").replace(vf,"]")}function _f(s){return _o(s).replace(ju,"{").replace(Gu,"}").replace(Ku,"^")}function Nr(s){return _o(s).replace(Hu,"%2B").replace(yf,"+").replace(Wu,"%23").replace(cf,"%26").replace(gf,"`").replace(ju,"{").replace(Gu,"}").replace(Ku,"^")}function wf(s){return Nr(s).replace(ff,"%3D")}function Sf(s){return _o(s).replace(Wu,"%23").replace(pf,"%3F")}function xf(s){return Sf(s).replace(df,"%2F")}function _i(s){if(s==null)return null;try{return decodeURIComponent(""+s)}catch{}return""+s}const Cf=/\/$/,Ef=s=>s.replace(Cf,"");function Xn(s,t,e="/"){let i,n={},r="",o="";const l=t.indexOf("#");let a=t.indexOf("?");return a=l>=0&&a>l?-1:a,a>=0&&(i=t.slice(0,a),r=t.slice(a,l>0?l:t.length),n=s(r.slice(1))),l>=0&&(i=i||t.slice(0,l),o=t.slice(l,t.length)),i=Af(i??t,e),{fullPath:i+r+o,path:i,query:n,hash:_i(o)}}function Tf(s,t){const e=t.query?s(t.query):"";return t.path+(e&&"?")+e+(t.hash||"")}function xl(s,t){return!t||!s.toLowerCase().startsWith(t.toLowerCase())?s:s.slice(t.length)||"/"}function kf(s,t,e){const i=t.matched.length-1,n=e.matched.length-1;return i>-1&&i===n&&Fs(t.matched[i],e.matched[n])&&Ju(t.params,e.params)&&s(t.query)===s(e.query)&&t.hash===e.hash}function Fs(s,t){return(s.aliasOf||s)===(t.aliasOf||t)}function Ju(s,t){if(Object.keys(s).length!==Object.keys(t).length)return!1;for(var e in s)if(!Mf(s[e],t[e]))return!1;return!0}function Mf(s,t){return ge(s)?Cl(s,t):ge(t)?Cl(t,s):s?.valueOf()===t?.valueOf()}function Cl(s,t){return ge(t)?s.length===t.length&&s.every((e,i)=>e===t[i]):s.length===1&&s[0]===t}function Af(s,t){if(s.startsWith("/"))return s;if(!s)return t;const e=t.split("/"),i=s.split("/"),n=i[i.length-1];(n===".."||n===".")&&i.push("");let r=e.length-1,o,l;for(o=0;o<i.length;o++)if(l=i[o],l!==".")if(l==="..")r>1&&r--;else break;return e.slice(0,r).join("/")+"/"+i.slice(o).join("/")}const Xe={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let $r=(function(s){return s.pop="pop",s.push="push",s})({}),Yn=(function(s){return s.back="back",s.forward="forward",s.unknown="",s})({});function Of(s){if(!s)if(ks){const t=document.querySelector("base");s=t&&t.getAttribute("href")||"/",s=s.replace(/^\w+:\/\/[^\/]+/,"")}else s="/";return s[0]!=="/"&&s[0]!=="#"&&(s="/"+s),Ef(s)}const Lf=/^[^#]+#/;function Pf(s,t){return s.replace(Lf,"#")+t}function Rf(s,t){const e=document.documentElement.getBoundingClientRect(),i=s.getBoundingClientRect();return{behavior:t.behavior,left:i.left-e.left-(t.left||0),top:i.top-e.top-(t.top||0)}}const An=()=>({left:window.scrollX,top:window.scrollY});function Nf(s){let t;if("el"in s){const e=s.el,i=typeof e=="string"&&e.startsWith("#"),n=typeof e=="string"?i?document.getElementById(e.slice(1)):document.querySelector(e):e;if(!n)return;t=Rf(n,s)}else t=s;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function El(s,t){return(history.state?history.state.position-t:-1)+s}const Dr=new Map;function $f(s,t){Dr.set(s,t)}function Df(s){const t=Dr.get(s);return Dr.delete(s),t}function If(s){return typeof s=="string"||s&&typeof s=="object"}function Xu(s){return typeof s=="string"||typeof s=="symbol"}let Et=(function(s){return s[s.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",s[s.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",s[s.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",s[s.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",s[s.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",s})({});const Yu=Symbol("");Et.MATCHER_NOT_FOUND+"",Et.NAVIGATION_GUARD_REDIRECT+"",Et.NAVIGATION_ABORTED+"",Et.NAVIGATION_CANCELLED+"",Et.NAVIGATION_DUPLICATED+"";function Us(s,t){return ct(new Error,{type:s,[Yu]:!0},t)}function De(s,t){return s instanceof Error&&Yu in s&&(t==null||!!(s.type&t))}const Bf=["params","query","hash"];function Vf(s){if(typeof s=="string")return s;if(s.path!=null)return s.path;const t={};for(const e of Bf)e in s&&(t[e]=s[e]);return JSON.stringify(t,null,2)}function Ff(s){const t={};if(s===""||s==="?")return t;const e=(s[0]==="?"?s.slice(1):s).split("&");for(let i=0;i<e.length;++i){const n=e[i].replace(Hu," "),r=n.indexOf("="),o=_i(r<0?n:n.slice(0,r)),l=r<0?null:_i(n.slice(r+1));if(o in t){let a=t[o];ge(a)||(a=t[o]=[a]),a.push(l)}else t[o]=l}return t}function Tl(s){let t="";for(let e in s){const i=s[e];if(e=wf(e),i==null){i!==void 0&&(t+=(t.length?"&":"")+e);continue}(ge(i)?i.map(n=>n&&Nr(n)):[i&&Nr(i)]).forEach(n=>{n!==void 0&&(t+=(t.length?"&":"")+e,n!=null&&(t+="="+n))})}return t}function Uf(s){const t={};for(const e in s){const i=s[e];i!==void 0&&(t[e]=ge(i)?i.map(n=>n==null?null:""+n):i==null?i:""+i)}return t}const zf=Symbol(""),kl=Symbol(""),On=Symbol(""),wo=Symbol(""),Ir=Symbol("");function Ys(){let s=[];function t(i){return s.push(i),()=>{const n=s.indexOf(i);n>-1&&s.splice(n,1)}}function e(){s=[]}return{add:t,list:()=>s.slice(),reset:e}}function es(s,t,e,i,n,r=o=>o()){const o=i&&(i.enterCallbacks[n]=i.enterCallbacks[n]||[]);return()=>new Promise((l,a)=>{const u=f=>{f===!1?a(Us(Et.NAVIGATION_ABORTED,{from:e,to:t})):f instanceof Error?a(f):If(f)?a(Us(Et.NAVIGATION_GUARD_REDIRECT,{from:t,to:f})):(o&&i.enterCallbacks[n]===o&&typeof f=="function"&&o.push(f),l())},c=r(()=>s.call(i&&i.instances[n],t,e,u));let d=Promise.resolve(c);s.length<3&&(d=d.then(u)),d.catch(f=>a(f))})}function Qn(s,t,e,i,n=r=>r()){const r=[];for(const o of s)for(const l in o.components){let a=o.components[l];if(!(t!=="beforeRouteEnter"&&!o.instances[l]))if(qu(a)){const u=(a.__vccOpts||a)[t];u&&r.push(es(u,e,i,o,l,n))}else{let u=a();r.push(()=>u.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${l}" at "${o.path}"`);const d=hf(c)?c.default:c;o.mods[l]=c,o.components[l]=d;const f=(d.__vccOpts||d)[t];return f&&es(f,e,i,o,l,n)()}))}}return r}function qf(s,t){const e=[],i=[],n=[],r=Math.max(t.matched.length,s.matched.length);for(let o=0;o<r;o++){const l=t.matched[o];l&&(s.matched.find(u=>Fs(u,l))?i.push(l):e.push(l));const a=s.matched[o];a&&(t.matched.find(u=>Fs(u,a))||n.push(a))}return[e,i,n]}let Wf=()=>location.protocol+"//"+location.host;function Qu(s,t){const{pathname:e,search:i,hash:n}=t,r=s.indexOf("#");if(r>-1){let o=n.includes(s.slice(r))?s.slice(r).length:1,l=n.slice(o);return l[0]!=="/"&&(l="/"+l),xl(l,"")}return xl(e,s)+i+n}function Hf(s,t,e,i){let n=[],r=[],o=null;const l=({state:f})=>{const p=Qu(s,location),v=e.value,g=t.value;let _=0;if(f){if(e.value=p,t.value=f,o&&o===v){o=null;return}_=g?f.position-g.position:0}else i(p);n.forEach(w=>{w(e.value,v,{delta:_,type:$r.pop,direction:_?_>0?Yn.forward:Yn.back:Yn.unknown})})};function a(){o=e.value}function u(f){n.push(f);const p=()=>{const v=n.indexOf(f);v>-1&&n.splice(v,1)};return r.push(p),p}function c(){if(document.visibilityState==="hidden"){const{history:f}=window;if(!f.state)return;f.replaceState(ct({},f.state,{scroll:An()}),"")}}function d(){for(const f of r)f();r=[],window.removeEventListener("popstate",l),window.removeEventListener("pagehide",c),document.removeEventListener("visibilitychange",c)}return window.addEventListener("popstate",l),window.addEventListener("pagehide",c),document.addEventListener("visibilitychange",c),{pauseListeners:a,listen:u,destroy:d}}function Ml(s,t,e,i=!1,n=!1){return{back:s,current:t,forward:e,replaced:i,position:window.history.length,scroll:n?An():null}}function Kf(s){const{history:t,location:e}=window,i={value:Qu(s,e)},n={value:t.state};n.value||r(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function r(a,u,c){const d=s.indexOf("#"),f=d>-1?(e.host&&document.querySelector("base")?s:s.slice(d))+a:Wf()+s+a;try{t[c?"replaceState":"pushState"](u,"",f),n.value=u}catch(p){console.error(p),e[c?"replace":"assign"](f)}}function o(a,u){r(a,ct({},t.state,Ml(n.value.back,a,n.value.forward,!0),u,{position:n.value.position}),!0),i.value=a}function l(a,u){const c=ct({},n.value,t.state,{forward:a,scroll:An()});r(c.current,c,!0),r(a,ct({},Ml(i.value,a,null),{position:c.position+1},u),!1),i.value=a}return{location:i,state:n,push:l,replace:o}}function jf(s){s=Of(s);const t=Kf(s),e=Hf(s,t.state,t.location,t.replace);function i(r,o=!0){o||e.pauseListeners(),history.go(r)}const n=ct({location:"",base:s,go:i,createHref:Pf.bind(null,s)},t,e);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>t.state.value}),n}let ps=(function(s){return s[s.Static=0]="Static",s[s.Param=1]="Param",s[s.Group=2]="Group",s})({});var Pt=(function(s){return s[s.Static=0]="Static",s[s.Param=1]="Param",s[s.ParamRegExp=2]="ParamRegExp",s[s.ParamRegExpEnd=3]="ParamRegExpEnd",s[s.EscapeNext=4]="EscapeNext",s})(Pt||{});const Gf={type:ps.Static,value:""},Jf=/[a-zA-Z0-9_]/;function Xf(s){if(!s)return[[]];if(s==="/")return[[Gf]];if(!s.startsWith("/"))throw new Error(`Invalid path "${s}"`);function t(p){throw new Error(`ERR (${e})/"${u}": ${p}`)}let e=Pt.Static,i=e;const n=[];let r;function o(){r&&n.push(r),r=[]}let l=0,a,u="",c="";function d(){u&&(e===Pt.Static?r.push({type:ps.Static,value:u}):e===Pt.Param||e===Pt.ParamRegExp||e===Pt.ParamRegExpEnd?(r.length>1&&(a==="*"||a==="+")&&t(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),r.push({type:ps.Param,value:u,regexp:c,repeatable:a==="*"||a==="+",optional:a==="*"||a==="?"})):t("Invalid state to consume buffer"),u="")}function f(){u+=a}for(;l<s.length;){if(a=s[l++],a==="\\"&&e!==Pt.ParamRegExp){i=e,e=Pt.EscapeNext;continue}switch(e){case Pt.Static:a==="/"?(u&&d(),o()):a===":"?(d(),e=Pt.Param):f();break;case Pt.EscapeNext:f(),e=i;break;case Pt.Param:a==="("?e=Pt.ParamRegExp:Jf.test(a)?f():(d(),e=Pt.Static,a!=="*"&&a!=="?"&&a!=="+"&&l--);break;case Pt.ParamRegExp:a===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+a:e=Pt.ParamRegExpEnd:c+=a;break;case Pt.ParamRegExpEnd:d(),e=Pt.Static,a!=="*"&&a!=="?"&&a!=="+"&&l--,c="";break;default:t("Unknown state");break}}return e===Pt.ParamRegExp&&t(`Unfinished custom RegExp for param "${u}"`),d(),o(),n}const Al="[^/]+?",Yf={sensitive:!1,strict:!1,start:!0,end:!0};var Ht=(function(s){return s[s._multiplier=10]="_multiplier",s[s.Root=90]="Root",s[s.Segment=40]="Segment",s[s.SubSegment=30]="SubSegment",s[s.Static=40]="Static",s[s.Dynamic=20]="Dynamic",s[s.BonusCustomRegExp=10]="BonusCustomRegExp",s[s.BonusWildcard=-50]="BonusWildcard",s[s.BonusRepeatable=-20]="BonusRepeatable",s[s.BonusOptional=-8]="BonusOptional",s[s.BonusStrict=.7000000000000001]="BonusStrict",s[s.BonusCaseSensitive=.25]="BonusCaseSensitive",s})(Ht||{});const Qf=/[.+*?^${}()[\]/\\]/g;function Zf(s,t){const e=ct({},Yf,t),i=[];let n=e.start?"^":"";const r=[];for(const u of s){const c=u.length?[]:[Ht.Root];e.strict&&!u.length&&(n+="/");for(let d=0;d<u.length;d++){const f=u[d];let p=Ht.Segment+(e.sensitive?Ht.BonusCaseSensitive:0);if(f.type===ps.Static)d||(n+="/"),n+=f.value.replace(Qf,"\\$&"),p+=Ht.Static;else if(f.type===ps.Param){const{value:v,repeatable:g,optional:_,regexp:w}=f;r.push({name:v,repeatable:g,optional:_});const y=w||Al;if(y!==Al){p+=Ht.BonusCustomRegExp;try{`${y}`}catch(D){throw new Error(`Invalid custom RegExp for param "${v}" (${y}): `+D.message)}}let M=g?`((?:${y})(?:/(?:${y}))*)`:`(${y})`;d||(M=_&&u.length<2?`(?:/${M})`:"/"+M),_&&(M+="?"),n+=M,p+=Ht.Dynamic,_&&(p+=Ht.BonusOptional),g&&(p+=Ht.BonusRepeatable),y===".*"&&(p+=Ht.BonusWildcard)}c.push(p)}i.push(c)}if(e.strict&&e.end){const u=i.length-1;i[u][i[u].length-1]+=Ht.BonusStrict}e.strict||(n+="/?"),e.end?n+="$":e.strict&&!n.endsWith("/")&&(n+="(?:/|$)");const o=new RegExp(n,e.sensitive?"":"i");function l(u){const c=u.match(o),d={};if(!c)return null;for(let f=1;f<c.length;f++){const p=c[f]||"",v=r[f-1];d[v.name]=p&&v.repeatable?p.split("/"):p}return d}function a(u){let c="",d=!1;for(const f of s){(!d||!c.endsWith("/"))&&(c+="/"),d=!1;for(const p of f)if(p.type===ps.Static)c+=p.value;else if(p.type===ps.Param){const{value:v,repeatable:g,optional:_}=p,w=v in u?u[v]:"";if(ge(w)&&!g)throw new Error(`Provided param "${v}" is an array but it is not repeatable (* or + modifiers)`);const y=ge(w)?w.join("/"):w;if(!y)if(_)f.length<2&&(c.endsWith("/")?c=c.slice(0,-1):d=!0);else throw new Error(`Missing required param "${v}"`);c+=y}}return c||"/"}return{re:o,score:i,keys:r,parse:l,stringify:a}}function tp(s,t){let e=0;for(;e<s.length&&e<t.length;){const i=t[e]-s[e];if(i)return i;e++}return s.length<t.length?s.length===1&&s[0]===Ht.Static+Ht.Segment?-1:1:s.length>t.length?t.length===1&&t[0]===Ht.Static+Ht.Segment?1:-1:0}function Zu(s,t){let e=0;const i=s.score,n=t.score;for(;e<i.length&&e<n.length;){const r=tp(i[e],n[e]);if(r)return r;e++}if(Math.abs(n.length-i.length)===1){if(Ol(i))return 1;if(Ol(n))return-1}return n.length-i.length}function Ol(s){const t=s[s.length-1];return s.length>0&&t[t.length-1]<0}const ep={strict:!1,end:!0,sensitive:!1};function sp(s,t,e){const i=Zf(Xf(s.path),e),n=ct(i,{record:s,parent:t,children:[],alias:[]});return t&&!n.record.aliasOf==!t.record.aliasOf&&t.children.push(n),n}function ip(s,t){const e=[],i=new Map;t=Sl(ep,t);function n(d){return i.get(d)}function r(d,f,p){const v=!p,g=Pl(d);g.aliasOf=p&&p.record;const _=Sl(t,d),w=[g];if("alias"in d){const D=typeof d.alias=="string"?[d.alias]:d.alias;for(const X of D)w.push(Pl(ct({},g,{components:p?p.record.components:g.components,path:X,aliasOf:p?p.record:g})))}let y,M;for(const D of w){const{path:X}=D;if(f&&X[0]!=="/"){const nt=f.record.path,Z=nt[nt.length-1]==="/"?"":"/";D.path=f.record.path+(X&&Z+X)}if(y=sp(D,f,_),p?p.alias.push(y):(M=M||y,M!==y&&M.alias.push(y),v&&d.name&&!Rl(y)&&o(d.name)),th(y)&&a(y),g.children){const nt=g.children;for(let Z=0;Z<nt.length;Z++)r(nt[Z],y,p&&p.children[Z])}p=p||y}return M?()=>{o(M)}:ai}function o(d){if(Xu(d)){const f=i.get(d);f&&(i.delete(d),e.splice(e.indexOf(f),1),f.children.forEach(o),f.alias.forEach(o))}else{const f=e.indexOf(d);f>-1&&(e.splice(f,1),d.record.name&&i.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function l(){return e}function a(d){const f=op(d,e);e.splice(f,0,d),d.record.name&&!Rl(d)&&i.set(d.record.name,d)}function u(d,f){let p,v={},g,_;if("name"in d&&d.name){if(p=i.get(d.name),!p)throw Us(Et.MATCHER_NOT_FOUND,{location:d});_=p.record.name,v=ct(Ll(f.params,p.keys.filter(M=>!M.optional).concat(p.parent?p.parent.keys.filter(M=>M.optional):[]).map(M=>M.name)),d.params&&Ll(d.params,p.keys.map(M=>M.name))),g=p.stringify(v)}else if(d.path!=null)g=d.path,p=e.find(M=>M.re.test(g)),p&&(v=p.parse(g),_=p.record.name);else{if(p=f.name?i.get(f.name):e.find(M=>M.re.test(f.path)),!p)throw Us(Et.MATCHER_NOT_FOUND,{location:d,currentLocation:f});_=p.record.name,v=ct({},f.params,d.params),g=p.stringify(v)}const w=[];let y=p;for(;y;)w.unshift(y.record),y=y.parent;return{name:_,path:g,params:v,matched:w,meta:rp(w)}}s.forEach(d=>r(d));function c(){e.length=0,i.clear()}return{addRoute:r,resolve:u,removeRoute:o,clearRoutes:c,getRoutes:l,getRecordMatcher:n}}function Ll(s,t){const e={};for(const i of t)i in s&&(e[i]=s[i]);return e}function Pl(s){const t={path:s.path,redirect:s.redirect,name:s.name,meta:s.meta||{},aliasOf:s.aliasOf,beforeEnter:s.beforeEnter,props:np(s),children:s.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in s?s.components||null:s.component&&{default:s.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function np(s){const t={},e=s.props||!1;if("component"in s)t.default=e;else for(const i in s.components)t[i]=typeof e=="object"?e[i]:e;return t}function Rl(s){for(;s;){if(s.record.aliasOf)return!0;s=s.parent}return!1}function rp(s){return s.reduce((t,e)=>ct(t,e.meta),{})}function op(s,t){let e=0,i=t.length;for(;e!==i;){const r=e+i>>1;Zu(s,t[r])<0?i=r:e=r+1}const n=lp(s);return n&&(i=t.lastIndexOf(n,i-1)),i}function lp(s){let t=s;for(;t=t.parent;)if(th(t)&&Zu(s,t)===0)return t}function th({record:s}){return!!(s.name||s.components&&Object.keys(s.components).length||s.redirect)}function Nl(s){const t=pe(On),e=pe(wo),i=ht(()=>{const a=Ct(s.to);return t.resolve(a)}),n=ht(()=>{const{matched:a}=i.value,{length:u}=a,c=a[u-1],d=e.matched;if(!c||!d.length)return-1;const f=d.findIndex(Fs.bind(null,c));if(f>-1)return f;const p=$l(a[u-2]);return u>1&&$l(c)===p&&d[d.length-1].path!==p?d.findIndex(Fs.bind(null,a[u-2])):f}),r=ht(()=>n.value>-1&&cp(e.params,i.value.params)),o=ht(()=>n.value>-1&&n.value===e.matched.length-1&&Ju(e.params,i.value.params));function l(a={}){if(hp(a)){const u=t[Ct(s.replace)?"replace":"push"](Ct(s.to)).catch(ai);return s.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:i,href:ht(()=>i.value.href),isActive:r,isExactActive:o,navigate:l}}function ap(s){return s.length===1?s[0]:s}const up=fu({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Nl,setup(s,{slots:t}){const e=Gt(Nl(s)),{options:i}=pe(On),n=ht(()=>({[Dl(s.activeClass,i.linkActiveClass,"router-link-active")]:e.isActive,[Dl(s.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:e.isExactActive}));return()=>{const r=t.default&&ap(t.default(e));return s.custom?r:Fu("a",{"aria-current":e.isExactActive?s.ariaCurrentValue:null,href:e.href,onClick:e.navigate,class:n.value},r)}}}),Dt=up;function hp(s){if(!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)&&!s.defaultPrevented&&!(s.button!==void 0&&s.button!==0)){if(s.currentTarget&&s.currentTarget.getAttribute){const t=s.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return s.preventDefault&&s.preventDefault(),!0}}function cp(s,t){for(const e in t){const i=t[e],n=s[e];if(typeof i=="string"){if(i!==n)return!1}else if(!ge(n)||n.length!==i.length||i.some((r,o)=>r.valueOf()!==n[o].valueOf()))return!1}return!0}function $l(s){return s?s.aliasOf?s.aliasOf.path:s.path:""}const Dl=(s,t,e)=>s??t??e,dp=fu({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(s,{attrs:t,slots:e}){const i=pe(Ir),n=ht(()=>s.route||i.value),r=pe(kl,0),o=ht(()=>{let u=Ct(r);const{matched:c}=n.value;let d;for(;(d=c[u])&&!d.components;)u++;return u}),l=ht(()=>n.value.matched[o.value]);Qi(kl,ht(()=>o.value+1)),Qi(zf,l),Qi(Ir,n);const a=$();return ns(()=>[a.value,l.value,s.name],([u,c,d],[f,p,v])=>{c&&(c.instances[d]=u,p&&p!==c&&u&&u===f&&(c.leaveGuards.size||(c.leaveGuards=p.leaveGuards),c.updateGuards.size||(c.updateGuards=p.updateGuards))),u&&c&&(!p||!Fs(c,p)||!f)&&(c.enterCallbacks[d]||[]).forEach(g=>g(u))},{flush:"post"}),()=>{const u=n.value,c=s.name,d=l.value,f=d&&d.components[c];if(!f)return Il(e.default,{Component:f,route:u});const p=d.props[c],v=p?p===!0?u.params:typeof p=="function"?p(u):p:null,_=Fu(f,ct({},v,t,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(d.instances[c]=null)},ref:a}));return Il(e.default,{Component:_,route:u})||_}}});function Il(s,t){if(!s)return null;const e=s(t);return e.length===1?e[0]:e}const eh=dp;function fp(s){const t=ip(s.routes,s),e=s.parseQuery||Ff,i=s.stringifyQuery||Tl,n=s.history,r=Ys(),o=Ys(),l=Ys(),a=wc(Xe);let u=Xe;ks&&s.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=Jn.bind(null,N=>""+N),d=Jn.bind(null,xf),f=Jn.bind(null,_i);function p(N,T){let E,F;return Xu(N)?(E=t.getRecordMatcher(N),F=T):F=N,t.addRoute(F,E)}function v(N){const T=t.getRecordMatcher(N);T&&t.removeRoute(T)}function g(){return t.getRoutes().map(N=>N.record)}function _(N){return!!t.getRecordMatcher(N)}function w(N,T){if(T=ct({},T||a.value),typeof N=="string"){const S=Xn(e,N,T.path),A=t.resolve({path:S.path},T),L=n.createHref(S.fullPath);return ct(S,A,{params:f(A.params),hash:_i(S.hash),redirectedFrom:void 0,href:L})}let E;if(N.path!=null)E=ct({},N,{path:Xn(e,N.path,T.path).path});else{const S=ct({},N.params);for(const A in S)S[A]==null&&delete S[A];E=ct({},N,{params:d(S)}),T.params=d(T.params)}const F=t.resolve(E,T),J=N.hash||"";F.params=c(f(F.params));const m=Tf(i,ct({},N,{hash:_f(J),path:F.path})),b=n.createHref(m);return ct({fullPath:m,hash:J,query:i===Tl?Uf(N.query):N.query||{}},F,{redirectedFrom:void 0,href:b})}function y(N){return typeof N=="string"?Xn(e,N,a.value.path):ct({},N)}function M(N,T){if(u!==N)return Us(Et.NAVIGATION_CANCELLED,{from:T,to:N})}function D(N){return Z(N)}function X(N){return D(ct(y(N),{replace:!0}))}function nt(N,T){const E=N.matched[N.matched.length-1];if(E&&E.redirect){const{redirect:F}=E;let J=typeof F=="function"?F(N,T):F;return typeof J=="string"&&(J=J.includes("?")||J.includes("#")?J=y(J):{path:J},J.params={}),ct({query:N.query,hash:N.hash,params:J.path!=null?{}:N.params},J)}}function Z(N,T){const E=u=w(N),F=a.value,J=N.state,m=N.force,b=N.replace===!0,S=nt(E,F);if(S)return Z(ct(y(S),{state:typeof S=="object"?ct({},J,S.state):J,force:m,replace:b}),T||E);const A=E;A.redirectedFrom=T;let L;return!m&&kf(i,F,E)&&(L=Us(Et.NAVIGATION_DUPLICATED,{to:A,from:F}),Bt(F,F,!0,!1)),(L?Promise.resolve(L):B(A,F)).catch(P=>De(P)?De(P,Et.NAVIGATION_GUARD_REDIRECT)?P:Nt(P):G(P,A,F)).then(P=>{if(P){if(De(P,Et.NAVIGATION_GUARD_REDIRECT))return Z(ct({replace:b},y(P.to),{state:typeof P.to=="object"?ct({},J,P.to.state):J,force:m}),T||A)}else P=Tt(A,F,!0,b,J);return mt(A,F,P),P})}function V(N,T){const E=M(N,T);return E?Promise.reject(E):Promise.resolve()}function O(N){const T=Re.values().next().value;return T&&typeof T.runWithContext=="function"?T.runWithContext(N):N()}function B(N,T){let E;const[F,J,m]=qf(N,T);E=Qn(F.reverse(),"beforeRouteLeave",N,T);for(const S of F)S.leaveGuards.forEach(A=>{E.push(es(A,N,T))});const b=V.bind(null,N,T);return E.push(b),Zt(E).then(()=>{E=[];for(const S of r.list())E.push(es(S,N,T));return E.push(b),Zt(E)}).then(()=>{E=Qn(J,"beforeRouteUpdate",N,T);for(const S of J)S.updateGuards.forEach(A=>{E.push(es(A,N,T))});return E.push(b),Zt(E)}).then(()=>{E=[];for(const S of m)if(S.beforeEnter)if(ge(S.beforeEnter))for(const A of S.beforeEnter)E.push(es(A,N,T));else E.push(es(S.beforeEnter,N,T));return E.push(b),Zt(E)}).then(()=>(N.matched.forEach(S=>S.enterCallbacks={}),E=Qn(m,"beforeRouteEnter",N,T,O),E.push(b),Zt(E))).then(()=>{E=[];for(const S of o.list())E.push(es(S,N,T));return E.push(b),Zt(E)}).catch(S=>De(S,Et.NAVIGATION_CANCELLED)?S:Promise.reject(S))}function mt(N,T,E){l.list().forEach(F=>O(()=>F(N,T,E)))}function Tt(N,T,E,F,J){const m=M(N,T);if(m)return m;const b=T===Xe,S=ks?history.state:{};E&&(F||b?n.replace(N.fullPath,ct({scroll:b&&S&&S.scroll},J)):n.push(N.fullPath,J)),a.value=N,Bt(N,T,E,b),Nt()}let At;function Qt(){At||(At=n.listen((N,T,E)=>{if(!Ne.listening)return;const F=w(N),J=nt(F,Ne.currentRoute.value);if(J){Z(ct(J,{replace:!0,force:!0}),F).catch(ai);return}u=F;const m=a.value;ks&&$f(El(m.fullPath,E.delta),An()),B(F,m).catch(b=>De(b,Et.NAVIGATION_ABORTED|Et.NAVIGATION_CANCELLED)?b:De(b,Et.NAVIGATION_GUARD_REDIRECT)?(Z(ct(y(b.to),{force:!0}),F).then(S=>{De(S,Et.NAVIGATION_ABORTED|Et.NAVIGATION_DUPLICATED)&&!E.delta&&E.type===$r.pop&&n.go(-1,!1)}).catch(ai),Promise.reject()):(E.delta&&n.go(-E.delta,!1),G(b,F,m))).then(b=>{b=b||Tt(F,m,!1),b&&(E.delta&&!De(b,Et.NAVIGATION_CANCELLED)?n.go(-E.delta,!1):E.type===$r.pop&&De(b,Et.NAVIGATION_ABORTED|Et.NAVIGATION_DUPLICATED)&&n.go(-1,!1)),mt(F,m,b)}).catch(ai)}))}let qt=Ys(),W=Ys(),R;function G(N,T,E){Nt(N);const F=W.list();return F.length?F.forEach(J=>J(N,T,E)):console.error(N),Promise.reject(N)}function It(){return R&&a.value!==Xe?Promise.resolve():new Promise((N,T)=>{qt.add([N,T])})}function Nt(N){return R||(R=!N,Qt(),qt.list().forEach(([T,E])=>N?E(N):T()),qt.reset()),N}function Bt(N,T,E,F){const{scrollBehavior:J}=s;if(!ks||!J)return Promise.resolve();const m=!E&&Df(El(N.fullPath,0))||(F||!E)&&history.state&&history.state.scroll||null;return Is().then(()=>J(N,T,m)).then(b=>b&&Nf(b)).catch(b=>G(b,N,T))}const Rt=N=>n.go(N);let ye;const Re=new Set,Ne={currentRoute:a,listening:!0,addRoute:p,removeRoute:v,clearRoutes:t.clearRoutes,hasRoute:_,getRoutes:g,resolve:w,options:s,push:D,replace:X,go:Rt,back:()=>Rt(-1),forward:()=>Rt(1),beforeEach:r.add,beforeResolve:o.add,afterEach:l.add,onError:W.add,isReady:It,install(N){N.component("RouterLink",Dt),N.component("RouterView",eh),N.config.globalProperties.$router=Ne,Object.defineProperty(N.config.globalProperties,"$route",{enumerable:!0,get:()=>Ct(a)}),ks&&!ye&&a.value===Xe&&(ye=!0,D(n.location).catch(F=>{}));const T={};for(const F in Xe)Object.defineProperty(T,F,{get:()=>a.value[F],enumerable:!0});N.provide(On,Ne),N.provide(wo,iu(T)),N.provide(Ir,a);const E=N.unmount;Re.add(N),N.unmount=function(){Re.delete(N),Re.size<1&&(u=Xe,At&&At(),At=null,a.value=Xe,ye=!1,R=!1),E()}}};function Zt(N){return N.reduce((T,E)=>T.then(()=>O(E)),Promise.resolve())}return Ne}function xs(){return pe(On)}function sh(s){return pe(wo)}const pp={__name:"App",setup(s){return(t,e)=>(C(),Xt(Ct(eh)))}},mp={"Content-Type":"application/json"};class vp{#t=null;setToken(t){this.#t=t?String(t):null}async request(t,{method:e="GET",body:i=void 0,headers:n={}}={}){const r={...mp,...n};this.#t&&(r.Authorization=`Bearer ${this.#t}`);const o=await fetch(t,{method:e,headers:r,body:i===void 0?void 0:JSON.stringify(i)}),l=await o.json().catch(()=>null);if(o.ok)return l;const a=l&&typeof l=="object"&&l.error?String(l.error):`: ${o.status}`,u=new Error(a);throw u.status=o.status,u.payload=l,u}}const st=new vp,Br="arkilo_session_token",St=Gt({token:sessionStorage.getItem(Br)||null,user:null,isAdmin:!1,initialized:!1});st.setToken(St.token);function Ai(s){St.token=s,st.setToken(s),s?sessionStorage.setItem(Br,s):sessionStorage.removeItem(Br)}async function gp(){if(!St.initialized){if(!St.token){St.initialized=!0;return}try{const s=await st.request("/api/auth/me");St.user=s.user||null;try{await st.request("/api/admin/activation-codes?limit=1&offset=0"),St.isAdmin=!0}catch{St.isAdmin=!1}}catch{Ai(null)}finally{St.initialized=!0}}}async function bp(){if(!St.token)return St.user=null,St.isAdmin=!1,null;const s=await st.request("/api/auth/me");return St.user=s.user||null,St.user}async function yp({email:s,password:t}){const e=await st.request("/api/auth/login",{method:"POST",body:{email:s,password:t}});Ai(e.token),St.user=e.user;try{await st.request("/api/admin/activation-codes?limit=1&offset=0"),St.isAdmin=!0}catch{St.isAdmin=!1}return e.user}async function _p({email:s,password:t,displayName:e}){const i=await st.request("/api/auth/register",{method:"POST",body:{email:s,password:t,displayName:e||void 0}});Ai(i.token),St.user=i.user;try{await st.request("/api/admin/activation-codes?limit=1&offset=0"),St.isAdmin=!0}catch{St.isAdmin=!1}return i.user}async function wp(){try{await st.request("/api/auth/logout",{method:"POST"})}finally{St.user=null,St.isAdmin=!1,Ai(null)}}function Ge(){return{token:ht(()=>St.token),user:ht(()=>St.user),isAdmin:ht(()=>St.isAdmin),initialized:ht(()=>St.initialized),init:gp,refreshUser:bp,login:yp,register:_p,logout:wp,setToken:Ai}}const Oi="/logo.png",Sp={class:"auth-page"},xp={class:"auth-container"},Cp={class:"auth-card"},Ep={class:"form-group"},Tp={class:"form-group"},kp={key:0,class:"form-error"},Mp=["disabled"],Ap={class:"auth-footer"},Op={__name:"LoginPage",setup(s){const t=Ge(),e=xs(),i=$(""),n=$(""),r=$(""),o=$(!1);async function l(){r.value="",o.value=!0;try{await t.login({email:i.value.trim(),password:n.value}),await e.push("/app")}catch(a){r.value=a?.message||""}finally{o.value=!1}}return(a,u)=>(C(),k("div",Sp,[h("div",xp,[h("div",Cp,[u[6]||(u[6]=go('<div class="auth-header"><div class="auth-logo"><img src="'+Oi+'" alt="Arkilo"><span>Arkilo</span></div><h1 class="auth-title"></h1><p class="auth-subtitle"> SaaS </p></div>',1)),h("form",{onSubmit:ys(l,["prevent"])},[h("div",Ep,[u[2]||(u[2]=h("label",{class:"form-label",for:"email"},"",-1)),et(h("input",{id:"email","onUpdate:modelValue":u[0]||(u[0]=c=>i.value=c),class:"form-input",type:"email",autocomplete:"email",required:""},null,512),[[lt,i.value]])]),h("div",Tp,[u[3]||(u[3]=h("label",{class:"form-label",for:"password"},"",-1)),et(h("input",{id:"password","onUpdate:modelValue":u[1]||(u[1]=c=>n.value=c),class:"form-input",type:"password",autocomplete:"current-password",required:""},null,512),[[lt,n.value]]),r.value?(C(),k("p",kp,x(r.value),1)):K("",!0)]),h("button",{class:"btn btn-primary btn-full",type:"submit",disabled:o.value},x(o.value?"...":""),9,Mp)],32),h("div",Ap,[h("p",null,[u[5]||(u[5]=kt("  ",-1)),at(Ct(Dt),{class:"link",to:"/register"},{default:bt(()=>[...u[4]||(u[4]=[kt("",-1)])]),_:1})])])])])]))}},Lp={class:"auth-page"},Pp={class:"auth-container"},Rp={class:"auth-card"},Np={class:"form-group"},$p={class:"form-group"},Dp={class:"form-group"},Ip={key:0,class:"form-error"},Bp=["disabled"],Vp={class:"auth-footer"},Fp={__name:"RegisterPage",setup(s){const t=Ge(),e=xs(),i=$(""),n=$(""),r=$(""),o=$(""),l=$(!1);async function a(){o.value="",l.value=!0;try{await t.register({email:n.value.trim(),password:r.value,displayName:i.value.trim()}),await e.push("/app")}catch(u){o.value=u?.message||""}finally{l.value=!1}}return(u,c)=>(C(),k("div",Lp,[h("div",Pp,[h("div",Rp,[c[8]||(c[8]=go('<div class="auth-header"><div class="auth-logo"><img src="'+Oi+'" alt="Arkilo"><span>Arkilo</span></div><h1 class="auth-title"></h1><p class="auth-subtitle"></p></div>',1)),h("form",{onSubmit:ys(a,["prevent"])},[h("div",Np,[c[3]||(c[3]=h("label",{class:"form-label",for:"displayName"},"",-1)),et(h("input",{id:"displayName","onUpdate:modelValue":c[0]||(c[0]=d=>i.value=d),class:"form-input",type:"text",maxlength:"80"},null,512),[[lt,i.value]])]),h("div",$p,[c[4]||(c[4]=h("label",{class:"form-label",for:"email"},"",-1)),et(h("input",{id:"email","onUpdate:modelValue":c[1]||(c[1]=d=>n.value=d),class:"form-input",type:"email",autocomplete:"email",required:""},null,512),[[lt,n.value]])]),h("div",Dp,[c[5]||(c[5]=h("label",{class:"form-label",for:"password"},"",-1)),et(h("input",{id:"password","onUpdate:modelValue":c[2]||(c[2]=d=>r.value=d),class:"form-input",type:"password",autocomplete:"new-password",required:""},null,512),[[lt,r.value]]),o.value?(C(),k("p",Ip,x(o.value),1)):K("",!0)]),h("button",{class:"btn btn-primary btn-full",type:"submit",disabled:l.value},x(l.value?"...":""),9,Bp)],32),h("div",Vp,[h("p",null,[c[7]||(c[7]=kt("  ",-1)),at(Ct(Dt),{class:"link",to:"/login"},{default:bt(()=>[...c[6]||(c[6]=[kt("",-1)])]),_:1})])])])])]))}},Up={class:"auth-page"},zp={class:"auth-container"},qp={class:"auth-card"},Wp={class:"card-content"},Hp={key:0,class:"text-muted"},Kp={key:1,class:"text-muted"},jp={key:2,class:"form-success"},Gp={key:3,class:"form-error"},Jp={class:"input-with-button"},Xp=["disabled"],Yp={class:"auth-footer"},Qp={__name:"VerifyEmailPage",setup(s){const t=sh(),e=xs(),i=Ge(),n=ht(()=>String(t.query.token||"").trim()),r=$("idle"),o=$("");async function l(){if(o.value="",!n.value){r.value="error",o.value=" token";return}r.value="verifying";try{await st.request("/api/auth/email-verifications/verify",{method:"POST",body:{token:n.value}}),r.value="success",await i.refreshUser().catch(()=>null),i.user.value&&await e.push("/app")}catch(a){r.value="error",o.value=a?.message||""}}return ae(l),(a,u)=>(C(),k("div",Up,[h("div",zp,[h("div",qp,[u[1]||(u[1]=go('<div class="auth-header"><div class="auth-logo"><img src="'+Oi+'" alt="Arkilo"><span>Arkilo</span></div><h1 class="auth-title"></h1><p class="auth-subtitle"> AI </p></div>',1)),h("div",Wp,[r.value==="idle"?(C(),k("p",Hp,"...")):K("",!0),r.value==="verifying"?(C(),k("p",Kp,"...")):K("",!0),r.value==="success"?(C(),k("p",jp,"")):K("",!0),r.value==="error"?(C(),k("p",Gp,x(o.value),1)):K("",!0),h("div",Jp,[h("button",{class:"btn btn-primary btn-full",type:"button",disabled:r.value==="verifying",onClick:l},x(r.value==="verifying"?"...":""),9,Xp)]),h("div",Yp,[at(Ct(Dt),{class:"link",to:"/login"},{default:bt(()=>[...u[0]||(u[0]=[kt("",-1)])]),_:1})])])])])]))}},Zp={class:"app-layout"},tm={class:"sidebar"},em={class:"nav-menu"},sm={class:"main-content"},im={class:"topbar"},nm={class:"topbar-title"},rm={key:0},om={class:"topbar-user"},lm={class:"user-name"},am={class:"content-wrapper"},um={key:0,class:"card card-warn"},hm={class:"card-content banner-row"},cm={key:0,class:"banner-msg"},dm=["disabled"],fm={key:0,class:"card-content"},pm=["href"],Ln={__name:"AppShell",props:{title:{type:String,required:!0},subtitle:{type:String,default:""}},setup(s){const t=Ge(),e=xs();ht(()=>t.user.value?.email||"");const i=ht(()=>t.user.value?.display_name||t.user.value?.email||""),n=ht(()=>t.isAdmin.value),r=ht(()=>!!t.user.value&&!t.user.value?.email_verified_at),o=$(!1),l=$(""),a=$("");async function u(){await t.logout(),await e.push("/login")}async function c(){l.value="",a.value="",o.value=!0;try{const d=await st.request("/api/auth/email-verifications/send",{method:"POST"});l.value=d?.alreadyVerified?"":"",a.value=d?.debugLink||"",await t.refreshUser().catch(()=>null)}catch(d){l.value=d?.message||""}finally{o.value=!1}}return(d,f)=>(C(),k("div",Zp,[h("aside",tm,[f[5]||(f[5]=h("div",{class:"sidebar-header"},[h("div",{class:"logo"},[h("img",{src:Oi,alt:"Arkilo"}),h("span",null,"Arkilo Console")])],-1)),h("nav",em,[at(Ct(Dt),{class:"nav-item",to:"/app"},{default:bt(()=>[...f[0]||(f[0]=[kt("",-1)])]),_:1}),at(Ct(Dt),{class:"nav-item",to:"/app/ai"},{default:bt(()=>[...f[1]||(f[1]=[kt("AI ",-1)])]),_:1}),at(Ct(Dt),{class:"nav-item",to:"/app/providers"},{default:bt(()=>[...f[2]||(f[2]=[kt("AI ",-1)])]),_:1}),at(Ct(Dt),{class:"nav-item",to:"/app/subscription"},{default:bt(()=>[...f[3]||(f[3]=[kt("",-1)])]),_:1}),n.value?(C(),Xt(Ct(Dt),{key:0,class:"nav-item",to:"/admin"},{default:bt(()=>[...f[4]||(f[4]=[kt("",-1)])]),_:1})):K("",!0)]),h("div",{class:"sidebar-footer"},[h("button",{class:"btn btn-secondary btn-full",type:"button",onClick:u},"")])]),h("main",sm,[h("header",im,[h("div",nm,[h("h1",null,x(s.title),1),s.subtitle?(C(),k("p",rm,x(s.subtitle),1)):K("",!0)]),h("div",om,[h("span",lm,x(i.value),1)])]),h("div",am,[r.value?(C(),k("div",um,[h("div",hm,[h("div",null,[f[6]||(f[6]=h("div",{class:"banner-title"},"",-1)),f[7]||(f[7]=h("div",{class:"text-muted"},"",-1)),l.value?(C(),k("div",cm,x(l.value),1)):K("",!0)]),h("button",{class:"btn btn-primary",type:"button",disabled:o.value,onClick:c},x(o.value?"...":""),9,dm)]),a.value?(C(),k("div",fm,[f[8]||(f[8]=h("div",{class:"text-muted"}," SMTP",-1)),h("a",{class:"link",href:a.value},x(a.value),9,pm)])):K("",!0)])):K("",!0),bu(d.$slots,"default")])])]))}},mm=3e4,ie=Gt({value:null,fetchedAt:0,pending:null});function vm(){return ie.value&&Date.now()-ie.fetchedAt<mm}async function gm(){const s=await st.request("/api/console/overview");return ie.value=s,ie.fetchedAt=Date.now(),s}function bm(){async function s({force:e=!1}={}){return!e&&vm()?ie.value:(ie.pending||(ie.pending=gm().finally(()=>{ie.pending=null})),ie.pending)}function t(){ie.value=null,ie.fetchedAt=0,ie.pending=null}return{state:ie,get:s,invalidate:t}}const ym={class:"card balance-card"},_m={class:"balance-header"},wm={class:"card-content"},Sm={class:"balance-row"},xm={class:"balance-value"},Cm={class:"progress-bar"},Em={class:"grid grid-2"},Tm={class:"card"},km={key:0,class:"card-content"},Mm={class:"stat-row"},Am={class:"stat-value"},Om={class:"stat-row"},Lm={class:"stat-value"},Pm={key:1,class:"text-muted"},Rm={class:"card"},Nm={key:0,class:"card-content"},$m={class:"stat-row"},Dm={class:"stat-value"},Im={class:"stat-row"},Bm={class:"stat-value"},Vm={key:1,class:"text-muted"},Fm={class:"card"},Um={class:"input-with-button"},zm=["disabled"],qm={key:0,class:"form-error"},Wm={key:1,class:"form-success"},Hm={__name:"DashboardPage",setup(s){const t=Gt({user:null,subscription:null}),e=$(null),i=$(""),n=$(""),r=$(""),o=$(!1),l=$(!1),a=bm(),u=ht(()=>{if(!e.value)return 0;const{allowanceCredits:_,remainingCredits:w}=e.value;return!_||_<=0?0:Math.min(100,Math.max(0,w/_*100))});function c(_){if(!_)return"-";try{return new Date(_).toISOString().slice(0,10)}catch{return String(_)}}function d(_){return{monthly:"",quarterly:"",yearly:"",free:""}[_]||_}function f(_){return _==null?"0.00":Number(_).toFixed(2)}async function p({force:_=!1}={}){l.value=!0;try{const w=await a.get({force:_});t.user=w.user,t.subscription=w.subscription}finally{l.value=!1}}async function v(){try{const _=await st.request("/api/saas/ai/state");e.value=_.credit||null}catch{e.value=null}}async function g(){n.value="",r.value="",o.value=!0;try{const _=await st.request("/api/billing/redeem-activation-code",{method:"POST",body:{code:i.value}});a.invalidate(),await p({force:!0}),await v(),t.subscription=_.subscription,r.value="",i.value=""}catch(_){n.value=_?.message||""}finally{o.value=!1}}return ae(()=>{p({force:!1}),v()}),(_,w)=>(C(),Xt(Ln,{title:"",subtitle:""},{default:bt(()=>[h("div",ym,[h("div",_m,[w[2]||(w[2]=h("h2",{class:"card-title"},"",-1)),at(Ct(Dt),{class:"btn btn-primary btn-sm",to:"/app/subscription"},{default:bt(()=>[...w[1]||(w[1]=[kt("",-1)])]),_:1})]),h("div",wm,[h("div",Sm,[w[3]||(w[3]=h("div",{class:"balance-info"},[h("span",{class:"balance-label"},""),h("span",{class:"balance-hint"},"")],-1)),h("span",xm,x(f(e.value?.remainingCredits)),1)]),h("div",Cm,[h("div",{class:"progress-fill",style:Sn({width:u.value+"%"})},null,4)])])]),h("div",Em,[h("div",Tm,[w[6]||(w[6]=h("h2",{class:"card-title"},"",-1)),t.user?(C(),k("div",km,[h("div",Mm,[w[4]||(w[4]=h("span",{class:"stat-label"},"",-1)),h("span",Am,x(t.user.email),1)]),h("div",Om,[w[5]||(w[5]=h("span",{class:"stat-label"},"",-1)),h("span",Lm,x(t.user.display_name||"-"),1)])])):(C(),k("p",Pm,"..."))]),h("div",Rm,[w[9]||(w[9]=h("h2",{class:"card-title"},"",-1)),t.subscription?(C(),k("div",Nm,[h("div",$m,[w[7]||(w[7]=h("span",{class:"stat-label"},"",-1)),h("span",Dm,x(d(t.subscription.plan_code)),1)]),h("div",Im,[w[8]||(w[8]=h("span",{class:"stat-label"},"",-1)),h("span",Bm,x(c(t.subscription.current_period_end)),1)])])):(C(),k("p",Vm,""))])]),h("div",Fm,[w[10]||(w[10]=h("h2",{class:"card-title"},"",-1)),h("form",{class:"card-content",onSubmit:ys(g,["prevent"])},[h("div",Um,[et(h("input",{"onUpdate:modelValue":w[0]||(w[0]=y=>i.value=y),class:"form-input",placeholder:"",required:""},null,512),[[lt,i.value]]),h("button",{class:"btn btn-primary",type:"submit",disabled:o.value},x(o.value?"...":""),9,zm)]),n.value?(C(),k("p",qm,x(n.value),1)):K("",!0),r.value?(C(),k("p",Wm,x(r.value),1)):K("",!0)],32)])]),_:1}))}},Km={key:0,class:"card"},jm={style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"1rem"}},Gm=["disabled"],Jm={class:"card-content"},Xm={class:"stat-row"},Ym={class:"stat-value"},Qm={class:"stat-row"},Zm={class:"stat-value"},tv={class:"stat-row"},ev={class:"stat-value"},sv={class:"card"},iv={class:"card-content"},nv={key:0,class:"form-error"},rv={key:1,class:"form-success"},ov={key:2,class:"pricing-grid"},lv={key:0,class:"pricing-badge"},av={class:"pricing-header"},uv={class:"pricing-name"},hv={class:"pricing-price"},cv={class:"pricing-amount pricing-discount"},dv={class:"text-muted",style:{"margin-left":"0.5rem"}},fv={class:"pricing-original"},pv={class:"pricing-amount"},mv={class:"pricing-period"},vv={class:"text-muted",style:{"margin-top":"0.25rem"}},gv={key:0,class:"upgrade-hint"},bv={key:1,class:"upgrade-hint"},yv={key:2,class:"upgrade-hint"},_v={key:3,class:"upgrade-hint"},wv={class:"pricing-desc"},Sv={class:"pricing-features"},xv=["disabled","onClick"],Cv={key:3,class:"text-muted"},Ev={class:"card"},Tv={class:"input-with-button"},kv=["disabled"],Mv={key:0,class:"form-error"},Av={key:1,class:"form-success"},Ov={__name:"SubscriptionPage",setup(s){const t=$(null),e=$(""),i=$(""),n=$(""),r=$(!1),o=$(null),l=$(""),a=$(""),u=$(!1),c=$({}),d=$(!1),f=$(0),p=sh(),v=ht(()=>String(t.value?.plan_code||"").trim()),g=ht(()=>t.value?.provider==="stripe"),_=ht(()=>{if(!t.value||t.value.status!=="active"||!t.value.current_period_end)return!1;const T=new Date(t.value.current_period_end).getTime();return Number.isFinite(T)&&T>Date.now()}),w=ht(()=>mt());function y(T){if(!T)return"-";try{return new Date(T).toISOString().slice(0,10)}catch{return String(T)}}function M(T){return{monthly:"",quarterly:"",yearly:"",free:""}[T]||T}function D(T){return{active:"",canceled:"",expired:"",trialing:""}[T]||T}function X(T){const E=T?.price||null,F=Number(E?.unitAmount),J=String(E?.interval||"").trim(),m=Number(E?.intervalCount);if(Number.isFinite(F)&&F>=0&&J){const A=F/100;if(J==="month"){const L=Number.isFinite(m)&&m>0?m:1,P=A/L;return{amount:`$${nt(P)}`,period:"/"}}if(J==="year"){const L=A/12;return{amount:`$${nt(L)}`,period:"/"}}return J==="week"?{amount:`$${nt(A)}`,period:"/"}:{amount:`$${nt(A)}`,period:`/${J}`}}const S=Number({monthly:10,quarterly:8,yearly:7,free:0}[T.code])||0;return S<=0?{amount:"",period:""}:{amount:`$${S}`,period:"/"}}function nt(T){const E=Number(T);return Number.isFinite(E)?Math.abs(E-Math.round(E))<1e-9?String(Math.round(E)):E.toFixed(2).replace(/\.?0+$/,""):"0"}function Z(T){const E=Number(T);return Number.isFinite(E)?`$${nt(E)}`:null}function V(T){const E=String(T?.interval||"").trim(),F=Number(T?.intervalCount),J=Number.isFinite(F)&&F>0?F:1;return E==="month"?J:E==="year"?12*J:null}function O(T){const E=Number(T?.unitAmount);return!Number.isFinite(E)||E<0?null:E/100}function B(T){const E=String(T||"").trim();return(o.value?.plans||[]).find(J=>J.code===E)||null}function mt(){if(!g.value)return{};if(!_.value)return{};if(!o.value?.plans?.length)return{};const T=new Date(t.value?.current_period_start||"").getTime(),E=new Date(t.value?.current_period_end||"").getTime();if(!Number.isFinite(T)||!Number.isFinite(E)||E<=T)return{};const F=Date.now(),J=(E-T)/1e3,m=Math.max(0,(E-F)/1e3);if(!Number.isFinite(J)||J<=0)return{};const b=Math.min(1,Math.max(0,m/J)),S=B(v.value),A=O(S?.price);if(!Number.isFinite(A)||A<=0)return{};const L={};for(const P of o.value.plans){if(!W(P.code))continue;const H=O(P?.price),q=V(P?.price);if(!Number.isFinite(H)||H<=0||!Number.isFinite(q)||q<=0)continue;const z=A*b,I=Math.max(0,H-z),Q=I/q;L[P.code]={months:q,perMonthDisplay:Z(Q),payableTotalDisplay:Z(I),originalTotalDisplay:Z(H),remainingValueDisplay:Z(z),remainingPercent:nt(b*100)}}return L}function Tt(T){const E=T?.price||null,F=Number(E?.unitAmount),J=String(E?.currency||"").toUpperCase(),m=String(E?.interval||"").trim(),b=Number(E?.intervalCount);if(Number.isFinite(F)&&F>=0&&m){const S=(F/100).toFixed(2),A=J==="USD"||!J?"US$":`${J} `;if(m==="month"){const L=Number.isFinite(b)&&b>0?b:1;return`${A}${S} / ${L} `}if(m==="year"){const L=Number.isFinite(b)&&b>0?b:1;return L===1?`${A}${S} / `:`${A}${S} / ${L} `}if(m==="week"){const L=Number.isFinite(b)&&b>0?b:1;return L===1?`${A}${S} / `:`${A}${S} / ${L} `}return`${A}${S} / ${m}`}return T.code==="monthly"?"10 USD / 1 ":T.code==="quarterly"?"24 USD / 3 ":T.code==="yearly"?"84 USD / 12 ":""}function At(T){return{monthly:"10 USD/ 300 ",quarterly:"24 USD/ 8 USD/ 400 ",yearly:"84 USD/ 7 USD/ 500 ",free:" 10 "}[T]||" AI "}function Qt(T){return{monthly:[" 300  300  AI ","Sonnet 4.5 / GPT-5.2 / Gemini 3 Pro / Qwen3-VL-Plus / GLM-4.7"," Provider ",""],quarterly:[" 400 ","GPT-5.2 Extra Thinking / o3 / Opus 4.5","","24 USD/"],yearly:[" 500 ","GPT-5.2 Extra Thinking / o3 / Opus 4.5","","84 USD/"],free:[" 10 ","",""]}[T]||[" AI ",""]}const qt={free:0,monthly:1,quarterly:2,yearly:3};function W(T){if(!t.value||!_.value)return!1;const E=qt[v.value]||0;return(qt[String(T||"").trim()]||0)>E}function R(T){return t.value?t.value.plan_code===T&&t.value.status==="active":!1}function G(T,E){return T.available?E?"...":R(T.code)?"":W(T.code)?"":"":""}async function It(){const T=await st.request("/api/billing/subscription");t.value=T.subscription||null}async function Nt(){d.value=!0,l.value="";try{await st.request("/api/stripe/subscriptions/sync",{method:"POST"}),await It(),await Re(),await ye()}catch(T){l.value=T?.message||""}finally{d.value=!1}}function Bt(){return!(d.value||t.value?.provider!=="stripe"||Date.now()-f.value<15e3)}async function Rt(T){if(Bt()){f.value=Date.now();try{await Nt()}catch{}}}async function ye(){if(c.value={},!!g.value&&_.value&&o.value?.plans?.length){for(const T of o.value.plans)if(W(T.code)){c.value[T.code]={loading:!0,error:!1,amountDueDisplay:null};try{const E=await st.request("/api/stripe/subscriptions/upgrade/preview",{method:"POST",body:{targetPlanCode:T.code}});c.value[T.code]={...E,loading:!1,error:!1}}catch{c.value[T.code]={loading:!1,error:!0,amountDueDisplay:null}}}}}async function Re(){l.value="";try{o.value=await st.request("/api/stripe/config")}catch(T){o.value=null,l.value=T?.message||"Stripe "}}async function Ne(T){l.value="",a.value="",u.value=!0;try{const E=await st.request("/api/stripe/checkout/create",{method:"POST",body:{planCode:T}});if(!E?.url)throw new Error("");window.location.assign(E.url)}catch(E){l.value=E?.message||""}finally{u.value=!1}}async function Zt(){const T=String(p.query.stripe||"").trim(),E=String(p.query.session_id||"").trim();if(T==="cancel"){a.value="";return}if(T==="portal_return"){a.value="...",await Nt().catch(()=>null),a.value="";return}if(T==="success"&&E){a.value="...";try{await st.request("/api/stripe/checkout/complete",{method:"POST",body:{sessionId:E}})}catch{}await Nt().catch(()=>null),a.value=""}}async function N(){i.value="",n.value="",r.value=!0;try{const T=await st.request("/api/billing/redeem-activation-code",{method:"POST",body:{code:e.value}});t.value=T.subscription||null,n.value="",e.value=""}catch(T){i.value=T?.message||""}finally{r.value=!1}}return ns([t,o],()=>{ye()}),ae(async()=>{await It(),await Re(),await ye(),await Zt(),await Rt();const T=()=>{Rt()},E=()=>{document.visibilityState==="visible"&&Rt()};window.addEventListener("focus",T),document.addEventListener("visibilitychange",E),Hs(()=>{window.removeEventListener("focus",T),document.removeEventListener("visibilitychange",E)})}),(T,E)=>(C(),Xt(Ln,{title:"",subtitle:""},{default:bt(()=>[t.value?(C(),k("div",Km,[h("div",jm,[E[1]||(E[1]=h("h2",{class:"card-title",style:{margin:"0"}},"",-1)),t.value?.provider==="stripe"?(C(),k("button",{key:0,class:"btn btn-secondary btn-sm",type:"button",disabled:d.value,onClick:Nt},x(d.value?"...":""),9,Gm)):K("",!0)]),h("div",Jm,[h("div",Xm,[E[2]||(E[2]=h("span",{class:"stat-label"},"",-1)),h("span",Ym,x(M(t.value.plan_code)),1)]),h("div",Qm,[E[3]||(E[3]=h("span",{class:"stat-label"},"",-1)),h("span",Zm,x(D(t.value.status)),1)]),h("div",tv,[E[4]||(E[4]=h("span",{class:"stat-label"},"",-1)),h("span",ev,x(y(t.value.current_period_end)),1)])])])):K("",!0),h("div",sv,[E[6]||(E[6]=h("h2",{class:"card-title"},"",-1)),h("div",iv,[l.value?(C(),k("div",nv,x(l.value),1)):K("",!0),a.value?(C(),k("p",rv,x(a.value),1)):K("",!0),o.value?(C(),k("div",ov,[(C(!0),k(pt,null,Jt(o.value.plans,(F,J)=>(C(),k("div",{key:F.code,class:bs(["pricing-card",{featured:J===1}])},[J===1?(C(),k("span",lv,"")):K("",!0),h("div",av,[h("div",uv,x(F.displayName),1),h("div",hv,[w.value[F.code]?(C(),k(pt,{key:0},[h("span",cv,x(w.value[F.code].perMonthDisplay),1),E[5]||(E[5]=h("span",{class:"pricing-period"},"/",-1)),h("span",dv,x(w.value[F.code].payableTotalDisplay)+" / "+x(w.value[F.code].months)+"  ",1),h("span",fv,x(w.value[F.code].originalTotalDisplay),1)],64)):(C(),k(pt,{key:1},[h("span",pv,x(X(F).amount),1),h("span",mv,x(X(F).period),1)],64))]),h("div",vv,x(Tt(F)),1),w.value[F.code]?(C(),k("div",gv," "+x(w.value[F.code].remainingValueDisplay)+" "+x(w.value[F.code].remainingPercent)+"% ",1)):W(F.code)&&_.value&&g.value&&c.value[F.code]?.loading?(C(),k("div",bv," ... ")):W(F.code)&&_.value&&g.value&&c.value[F.code]?.error?(C(),k("div",yv,"  Stripe  ")):W(F.code)&&_.value&&!g.value?(C(),k("div",_v,"  Stripe Stripe  ")):K("",!0)]),h("p",wv,x(At(F.code)),1),h("ul",Sv,[(C(!0),k(pt,null,Jt(Qt(F.code),m=>(C(),k("li",{key:m},x(m),1))),128))]),h("button",{class:bs(["btn",J===1?"btn-primary":"btn-secondary"]),type:"button",disabled:u.value||!F.available||R(F.code),onClick:m=>Ne(F.code)},x(G(F,u.value)),11,xv)],2))),128))])):(C(),k("p",Cv,"..."))])]),h("div",Ev,[E[8]||(E[8]=h("h2",{class:"card-title"},"",-1)),h("form",{class:"card-content",onSubmit:ys(N,["prevent"])},[E[7]||(E[7]=h("p",{class:"text-muted",style:{"margin-bottom":"1rem"}},"",-1)),h("div",Tv,[et(h("input",{"onUpdate:modelValue":E[0]||(E[0]=F=>e.value=F),class:"form-input",placeholder:"",required:""},null,512),[[lt,e.value]]),h("button",{class:"btn btn-primary",type:"submit",disabled:r.value},x(r.value?"...":""),9,kv)]),i.value?(C(),k("p",Mv,x(i.value),1)):K("",!0),n.value?(C(),k("p",Av,x(n.value),1)):K("",!0)],32)])]),_:1}))}};function xt(s){var t=s.width,e=s.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(e<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:e}}function gs(s,t){return s.width===t.width&&s.height===t.height}var Lv=(function(){function s(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return s.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(s.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),s.prototype.subscribe=function(t){var e=this,i={next:t};return this._observers.push(i),{unsubscribe:function(){e._observers=e._observers.filter(function(n){return n!==i})}}},s.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},s.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},s.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},s.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},s})();function Pv(s){return new Lv(s)}var Rv=(function(){function s(t,e,i){var n;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=xt({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=e??(function(r){return r}),this._allowResizeObserver=(n=i?.allowResizeObserver)!==null&&n!==void 0?n:!0,this._chooseAndInitObserver()}return s.prototype.dispose=function(){var t,e;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(e=this._devicePixelRatioObservable)===null||e===void 0||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(s.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"bitmapSize",{get:function(){return xt({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),s.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=xt(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},s.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},s.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(s.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),s.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},s.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},s.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},s.prototype._resizeBitmap=function(t){var e=this.bitmapSize;gs(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},s.prototype._emitBitmapSizeChanged=function(t,e){var i=this;this._bitmapSizeChangedListeners.forEach(function(n){return n.call(i,t,e)})},s.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,i=xt(this._transformBitmapSize(t,this._canvasElementClientSize)),n=gs(this.bitmapSize,i)?null:i;e===null&&n===null||e!==null&&n!==null&&gs(e,n)||(this._suggestedBitmapSize=n,this._emitSuggestedBitmapSizeChanged(e,n))},s.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(n){return n.call(i,t,e)})},s.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}$v().then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()})},s.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var e=Bl(this._canvasElement);if(e===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=Pv(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},s.prototype._invalidateBitmapSize=function(){var t,e;if(this._canvasElement!==null){var i=Bl(this._canvasElement);if(i!==null){var n=(e=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&e!==void 0?e:i.devicePixelRatio,r=this._canvasElement.getClientRects(),o=r[0]!==void 0?Dv(r[0],n):xt({width:this._canvasElementClientSize.width*n,height:this._canvasElementClientSize.height*n});this._suggestNewBitmapSize(o)}}},s.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var i=e.find(function(o){return o.target===t._canvasElement});if(!(!i||!i.devicePixelContentBoxSize||!i.devicePixelContentBoxSize[0])){var n=i.devicePixelContentBoxSize[0],r=xt({width:n.inlineSize,height:n.blockSize});t._suggestNewBitmapSize(r)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},s})();function Nv(s,t){return new Rv(s,t.transform,t.options)}function Bl(s){return s.ownerDocument.defaultView}function $v(){return new Promise(function(s){var t=new ResizeObserver(function(e){s(e.every(function(i){return"devicePixelContentBoxSize"in i})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function Dv(s,t){return xt({width:Math.round(s.left*t+s.width*t)-Math.round(s.left*t),height:Math.round(s.top*t+s.height*t)-Math.round(s.top*t)})}var Iv=(function(){function s(t,e,i){if(e.width===0||e.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,i.width===0||i.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i,this._context=t}return s.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},s.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(s.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),s})();function _s(s,t){var e=s.canvasElementClientSize;if(e.width===0||e.height===0)return null;var i=s.bitmapSize;if(i.width===0||i.height===0)return null;var n=s.canvasElement.getContext("2d",t);return n===null?null:new Iv(n,e,i)}const Bv={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Vv={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},Fv={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Uv={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},zv={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},qv={color:"#26a69a",base:0},ih={color:"#2196f3"},nh={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var Vl,Fl;function ws(s,t){const e={0:[],1:[s.lineWidth,s.lineWidth],2:[2*s.lineWidth,2*s.lineWidth],3:[6*s.lineWidth,6*s.lineWidth],4:[s.lineWidth,4*s.lineWidth]}[t];s.setLineDash(e)}function rh(s,t,e,i){s.beginPath();const n=s.lineWidth%2?.5:0;s.moveTo(e,t+n),s.lineTo(i,t+n),s.stroke()}function ls(s,t){if(!s)throw new Error("Assertion failed"+(t?": "+t:""))}function Yt(s){if(s===void 0)throw new Error("Value is undefined");return s}function U(s){if(s===null)throw new Error("Value is null");return s}function Ms(s){return U(Yt(s))}(function(s){s[s.Simple=0]="Simple",s[s.WithSteps=1]="WithSteps",s[s.Curved=2]="Curved"})(Vl||(Vl={})),(function(s){s[s.Solid=0]="Solid",s[s.Dotted=1]="Dotted",s[s.Dashed=2]="Dashed",s[s.LargeDashed=3]="LargeDashed",s[s.SparseDotted=4]="SparseDotted"})(Fl||(Fl={}));const Ul={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function ue(s){return s<0?0:s>255?255:Math.round(s)||0}function oh(s){return s<=0||s>0?s<0?0:s>1?1:Math.round(1e4*s)/1e4:0}const Wv=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,Hv=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,Kv=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,jv=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function mn(s){(s=s.toLowerCase())in Ul&&(s=Ul[s]);{const t=jv.exec(s)||Kv.exec(s);if(t)return[ue(parseInt(t[1],10)),ue(parseInt(t[2],10)),ue(parseInt(t[3],10)),oh(t.length<5?1:parseFloat(t[4]))]}{const t=Hv.exec(s);if(t)return[ue(parseInt(t[1],16)),ue(parseInt(t[2],16)),ue(parseInt(t[3],16)),1]}{const t=Wv.exec(s);if(t)return[ue(17*parseInt(t[1],16)),ue(17*parseInt(t[2],16)),ue(17*parseInt(t[3],16)),1]}throw new Error(`Cannot parse color: ${s}`)}function Pn(s){const t=mn(s);return{t:`rgb(${t[0]}, ${t[1]}, ${t[2]})`,i:(e=t,.199*e[0]+.687*e[1]+.114*e[2]>160?"black":"white")};var e}class Mt{constructor(){this.h=[]}l(t,e,i){const n={o:t,_:e,u:i===!0};this.h.push(n)}v(t){const e=this.h.findIndex((i=>t===i.o));e>-1&&this.h.splice(e,1)}p(t){this.h=this.h.filter((e=>e._!==t))}m(t,e,i){const n=[...this.h];this.h=this.h.filter((r=>!r.u)),n.forEach((r=>r.o(t,e,i)))}M(){return this.h.length>0}S(){this.h=[]}}function be(s,...t){for(const e of t)for(const i in e)e[i]!==void 0&&(typeof e[i]!="object"||s[i]===void 0||Array.isArray(e[i])?s[i]=e[i]:be(s[i],e[i]));return s}function ke(s){return typeof s=="number"&&isFinite(s)}function wi(s){return typeof s=="number"&&s%1==0}function Li(s){return typeof s=="string"}function Di(s){return typeof s=="boolean"}function Fe(s){const t=s;if(!t||typeof t!="object")return t;let e,i,n;for(i in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(i)&&(n=t[i],e[i]=n&&typeof n=="object"?Fe(n):n);return e}function Gv(s){return s!==null}function Si(s){return s===null?void 0:s}const So="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function zs(s,t,e){return t===void 0&&(t=So),`${e=e!==void 0?`${e} `:""}${s}px ${t}`}class Jv{constructor(t){this.k={C:1,T:5,P:NaN,R:"",D:"",O:"",A:"",V:0,B:0,I:0,L:0,N:0},this.F=t}W(){const t=this.k,e=this.j(),i=this.H();return t.P===e&&t.D===i||(t.P=e,t.D=i,t.R=zs(e,i),t.L=2.5/12*e,t.V=t.L,t.B=e/12*t.T,t.I=e/12*t.T,t.N=0),t.O=this.$(),t.A=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}}class xo{constructor(){this.Y=[]}X(t){this.Y=t}K(t,e,i){this.Y.forEach((n=>{n.K(t,e,i)}))}}class Co{K(t,e,i){t.useMediaCoordinateSpace((n=>this.Z(n,e,i)))}G(t,e,i){t.useMediaCoordinateSpace((n=>this.J(n,e,i)))}J(t,e,i){}}class Xv extends Co{constructor(){super(...arguments),this.tt=null}it(t){this.tt=t}Z({context:t}){if(this.tt===null||this.tt.nt===null)return;const e=this.tt.nt,i=this.tt,n=r=>{t.beginPath();for(let o=e.to-1;o>=e.from;--o){const l=i.st[o];t.moveTo(l.et,l.rt),t.arc(l.et,l.rt,r,0,2*Math.PI)}t.fill()};i.ht>0&&(t.fillStyle=i.lt,n(i.ot+i.ht)),t.fillStyle=i._t,n(i.ot)}}function Yv(){return{st:[{et:0,rt:0,ut:0,ct:0}],_t:"",lt:"",ot:0,ht:0,nt:null}}const Qv={from:0,to:1};class Zv{constructor(t,e){this.dt=new xo,this.ft=[],this.vt=[],this.bt=!0,this.F=t,this.wt=e,this.dt.X(this.ft)}gt(t){const e=this.F.Mt();e.length!==this.ft.length&&(this.vt=e.map(Yv),this.ft=this.vt.map((i=>{const n=new Xv;return n.it(i),n})),this.dt.X(this.ft)),this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.dt}St(){const t=this.wt.W().mode===2,e=this.F.Mt(),i=this.wt.kt(),n=this.F.yt();e.forEach(((r,o)=>{var l;const a=this.vt[o],u=r.Ct(i);if(t||u===null||!r.Tt())return void(a.nt=null);const c=U(r.Pt());a._t=u.Rt,a.ot=u.ot,a.ht=u.Dt,a.st[0].ct=u.ct,a.st[0].rt=r.At().Ot(u.ct,c.Vt),a.lt=(l=u.Bt)!==null&&l!==void 0?l:this.F.It(a.st[0].rt/r.At().zt()),a.st[0].ut=i,a.st[0].et=n.Et(i),a.nt=Qv}))}}class Je{K(t,e,i){t.useBitmapCoordinateSpace((n=>this.Z(n,e,i)))}}class tg extends Je{constructor(t){super(),this.Lt=t}Z({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(this.Lt===null)return;const r=this.Lt.Nt.Tt,o=this.Lt.Ft.Tt;if(!r&&!o)return;const l=Math.round(this.Lt.et*i),a=Math.round(this.Lt.rt*n);t.lineCap="butt",r&&l>=0&&(t.lineWidth=Math.floor(this.Lt.Nt.ht*i),t.strokeStyle=this.Lt.Nt.O,t.fillStyle=this.Lt.Nt.O,ws(t,this.Lt.Nt.Wt),(function(u,c,d,f){u.beginPath();const p=u.lineWidth%2?.5:0;u.moveTo(c+p,d),u.lineTo(c+p,f),u.stroke()})(t,l,0,e.height)),o&&a>=0&&(t.lineWidth=Math.floor(this.Lt.Ft.ht*n),t.strokeStyle=this.Lt.Ft.O,t.fillStyle=this.Lt.Ft.O,ws(t,this.Lt.Ft.Wt),rh(t,a,0,e.width))}}class eg{constructor(t){this.bt=!0,this.jt={Nt:{ht:1,Wt:0,O:"",Tt:!1},Ft:{ht:1,Wt:0,O:"",Tt:!1},et:0,rt:0},this.Ht=new tg(this.jt),this.$t=t}gt(){this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.Ht}St(){const t=this.$t.Tt(),e=U(this.$t.Ut()),i=e.qt().W().crosshair,n=this.jt;if(i.mode===2)return n.Ft.Tt=!1,void(n.Nt.Tt=!1);n.Ft.Tt=t&&this.$t.Yt(e),n.Nt.Tt=t&&this.$t.Xt(),n.Ft.ht=i.horzLine.width,n.Ft.Wt=i.horzLine.style,n.Ft.O=i.horzLine.color,n.Nt.ht=i.vertLine.width,n.Nt.Wt=i.vertLine.style,n.Nt.O=i.vertLine.color,n.et=this.$t.Kt(),n.rt=this.$t.Zt()}}function sg(s,t,e,i,n,r){s.fillRect(t+r,e,i-2*r,r),s.fillRect(t+r,e+n-r,i-2*r,r),s.fillRect(t,e,r,n),s.fillRect(t+i-r,e,r,n)}function Rn(s,t,e,i,n,r){s.save(),s.globalCompositeOperation="copy",s.fillStyle=r,s.fillRect(t,e,i,n),s.restore()}function zl(s,t){return s.map((e=>e===0?e:e+t))}function Zn(s,t,e,i,n,r){s.beginPath(),s.lineTo(t+i-r[1],e),r[1]!==0&&s.arcTo(t+i,e,t+i,e+r[1],r[1]),s.lineTo(t+i,e+n-r[2]),r[2]!==0&&s.arcTo(t+i,e+n,t+i-r[2],e+n,r[2]),s.lineTo(t+r[3],e+n),r[3]!==0&&s.arcTo(t,e+n,t,e+n-r[3],r[3]),s.lineTo(t,e+r[0]),r[0]!==0&&s.arcTo(t,e,t+r[0],e,r[0])}function ql(s,t,e,i,n,r,o=0,l=[0,0,0,0],a=""){if(s.save(),!o||!a||a===r)return Zn(s,t,e,i,n,l),s.fillStyle=r,s.fill(),void s.restore();const u=o/2;r!=="transparent"&&(Zn(s,t+o,e+o,i-2*o,n-2*o,zl(l,-o)),s.fillStyle=r,s.fill()),a!=="transparent"&&(Zn(s,t+u,e+u,i-o,n-o,zl(l,-u)),s.lineWidth=o,s.strokeStyle=a,s.closePath(),s.stroke()),s.restore()}function lh(s,t,e,i,n,r,o){s.save(),s.globalCompositeOperation="copy";const l=s.createLinearGradient(0,0,0,n);l.addColorStop(0,r),l.addColorStop(1,o),s.fillStyle=l,s.fillRect(t,e,i,n),s.restore()}class Wl{constructor(t,e){this.it(t,e)}it(t,e){this.Lt=t,this.Gt=e}zt(t,e){return this.Lt.Tt?t.P+t.L+t.V:0}K(t,e,i,n){if(!this.Lt.Tt||this.Lt.Jt.length===0)return;const r=this.Lt.O,o=this.Gt.t,l=t.useBitmapCoordinateSpace((a=>{const u=a.context;u.font=e.R;const c=this.Qt(a,e,i,n),d=c.ti,f=(p,v)=>{c.ii?ql(u,d.ni,d.si,d.ei,d.ri,p,d.hi,[d.ot,0,0,d.ot],v):ql(u,d.li,d.si,d.ei,d.ri,p,d.hi,[0,d.ot,d.ot,0],v)};return f(o,"transparent"),this.Lt.ai&&(u.fillStyle=r,u.fillRect(d.li,d.oi,d._i-d.li,d.ui)),f("transparent",o),this.Lt.ci&&(u.fillStyle=e.A,u.fillRect(c.ii?d.di-d.hi:0,d.si,d.hi,d.fi-d.si)),c}));t.useMediaCoordinateSpace((({context:a})=>{const u=l.vi;a.font=e.R,a.textAlign=l.ii?"right":"left",a.textBaseline="middle",a.fillStyle=r,a.fillText(this.Lt.Jt,u.pi,(u.si+u.fi)/2+u.mi)}))}Qt(t,e,i,n){var r;const{context:o,bitmapSize:l,mediaSize:a,horizontalPixelRatio:u,verticalPixelRatio:c}=t,d=this.Lt.ai||!this.Lt.bi?e.T:0,f=this.Lt.wi?e.C:0,p=e.L+this.Gt.gi,v=e.V+this.Gt.Mi,g=e.B,_=e.I,w=this.Lt.Jt,y=e.P,M=i.xi(o,w),D=Math.ceil(i.Si(o,w)),X=y+p+v,nt=e.C+g+_+D+d,Z=Math.max(1,Math.floor(c));let V=Math.round(X*c);V%2!=Z%2&&(V+=1);const O=f>0?Math.max(1,Math.floor(f*u)):0,B=Math.round(nt*u),mt=Math.round(d*u),Tt=(r=this.Gt.ki)!==null&&r!==void 0?r:this.Gt.yi,At=Math.round(Tt*c)-Math.floor(.5*c),Qt=Math.floor(At+Z/2-V/2),qt=Qt+V,W=n==="right",R=W?a.width-f:f,G=W?l.width-O:O;let It,Nt,Bt;return W?(It=G-B,Nt=G-mt,Bt=R-d-g-f):(It=G+B,Nt=G+mt,Bt=R+d+g),{ii:W,ti:{si:Qt,oi:At,fi:qt,ei:B,ri:V,ot:2*u,hi:O,ni:It,li:G,_i:Nt,ui:Z,di:l.width},vi:{si:Qt/c,fi:qt/c,pi:Bt,mi:M}}}}class Nn{constructor(t){this.Ci={yi:0,t:"#000",Mi:0,gi:0},this.Ti={Jt:"",Tt:!1,ai:!0,bi:!1,Bt:"",O:"#FFF",ci:!1,wi:!1},this.Pi={Jt:"",Tt:!1,ai:!1,bi:!0,Bt:"",O:"#FFF",ci:!0,wi:!0},this.bt=!0,this.Ri=new(t||Wl)(this.Ti,this.Ci),this.Di=new(t||Wl)(this.Pi,this.Ci)}Jt(){return this.Oi(),this.Ti.Jt}yi(){return this.Oi(),this.Ci.yi}gt(){this.bt=!0}zt(t,e=!1){return Math.max(this.Ri.zt(t,e),this.Di.zt(t,e))}Ai(){return this.Ci.ki||0}Vi(t){this.Ci.ki=t}Bi(){return this.Oi(),this.Ti.Tt||this.Pi.Tt}Ii(){return this.Oi(),this.Ti.Tt}xt(t){return this.Oi(),this.Ti.ai=this.Ti.ai&&t.W().ticksVisible,this.Pi.ai=this.Pi.ai&&t.W().ticksVisible,this.Ri.it(this.Ti,this.Ci),this.Di.it(this.Pi,this.Ci),this.Ri}zi(){return this.Oi(),this.Ri.it(this.Ti,this.Ci),this.Di.it(this.Pi,this.Ci),this.Di}Oi(){this.bt&&(this.Ti.ai=!0,this.Pi.ai=!1,this.Ei(this.Ti,this.Pi,this.Ci))}}class ig extends Nn{constructor(t,e,i){super(),this.$t=t,this.Li=e,this.Ni=i}Ei(t,e,i){if(t.Tt=!1,this.$t.W().mode===2)return;const n=this.$t.W().horzLine;if(!n.labelVisible)return;const r=this.Li.Pt();if(!this.$t.Tt()||this.Li.Fi()||r===null)return;const o=Pn(n.labelBackgroundColor);i.t=o.t,t.O=o.i;const l=2/12*this.Li.P();i.gi=l,i.Mi=l;const a=this.Ni(this.Li);i.yi=a.yi,t.Jt=this.Li.Wi(a.ct,r),t.Tt=!0}}const ng=/[1-9]/g;class ah{constructor(){this.Lt=null}it(t){this.Lt=t}K(t,e){if(this.Lt===null||this.Lt.Tt===!1||this.Lt.Jt.length===0)return;const i=t.useMediaCoordinateSpace((({context:f})=>(f.font=e.R,Math.round(e.ji.Si(f,U(this.Lt).Jt,ng)))));if(i<=0)return;const n=e.Hi,r=i+2*n,o=r/2,l=this.Lt.$i;let a=this.Lt.yi,u=Math.floor(a-o)+.5;u<0?(a+=Math.abs(0-u),u=Math.floor(a-o)+.5):u+r>l&&(a-=Math.abs(l-(u+r)),u=Math.floor(a-o)+.5);const c=u+r,d=Math.ceil(0+e.C+e.T+e.L+e.P+e.V);t.useBitmapCoordinateSpace((({context:f,horizontalPixelRatio:p,verticalPixelRatio:v})=>{const g=U(this.Lt);f.fillStyle=g.t;const _=Math.round(u*p),w=Math.round(0*v),y=Math.round(c*p),M=Math.round(d*v),D=Math.round(2*p);if(f.beginPath(),f.moveTo(_,w),f.lineTo(_,M-D),f.arcTo(_,M,_+D,M,D),f.lineTo(y-D,M),f.arcTo(y,M,y,M-D,D),f.lineTo(y,w),f.fill(),g.ai){const X=Math.round(g.yi*p),nt=w,Z=Math.round((nt+e.T)*v);f.fillStyle=g.O;const V=Math.max(1,Math.floor(p)),O=Math.floor(.5*p);f.fillRect(X-O,nt,V,Z-nt)}})),t.useMediaCoordinateSpace((({context:f})=>{const p=U(this.Lt),v=0+e.C+e.T+e.L+e.P/2;f.font=e.R,f.textAlign="left",f.textBaseline="middle",f.fillStyle=p.O;const g=e.ji.xi(f,"Apr0");f.translate(u+n,v+g),f.fillText(p.Jt,0,0)}))}}class rg{constructor(t,e,i){this.bt=!0,this.Ht=new ah,this.jt={Tt:!1,t:"#4c525e",O:"white",Jt:"",$i:0,yi:NaN,ai:!0},this.wt=t,this.Ui=e,this.Ni=i}gt(){this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.Ht.it(this.jt),this.Ht}St(){const t=this.jt;if(t.Tt=!1,this.wt.W().mode===2)return;const e=this.wt.W().vertLine;if(!e.labelVisible)return;const i=this.Ui.yt();if(i.Fi())return;t.$i=i.$i();const n=this.Ni();if(n===null)return;t.yi=n.yi;const r=i.qi(this.wt.kt());t.Jt=i.Yi(U(r)),t.Tt=!0;const o=Pn(e.labelBackgroundColor);t.t=o.t,t.O=o.i,t.ai=i.W().ticksVisible}}class Eo{constructor(){this.Xi=null,this.Ki=0}Zi(){return this.Ki}Gi(t){this.Ki=t}At(){return this.Xi}Ji(t){this.Xi=t}Qi(t){return[]}tn(){return[]}Tt(){return!0}}var Vr;(function(s){s[s.Normal=0]="Normal",s[s.Magnet=1]="Magnet",s[s.Hidden=2]="Hidden"})(Vr||(Vr={}));class og extends Eo{constructor(t,e){super(),this.nn=null,this.sn=NaN,this.en=0,this.rn=!0,this.hn=new Map,this.ln=!1,this.an=NaN,this.on=NaN,this._n=NaN,this.un=NaN,this.Ui=t,this.cn=e,this.dn=new Zv(t,this),this.fn=((n,r)=>o=>{const l=r(),a=n();if(o===U(this.nn).vn())return{ct:a,yi:l};{const u=U(o.Pt());return{ct:o.pn(l,u),yi:l}}})((()=>this.sn),(()=>this.on));const i=((n,r)=>()=>{const o=this.Ui.yt().mn(n()),l=r();return o&&Number.isFinite(l)?{ut:o,yi:l}:null})((()=>this.en),(()=>this.Kt()));this.bn=new rg(this,t,i),this.wn=new eg(this)}W(){return this.cn}gn(t,e){this._n=t,this.un=e}Mn(){this._n=NaN,this.un=NaN}xn(){return this._n}Sn(){return this.un}kn(t,e,i){this.ln||(this.ln=!0),this.rn=!0,this.yn(t,e,i)}kt(){return this.en}Kt(){return this.an}Zt(){return this.on}Tt(){return this.rn}Cn(){this.rn=!1,this.Tn(),this.sn=NaN,this.an=NaN,this.on=NaN,this.nn=null,this.Mn()}Pn(t){return this.nn!==null?[this.wn,this.dn]:[]}Yt(t){return t===this.nn&&this.cn.horzLine.visible}Xt(){return this.cn.vertLine.visible}Rn(t,e){this.rn&&this.nn===t||this.hn.clear();const i=[];return this.nn===t&&i.push(this.Dn(this.hn,e,this.fn)),i}tn(){return this.rn?[this.bn]:[]}Ut(){return this.nn}On(){this.wn.gt(),this.hn.forEach((t=>t.gt())),this.bn.gt(),this.dn.gt()}An(t){return t&&!t.vn().Fi()?t.vn():null}yn(t,e,i){this.Vn(t,e,i)&&this.On()}Vn(t,e,i){const n=this.an,r=this.on,o=this.sn,l=this.en,a=this.nn,u=this.An(i);this.en=t,this.an=isNaN(t)?NaN:this.Ui.yt().Et(t),this.nn=i;const c=u!==null?u.Pt():null;return u!==null&&c!==null?(this.sn=e,this.on=u.Ot(e,c)):(this.sn=NaN,this.on=NaN),n!==this.an||r!==this.on||l!==this.en||o!==this.sn||a!==this.nn}Tn(){const t=this.Ui.Mt().map((i=>i.In().Bn())).filter(Gv),e=t.length===0?null:Math.max(...t);this.en=e!==null?e:NaN}Dn(t,e,i){let n=t.get(e);return n===void 0&&(n=new ig(this,e,i),t.set(e,n)),n}}function $n(s){return s==="left"||s==="right"}class $t{constructor(t){this.zn=new Map,this.En=[],this.Ln=t}Nn(t,e){const i=(function(n,r){return n===void 0?r:{Fn:Math.max(n.Fn,r.Fn),Wn:n.Wn||r.Wn}})(this.zn.get(t),e);this.zn.set(t,i)}jn(){return this.Ln}Hn(t){const e=this.zn.get(t);return e===void 0?{Fn:this.Ln}:{Fn:Math.max(this.Ln,e.Fn),Wn:e.Wn}}$n(){this.Un(),this.En=[{qn:0}]}Yn(t){this.Un(),this.En=[{qn:1,Vt:t}]}Xn(t){this.Kn(),this.En.push({qn:5,Vt:t})}Un(){this.Kn(),this.En.push({qn:6})}Zn(){this.Un(),this.En=[{qn:4}]}Gn(t){this.Un(),this.En.push({qn:2,Vt:t})}Jn(t){this.Un(),this.En.push({qn:3,Vt:t})}Qn(){return this.En}ts(t){for(const e of t.En)this.ns(e);this.Ln=Math.max(this.Ln,t.Ln),t.zn.forEach(((e,i)=>{this.Nn(i,e)}))}static ss(){return new $t(2)}static es(){return new $t(3)}ns(t){switch(t.qn){case 0:this.$n();break;case 1:this.Yn(t.Vt);break;case 2:this.Gn(t.Vt);break;case 3:this.Jn(t.Vt);break;case 4:this.Zn();break;case 5:this.Xn(t.Vt);break;case 6:this.Kn()}}Kn(){const t=this.En.findIndex((e=>e.qn===5));t!==-1&&this.En.splice(t,1)}}const Hl=".";function Ue(s,t){if(!ke(s))return"n/a";if(!wi(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?s.toString():("0000000000000000"+s.toString()).slice(-t)}class Dn{constructor(t,e){if(e||(e=1),ke(t)&&wi(t)||(t=100),t<0)throw new TypeError("invalid base");this.Li=t,this.rs=e,this.hs()}format(t){const e=t<0?"":"";return t=Math.abs(t),e+this.ls(t)}hs(){if(this.os=0,this.Li>0&&this.rs>0){let t=this.Li;for(;t>1;)t/=10,this.os++}}ls(t){const e=this.Li/this.rs;let i=Math.floor(t),n="";const r=this.os!==void 0?this.os:NaN;if(e>1){let o=+(Math.round(t*e)-i*e).toFixed(this.os);o>=e&&(o-=e,i+=1),n=Hl+Ue(+o.toFixed(this.os)*this.rs,r)}else i=Math.round(i*e)/e,r>0&&(n=Hl+Ue(0,r));return i.toFixed(0)+n}}class uh extends Dn{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class lg{constructor(t){this._s=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.us(t):t<999995?e+this.us(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.us(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.us(t/1e9)+"B")}us(t){let e;const i=Math.pow(10,this._s);return e=(t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this._s).replace(/\.?0+$/,""):String(t),e.replace(/(\.[1-9]*)0+$/,((n,r)=>r))}}function hh(s,t,e,i,n,r,o){if(t.length===0||i.from>=t.length||i.to<=0)return;const{context:l,horizontalPixelRatio:a,verticalPixelRatio:u}=s,c=t[i.from];let d=r(s,c),f=c;if(i.to-i.from<2){const p=n/2;l.beginPath();const v={et:c.et-p,rt:c.rt},g={et:c.et+p,rt:c.rt};l.moveTo(v.et*a,v.rt*u),l.lineTo(g.et*a,g.rt*u),o(s,d,v,g)}else{const p=(g,_)=>{o(s,d,f,_),l.beginPath(),d=g,f=_};let v=f;l.beginPath(),l.moveTo(c.et*a,c.rt*u);for(let g=i.from+1;g<i.to;++g){v=t[g];const _=r(s,v);switch(e){case 0:l.lineTo(v.et*a,v.rt*u);break;case 1:l.lineTo(v.et*a,t[g-1].rt*u),_!==d&&(p(_,v),l.lineTo(v.et*a,t[g-1].rt*u)),l.lineTo(v.et*a,v.rt*u);break;case 2:{const[w,y]=ag(t,g-1,g);l.bezierCurveTo(w.et*a,w.rt*u,y.et*a,y.rt*u,v.et*a,v.rt*u);break}}e!==1&&_!==d&&(p(_,v),l.moveTo(v.et*a,v.rt*u))}(f!==v||f===v&&e===1)&&o(s,d,f,v)}}const Kl=6;function tr(s,t){return{et:s.et-t.et,rt:s.rt-t.rt}}function jl(s,t){return{et:s.et/t,rt:s.rt/t}}function ag(s,t,e){const i=Math.max(0,t-1),n=Math.min(s.length-1,e+1);var r,o;return[(r=s[t],o=jl(tr(s[e],s[i]),Kl),{et:r.et+o.et,rt:r.rt+o.rt}),tr(s[e],jl(tr(s[n],s[t]),Kl))]}function ug(s,t,e,i,n){const{context:r,horizontalPixelRatio:o,verticalPixelRatio:l}=t;r.lineTo(n.et*o,s*l),r.lineTo(i.et*o,s*l),r.closePath(),r.fillStyle=e,r.fill()}class ch extends Je{constructor(){super(...arguments),this.tt=null}it(t){this.tt=t}Z(t){var e;if(this.tt===null)return;const{st:i,nt:n,cs:r,ht:o,Wt:l,ds:a}=this.tt,u=(e=this.tt.fs)!==null&&e!==void 0?e:this.tt.vs?0:t.mediaSize.height;if(n===null)return;const c=t.context;c.lineCap="butt",c.lineJoin="round",c.lineWidth=o,ws(c,l),c.lineWidth=1,hh(t,i,a,n,r,this.ps.bind(this),ug.bind(null,u))}}function Fr(s,t,e){return Math.min(Math.max(s,t),e)}function Ii(s,t,e){return t-s<=e}function dh(s){const t=Math.ceil(s);return t%2==0?t-1:t}class To{bs(t,e){const i=this.ws,{gs:n,Ms:r,xs:o,Ss:l,ks:a,fs:u}=e;if(this.ys===void 0||i===void 0||i.gs!==n||i.Ms!==r||i.xs!==o||i.Ss!==l||i.fs!==u||i.ks!==a){const c=t.context.createLinearGradient(0,0,0,a);if(c.addColorStop(0,n),u!=null){const d=Fr(u*t.verticalPixelRatio/a,0,1);c.addColorStop(d,r),c.addColorStop(d,o)}c.addColorStop(1,l),this.ys=c,this.ws=e}return this.ys}}class hg extends ch{constructor(){super(...arguments),this.Cs=new To}ps(t,e){return this.Cs.bs(t,{gs:e.Ts,Ms:"",xs:"",Ss:e.Ps,ks:t.bitmapSize.height})}}function cg(s,t){const e=s.context;e.strokeStyle=t,e.stroke()}class fh extends Je{constructor(){super(...arguments),this.tt=null}it(t){this.tt=t}Z(t){if(this.tt===null)return;const{st:e,nt:i,cs:n,ds:r,ht:o,Wt:l,Rs:a}=this.tt;if(i===null)return;const u=t.context;u.lineCap="butt",u.lineWidth=o*t.verticalPixelRatio,ws(u,l),u.lineJoin="round";const c=this.Ds.bind(this);r!==void 0&&hh(t,e,r,i,n,c,cg),a&&(function(d,f,p,v,g){const{horizontalPixelRatio:_,verticalPixelRatio:w,context:y}=d;let M=null;const D=Math.max(1,Math.floor(_))%2/2,X=p*w+D;for(let nt=v.to-1;nt>=v.from;--nt){const Z=f[nt];if(Z){const V=g(d,Z);V!==M&&(y.beginPath(),M!==null&&y.fill(),y.fillStyle=V,M=V);const O=Math.round(Z.et*_)+D,B=Z.rt*w;y.moveTo(O,B),y.arc(O,B,X,0,2*Math.PI)}}y.fill()})(t,e,a,i,c)}}class ph extends fh{Ds(t,e){return e._t}}function mh(s,t,e,i,n=0,r=t.length){let o=r-n;for(;0<o;){const l=o>>1,a=n+l;i(t[a],e)===s?(n=a+1,o-=l+1):o=l}return n}const Pi=mh.bind(null,!0),vh=mh.bind(null,!1);function dg(s,t){return s.ut<t}function fg(s,t){return t<s.ut}function gh(s,t,e){const i=t.Os(),n=t.di(),r=Pi(s,i,dg),o=vh(s,n,fg);if(!e)return{from:r,to:o};let l=r,a=o;return r>0&&r<s.length&&s[r].ut>=i&&(l=r-1),o>0&&o<s.length&&s[o-1].ut<=n&&(a=o+1),{from:l,to:a}}class ko{constructor(t,e,i){this.As=!0,this.Vs=!0,this.Bs=!0,this.Is=[],this.zs=null,this.Es=t,this.Ls=e,this.Ns=i}gt(t){this.As=!0,t==="data"&&(this.Vs=!0),t==="options"&&(this.Bs=!0)}xt(){return this.Es.Tt()?(this.Fs(),this.zs===null?null:this.Ws):null}js(){this.Is=this.Is.map((t=>Object.assign(Object.assign({},t),this.Es.$s().Hs(t.ut))))}Us(){this.zs=null}Fs(){this.Vs&&(this.qs(),this.Vs=!1),this.Bs&&(this.js(),this.Bs=!1),this.As&&(this.Ys(),this.As=!1)}Ys(){const t=this.Es.At(),e=this.Ls.yt();if(this.Us(),e.Fi()||t.Fi())return;const i=e.Xs();if(i===null||this.Es.In().Ks()===0)return;const n=this.Es.Pt();n!==null&&(this.zs=gh(this.Is,i,this.Ns),this.Zs(t,e,n.Vt),this.Gs())}}class In extends ko{constructor(t,e){super(t,e,!0)}Zs(t,e,i){e.Js(this.Is,Si(this.zs)),t.Qs(this.Is,i,Si(this.zs))}te(t,e){return{ut:t,ct:e,et:NaN,rt:NaN}}qs(){const t=this.Es.$s();this.Is=this.Es.In().ie().map((e=>{const i=e.Vt[3];return this.ne(e.se,i,t)}))}}class pg extends In{constructor(t,e){super(t,e),this.Ws=new xo,this.ee=new hg,this.re=new ph,this.Ws.X([this.ee,this.re])}ne(t,e,i){return Object.assign(Object.assign({},this.te(t,e)),i.Hs(t))}Gs(){const t=this.Es.W();this.ee.it({ds:t.lineType,st:this.Is,Wt:t.lineStyle,ht:t.lineWidth,fs:null,vs:t.invertFilledArea,nt:this.zs,cs:this.Ls.yt().he()}),this.re.it({ds:t.lineVisible?t.lineType:void 0,st:this.Is,Wt:t.lineStyle,ht:t.lineWidth,nt:this.zs,cs:this.Ls.yt().he(),Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0})}}class mg extends Je{constructor(){super(...arguments),this.Lt=null,this.le=0,this.ae=0}it(t){this.Lt=t}Z({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.Lt===null||this.Lt.In.length===0||this.Lt.nt===null)return;this.le=this.oe(e),this.le>=2&&Math.max(1,Math.floor(e))%2!=this.le%2&&this.le--,this.ae=this.Lt._e?Math.min(this.le,Math.floor(e)):this.le;let n=null;const r=this.ae<=this.le&&this.Lt.he>=Math.floor(1.5*e);for(let o=this.Lt.nt.from;o<this.Lt.nt.to;++o){const l=this.Lt.In[o];n!==l.ue&&(t.fillStyle=l.ue,n=l.ue);const a=Math.floor(.5*this.ae),u=Math.round(l.et*e),c=u-a,d=this.ae,f=c+d-1,p=Math.min(l.ce,l.de),v=Math.max(l.ce,l.de),g=Math.round(p*i)-a,_=Math.round(v*i)+a,w=Math.max(_-g,this.ae);t.fillRect(c,g,d,w);const y=Math.ceil(1.5*this.le);if(r){if(this.Lt.fe){const nt=u-y;let Z=Math.max(g,Math.round(l.ve*i)-a),V=Z+d-1;V>g+w-1&&(V=g+w-1,Z=V-d+1),t.fillRect(nt,Z,c-nt,V-Z+1)}const M=u+y;let D=Math.max(g,Math.round(l.pe*i)-a),X=D+d-1;X>g+w-1&&(X=g+w-1,D=X-d+1),t.fillRect(f+1,D,M-f,X-D+1)}}}oe(t){const e=Math.floor(t);return Math.max(e,Math.floor((function(i,n){return Math.floor(.3*i*n)})(U(this.Lt).he,t)))}}class bh extends ko{constructor(t,e){super(t,e,!1)}Zs(t,e,i){e.Js(this.Is,Si(this.zs)),t.me(this.Is,i,Si(this.zs))}be(t,e,i){return{ut:t,we:e.Vt[0],ge:e.Vt[1],Me:e.Vt[2],xe:e.Vt[3],et:NaN,ve:NaN,ce:NaN,de:NaN,pe:NaN}}qs(){const t=this.Es.$s();this.Is=this.Es.In().ie().map((e=>this.ne(e.se,e,t)))}}class vg extends bh{constructor(){super(...arguments),this.Ws=new mg}ne(t,e,i){return Object.assign(Object.assign({},this.be(t,e,i)),i.Hs(t))}Gs(){const t=this.Es.W();this.Ws.it({In:this.Is,he:this.Ls.yt().he(),fe:t.openVisible,_e:t.thinBars,nt:this.zs})}}class gg extends ch{constructor(){super(...arguments),this.Cs=new To}ps(t,e){const i=this.tt;return this.Cs.bs(t,{gs:e.Se,Ms:e.ke,xs:e.ye,Ss:e.Ce,ks:t.bitmapSize.height,fs:i.fs})}}class bg extends fh{constructor(){super(...arguments),this.Te=new To}Ds(t,e){const i=this.tt;return this.Te.bs(t,{gs:e.Pe,Ms:e.Pe,xs:e.Re,Ss:e.Re,ks:t.bitmapSize.height,fs:i.fs})}}class yg extends In{constructor(t,e){super(t,e),this.Ws=new xo,this.De=new gg,this.Oe=new bg,this.Ws.X([this.De,this.Oe])}ne(t,e,i){return Object.assign(Object.assign({},this.te(t,e)),i.Hs(t))}Gs(){const t=this.Es.Pt();if(t===null)return;const e=this.Es.W(),i=this.Es.At().Ot(e.baseValue.price,t.Vt),n=this.Ls.yt().he();this.De.it({st:this.Is,ht:e.lineWidth,Wt:e.lineStyle,ds:e.lineType,fs:i,vs:!1,nt:this.zs,cs:n}),this.Oe.it({st:this.Is,ht:e.lineWidth,Wt:e.lineStyle,ds:e.lineVisible?e.lineType:void 0,Rs:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0,fs:i,nt:this.zs,cs:n})}}class _g extends Je{constructor(){super(...arguments),this.Lt=null,this.le=0}it(t){this.Lt=t}Z(t){if(this.Lt===null||this.Lt.In.length===0||this.Lt.nt===null)return;const{horizontalPixelRatio:e}=t;this.le=(function(r,o){if(r>=2.5&&r<=4)return Math.floor(3*o);const l=1-.2*Math.atan(Math.max(4,r)-4)/(.5*Math.PI),a=Math.floor(r*l*o),u=Math.floor(r*o),c=Math.min(a,u);return Math.max(Math.floor(o),c)})(this.Lt.he,e),this.le>=2&&Math.floor(e)%2!=this.le%2&&this.le--;const i=this.Lt.In;this.Lt.Ae&&this.Ve(t,i,this.Lt.nt),this.Lt.ci&&this.Be(t,i,this.Lt.nt);const n=this.Ie(e);(!this.Lt.ci||this.le>2*n)&&this.ze(t,i,this.Lt.nt)}Ve(t,e,i){if(this.Lt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="",a=Math.min(Math.floor(r),Math.floor(this.Lt.he*r));a=Math.max(Math.floor(r),Math.min(a,this.le));const u=Math.floor(.5*a);let c=null;for(let d=i.from;d<i.to;d++){const f=e[d];f.Ee!==l&&(n.fillStyle=f.Ee,l=f.Ee);const p=Math.round(Math.min(f.ve,f.pe)*o),v=Math.round(Math.max(f.ve,f.pe)*o),g=Math.round(f.ce*o),_=Math.round(f.de*o);let w=Math.round(r*f.et)-u;const y=w+a-1;c!==null&&(w=Math.max(c+1,w),w=Math.min(w,y));const M=y-w+1;n.fillRect(w,g,M,p-g),n.fillRect(w,v+1,M,_-v),c=y}}Ie(t){let e=Math.floor(1*t);this.le<=2*e&&(e=Math.floor(.5*(this.le-1)));const i=Math.max(Math.floor(t),e);return this.le<=2*i?Math.max(Math.floor(t),Math.floor(1*t)):i}Be(t,e,i){if(this.Lt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="";const a=this.Ie(r);let u=null;for(let c=i.from;c<i.to;c++){const d=e[c];d.Le!==l&&(n.fillStyle=d.Le,l=d.Le);let f=Math.round(d.et*r)-Math.floor(.5*this.le);const p=f+this.le-1,v=Math.round(Math.min(d.ve,d.pe)*o),g=Math.round(Math.max(d.ve,d.pe)*o);if(u!==null&&(f=Math.max(u+1,f),f=Math.min(f,p)),this.Lt.he*r>2*a)sg(n,f,v,p-f+1,g-v+1,a);else{const _=p-f+1;n.fillRect(f,v,_,g-v+1)}u=p}}ze(t,e,i){if(this.Lt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="";const a=this.Ie(r);for(let u=i.from;u<i.to;u++){const c=e[u];let d=Math.round(Math.min(c.ve,c.pe)*o),f=Math.round(Math.max(c.ve,c.pe)*o),p=Math.round(c.et*r)-Math.floor(.5*this.le),v=p+this.le-1;if(c.ue!==l){const g=c.ue;n.fillStyle=g,l=g}this.Lt.ci&&(p+=a,d+=a,v-=a,f-=a),d>f||n.fillRect(p,d,v-p+1,f-d+1)}}}class wg extends bh{constructor(){super(...arguments),this.Ws=new _g}ne(t,e,i){return Object.assign(Object.assign({},this.be(t,e,i)),i.Hs(t))}Gs(){const t=this.Es.W();this.Ws.it({In:this.Is,he:this.Ls.yt().he(),Ae:t.wickVisible,ci:t.borderVisible,nt:this.zs})}}class Sg{constructor(t,e){this.Ne=t,this.Li=e}K(t,e,i){this.Ne.draw(t,this.Li,e,i)}}class er extends ko{constructor(t,e,i){super(t,e,!1),this.wn=i,this.Ws=new Sg(this.wn.renderer(),(n=>{const r=t.Pt();return r===null?null:t.At().Ot(n,r.Vt)}))}Fe(t){return this.wn.priceValueBuilder(t)}We(t){return this.wn.isWhitespace(t)}qs(){const t=this.Es.$s();this.Is=this.Es.In().ie().map((e=>Object.assign(Object.assign({ut:e.se,et:NaN},t.Hs(e.se)),{je:e.He})))}Zs(t,e){e.Js(this.Is,Si(this.zs))}Gs(){this.wn.update({bars:this.Is.map(xg),barSpacing:this.Ls.yt().he(),visibleRange:this.zs},this.Es.W())}}function xg(s){return{x:s.et,time:s.ut,originalData:s.je,barColor:s.ue}}class Cg extends Je{constructor(){super(...arguments),this.Lt=null,this.$e=[]}it(t){this.Lt=t,this.$e=[]}Z({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.Lt===null||this.Lt.st.length===0||this.Lt.nt===null)return;this.$e.length||this.Ue(e);const n=Math.max(1,Math.floor(i)),r=Math.round(this.Lt.qe*i)-Math.floor(n/2),o=r+n;for(let l=this.Lt.nt.from;l<this.Lt.nt.to;l++){const a=this.Lt.st[l],u=this.$e[l-this.Lt.nt.from],c=Math.round(a.rt*i);let d,f;t.fillStyle=a.ue,c<=r?(d=c,f=o):(d=r,f=c-Math.floor(n/2)+n),t.fillRect(u.Os,d,u.di-u.Os+1,f-d)}}Ue(t){if(this.Lt===null||this.Lt.st.length===0||this.Lt.nt===null)return void(this.$e=[]);const e=Math.ceil(this.Lt.he*t)<=1?0:Math.max(1,Math.floor(t)),i=Math.round(this.Lt.he*t)-e;this.$e=new Array(this.Lt.nt.to-this.Lt.nt.from);for(let r=this.Lt.nt.from;r<this.Lt.nt.to;r++){const o=this.Lt.st[r],l=Math.round(o.et*t);let a,u;if(i%2){const c=(i-1)/2;a=l-c,u=l+c}else{const c=i/2;a=l-c,u=l+c-1}this.$e[r-this.Lt.nt.from]={Os:a,di:u,Ye:l,Xe:o.et*t,ut:o.ut}}for(let r=this.Lt.nt.from+1;r<this.Lt.nt.to;r++){const o=this.$e[r-this.Lt.nt.from],l=this.$e[r-this.Lt.nt.from-1];o.ut===l.ut+1&&o.Os-l.di!==e+1&&(l.Ye>l.Xe?l.di=o.Os-e-1:o.Os=l.di+e+1)}let n=Math.ceil(this.Lt.he*t);for(let r=this.Lt.nt.from;r<this.Lt.nt.to;r++){const o=this.$e[r-this.Lt.nt.from];o.di<o.Os&&(o.di=o.Os);const l=o.di-o.Os+1;n=Math.min(l,n)}if(e>0&&n<4)for(let r=this.Lt.nt.from;r<this.Lt.nt.to;r++){const o=this.$e[r-this.Lt.nt.from];o.di-o.Os+1>n&&(o.Ye>o.Xe?o.di-=1:o.Os+=1)}}}class Eg extends In{constructor(){super(...arguments),this.Ws=new Cg}ne(t,e,i){return Object.assign(Object.assign({},this.te(t,e)),i.Hs(t))}Gs(){const t={st:this.Is,he:this.Ls.yt().he(),nt:this.zs,qe:this.Es.At().Ot(this.Es.W().base,U(this.Es.Pt()).Vt)};this.Ws.it(t)}}class Tg extends In{constructor(){super(...arguments),this.Ws=new ph}ne(t,e,i){return Object.assign(Object.assign({},this.te(t,e)),i.Hs(t))}Gs(){const t=this.Es.W(),e={st:this.Is,Wt:t.lineStyle,ds:t.lineVisible?t.lineType:void 0,ht:t.lineWidth,Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,nt:this.zs,cs:this.Ls.yt().he()};this.Ws.it(e)}}const kg=/[2-9]/g;class xi{constructor(t=50){this.Ke=0,this.Ze=1,this.Ge=1,this.Je={},this.Qe=new Map,this.tr=t}ir(){this.Ke=0,this.Qe.clear(),this.Ze=1,this.Ge=1,this.Je={}}Si(t,e,i){return this.nr(t,e,i).width}xi(t,e,i){const n=this.nr(t,e,i);return((n.actualBoundingBoxAscent||0)-(n.actualBoundingBoxDescent||0))/2}nr(t,e,i){const n=i||kg,r=String(e).replace(n,"0");if(this.Qe.has(r))return Yt(this.Qe.get(r)).sr;if(this.Ke===this.tr){const l=this.Je[this.Ge];delete this.Je[this.Ge],this.Qe.delete(l),this.Ge++,this.Ke--}t.save(),t.textBaseline="middle";const o=t.measureText(r);return t.restore(),o.width===0&&e.length||(this.Qe.set(r,{sr:o,er:this.Ze}),this.Je[this.Ze]=r,this.Ke++,this.Ze++),o}}class Mg{constructor(t){this.rr=null,this.k=null,this.hr="right",this.lr=t}ar(t,e,i){this.rr=t,this.k=e,this.hr=i}K(t){this.k!==null&&this.rr!==null&&this.rr.K(t,this.k,this.lr,this.hr)}}class yh{constructor(t,e,i){this._r=t,this.lr=new xi(50),this.ur=e,this.F=i,this.j=-1,this.Ht=new Mg(this.lr)}xt(){const t=this.F.cr(this.ur);if(t===null)return null;const e=t.dr(this.ur)?t.vr():this.ur.At();if(e===null)return null;const i=t.pr(e);if(i==="overlay")return null;const n=this.F.mr();return n.P!==this.j&&(this.j=n.P,this.lr.ir()),this.Ht.ar(this._r.zi(),n,i),this.Ht}}class Ag extends Je{constructor(){super(...arguments),this.Lt=null}it(t){this.Lt=t}br(t,e){var i;if(!(!((i=this.Lt)===null||i===void 0)&&i.Tt))return null;const{rt:n,ht:r,wr:o}=this.Lt;return e>=n-r-7&&e<=n+r+7?{gr:this.Lt,wr:o}:null}Z({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(this.Lt===null||this.Lt.Tt===!1)return;const r=Math.round(this.Lt.rt*n);r<0||r>e.height||(t.lineCap="butt",t.strokeStyle=this.Lt.O,t.lineWidth=Math.floor(this.Lt.ht*i),ws(t,this.Lt.Wt),rh(t,r,0,e.width))}}class Mo{constructor(t){this.Mr={rt:0,O:"rgba(0, 0, 0, 0)",ht:1,Wt:0,Tt:!1},this.Sr=new Ag,this.bt=!0,this.Es=t,this.Ls=t.qt(),this.Sr.it(this.Mr)}gt(){this.bt=!0}xt(){return this.Es.Tt()?(this.bt&&(this.kr(),this.bt=!1),this.Sr):null}}class Og extends Mo{constructor(t){super(t)}kr(){this.Mr.Tt=!1;const t=this.Es.At(),e=t.yr().yr;if(e!==2&&e!==3)return;const i=this.Es.W();if(!i.baseLineVisible||!this.Es.Tt())return;const n=this.Es.Pt();n!==null&&(this.Mr.Tt=!0,this.Mr.rt=t.Ot(n.Vt,n.Vt),this.Mr.O=i.baseLineColor,this.Mr.ht=i.baseLineWidth,this.Mr.Wt=i.baseLineStyle)}}class Lg extends Je{constructor(){super(...arguments),this.Lt=null}it(t){this.Lt=t}He(){return this.Lt}Z({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){const n=this.Lt;if(n===null)return;const r=Math.max(1,Math.floor(e)),o=r%2/2,l=Math.round(n.Xe.x*e)+o,a=n.Xe.y*i;t.fillStyle=n.Cr,t.beginPath();const u=Math.max(2,1.5*n.Tr)*e;t.arc(l,a,u,0,2*Math.PI,!1),t.fill(),t.fillStyle=n.Pr,t.beginPath(),t.arc(l,a,n.ot*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=n.Rr,t.beginPath(),t.arc(l,a,n.ot*e+r/2,0,2*Math.PI,!1),t.stroke()}}const Pg=[{Dr:0,Or:.25,Ar:4,Vr:10,Br:.25,Ir:0,zr:.4,Er:.8},{Dr:.25,Or:.525,Ar:10,Vr:14,Br:0,Ir:0,zr:.8,Er:0},{Dr:.525,Or:1,Ar:14,Vr:14,Br:0,Ir:0,zr:0,Er:0}];function Gl(s,t,e,i){return(function(n,r){if(n==="transparent")return n;const o=mn(n),l=o[3];return`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${r*l})`})(s,e+(i-e)*t)}function Jl(s,t){const e=s%2600/2600;let i;for(const a of Pg)if(e>=a.Dr&&e<=a.Or){i=a;break}ls(i!==void 0,"Last price animation internal logic error");const n=(e-i.Dr)/(i.Or-i.Dr);return{Pr:Gl(t,n,i.Br,i.Ir),Rr:Gl(t,n,i.zr,i.Er),ot:(r=n,o=i.Ar,l=i.Vr,o+(l-o)*r)};var r,o,l}class Rg{constructor(t){this.Ht=new Lg,this.bt=!0,this.Lr=!0,this.Nr=performance.now(),this.Fr=this.Nr-1,this.Wr=t}jr(){this.Fr=this.Nr-1,this.gt()}Hr(){if(this.gt(),this.Wr.W().lastPriceAnimation===2){const t=performance.now(),e=this.Fr-t;if(e>0)return void(e<650&&(this.Fr+=2600));this.Nr=t,this.Fr=t+2600}}gt(){this.bt=!0}$r(){this.Lr=!0}Tt(){return this.Wr.W().lastPriceAnimation!==0}Ur(){switch(this.Wr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Fr}}xt(){return this.bt?(this.St(),this.bt=!1,this.Lr=!1):this.Lr&&(this.qr(),this.Lr=!1),this.Ht}St(){this.Ht.it(null);const t=this.Wr.qt().yt(),e=t.Xs(),i=this.Wr.Pt();if(e===null||i===null)return;const n=this.Wr.Yr(!0);if(n.Xr||!e.Kr(n.se))return;const r={x:t.Et(n.se),y:this.Wr.At().Ot(n.ct,i.Vt)},o=n.O,l=this.Wr.W().lineWidth,a=Jl(this.Zr(),o);this.Ht.it({Cr:o,Tr:l,Pr:a.Pr,Rr:a.Rr,ot:a.ot,Xe:r})}qr(){const t=this.Ht.He();if(t!==null){const e=Jl(this.Zr(),t.Cr);t.Pr=e.Pr,t.Rr=e.Rr,t.ot=e.ot}}Zr(){return this.Ur()?performance.now()-this.Nr:2599}}function ui(s,t){return dh(Math.min(Math.max(s,12),30)*t)}function Ci(s,t){switch(s){case"arrowDown":case"arrowUp":return ui(t,1);case"circle":return ui(t,.8);case"square":return ui(t,.7)}}function _h(s){return(function(t){const e=Math.ceil(t);return e%2!=0?e-1:e})(ui(s,1))}function Xl(s){return Math.max(ui(s,.1),3)}function wh(s,t,e,i,n){const r=Ci("square",e),o=(r-1)/2,l=s-o,a=t-o;return i>=l&&i<=l+r&&n>=a&&n<=a+r}function Yl(s,t,e,i,n){const r=(Ci("arrowUp",n)-1)/2,o=(dh(n/2)-1)/2;t.beginPath(),s?(t.moveTo(e-r,i),t.lineTo(e,i-r),t.lineTo(e+r,i),t.lineTo(e+o,i),t.lineTo(e+o,i+r),t.lineTo(e-o,i+r),t.lineTo(e-o,i)):(t.moveTo(e-r,i),t.lineTo(e,i+r),t.lineTo(e+r,i),t.lineTo(e+o,i),t.lineTo(e+o,i-r),t.lineTo(e-o,i-r),t.lineTo(e-o,i)),t.fill()}function Ng(s,t,e,i,n,r){return wh(t,e,i,n,r)}class $g extends Co{constructor(){super(...arguments),this.Lt=null,this.lr=new xi,this.j=-1,this.H="",this.Gr=""}it(t){this.Lt=t}ar(t,e){this.j===t&&this.H===e||(this.j=t,this.H=e,this.Gr=zs(t,e),this.lr.ir())}br(t,e){if(this.Lt===null||this.Lt.nt===null)return null;for(let i=this.Lt.nt.from;i<this.Lt.nt.to;i++){const n=this.Lt.st[i];if(Ig(n,t,e))return{gr:n.Jr,wr:n.wr}}return null}Z({context:t},e,i){if(this.Lt!==null&&this.Lt.nt!==null){t.textBaseline="middle",t.font=this.Gr;for(let n=this.Lt.nt.from;n<this.Lt.nt.to;n++){const r=this.Lt.st[n];r.Jt!==void 0&&(r.Jt.$i=this.lr.Si(t,r.Jt.Qr),r.Jt.zt=this.j,r.Jt.et=r.et-r.Jt.$i/2),Dg(r,t)}}}}function Dg(s,t){t.fillStyle=s.O,s.Jt!==void 0&&(function(e,i,n,r){e.fillText(i,n,r)})(t,s.Jt.Qr,s.Jt.et,s.Jt.rt),(function(e,i){if(e.Ks!==0){switch(e.th){case"arrowDown":return void Yl(!1,i,e.et,e.rt,e.Ks);case"arrowUp":return void Yl(!0,i,e.et,e.rt,e.Ks);case"circle":return void(function(n,r,o,l){const a=(Ci("circle",l)-1)/2;n.beginPath(),n.arc(r,o,a,0,2*Math.PI,!1),n.fill()})(i,e.et,e.rt,e.Ks);case"square":return void(function(n,r,o,l){const a=Ci("square",l),u=(a-1)/2,c=r-u,d=o-u;n.fillRect(c,d,a,a)})(i,e.et,e.rt,e.Ks)}e.th}})(s,t)}function Ig(s,t,e){return!(s.Jt===void 0||!(function(i,n,r,o,l,a){const u=o/2;return l>=i&&l<=i+r&&a>=n-u&&a<=n+u})(s.Jt.et,s.Jt.rt,s.Jt.$i,s.Jt.zt,t,e))||(function(i,n,r){if(i.Ks===0)return!1;switch(i.th){case"arrowDown":case"arrowUp":return Ng(0,i.et,i.rt,i.Ks,n,r);case"circle":return(function(o,l,a,u,c){const d=2+Ci("circle",a)/2,f=o-u,p=l-c;return Math.sqrt(f*f+p*p)<=d})(i.et,i.rt,i.Ks,n,r);case"square":return wh(i.et,i.rt,i.Ks,n,r)}})(s,t,e)}function Bg(s,t,e,i,n,r,o,l,a){const u=ke(e)?e:e.xe,c=ke(e)?e:e.ge,d=ke(e)?e:e.Me,f=ke(t.size)?Math.max(t.size,0):1,p=_h(l.he())*f,v=p/2;switch(s.Ks=p,t.position){case"inBar":return s.rt=o.Ot(u,a),void(s.Jt!==void 0&&(s.Jt.rt=s.rt+v+r+.6*n));case"aboveBar":return s.rt=o.Ot(c,a)-v-i.ih,s.Jt!==void 0&&(s.Jt.rt=s.rt-v-.6*n,i.ih+=1.2*n),void(i.ih+=p+r);case"belowBar":return s.rt=o.Ot(d,a)+v+i.nh,s.Jt!==void 0&&(s.Jt.rt=s.rt+v+r+.6*n,i.nh+=1.2*n),void(i.nh+=p+r)}t.position}class Vg{constructor(t,e){this.bt=!0,this.sh=!0,this.eh=!0,this.rh=null,this.Ht=new $g,this.Wr=t,this.Ui=e,this.Lt={st:[],nt:null}}gt(t){this.bt=!0,this.eh=!0,t==="data"&&(this.sh=!0)}xt(t){if(!this.Wr.Tt())return null;this.bt&&this.hh();const e=this.Ui.W().layout;return this.Ht.ar(e.fontSize,e.fontFamily),this.Ht.it(this.Lt),this.Ht}lh(){if(this.eh){if(this.Wr.ah().length>0){const t=this.Ui.yt().he(),e=Xl(t),i=1.5*_h(t)+2*e;this.rh={above:i,below:i}}else this.rh=null;this.eh=!1}return this.rh}hh(){const t=this.Wr.At(),e=this.Ui.yt(),i=this.Wr.ah();this.sh&&(this.Lt.st=i.map((c=>({ut:c.time,et:0,rt:0,Ks:0,th:c.shape,O:c.color,Jr:c.Jr,wr:c.id,Jt:void 0}))),this.sh=!1);const n=this.Ui.W().layout;this.Lt.nt=null;const r=e.Xs();if(r===null)return;const o=this.Wr.Pt();if(o===null||this.Lt.st.length===0)return;let l=NaN;const a=Xl(e.he()),u={ih:a,nh:a};this.Lt.nt=gh(this.Lt.st,r,!0);for(let c=this.Lt.nt.from;c<this.Lt.nt.to;c++){const d=i[c];d.time!==l&&(u.ih=a,u.nh=a,l=d.time);const f=this.Lt.st[c];f.et=e.Et(d.time),d.text!==void 0&&d.text.length>0&&(f.Jt={Qr:d.text,et:0,rt:0,$i:0,zt:0});const p=this.Wr.oh(d.time);p!==null&&Bg(f,d,p,u,n.fontSize,a,t,e,o.Vt)}this.bt=!1}}class Fg extends Mo{constructor(t){super(t)}kr(){const t=this.Mr;t.Tt=!1;const e=this.Es.W();if(!e.priceLineVisible||!this.Es.Tt())return;const i=this.Es.Yr(e.priceLineSource===0);i.Xr||(t.Tt=!0,t.rt=i.yi,t.O=this.Es._h(i.O),t.ht=e.priceLineWidth,t.Wt=e.priceLineStyle)}}class Ug extends Nn{constructor(t){super(),this.$t=t}Ei(t,e,i){t.Tt=!1,e.Tt=!1;const n=this.$t;if(!n.Tt())return;const r=n.W(),o=r.lastValueVisible,l=n.uh()!=="",a=r.seriesLastValueMode===0,u=n.Yr(!1);if(u.Xr)return;o&&(t.Jt=this.dh(u,o,a),t.Tt=t.Jt.length!==0),(l||a)&&(e.Jt=this.fh(u,o,l,a),e.Tt=e.Jt.length>0);const c=n._h(u.O),d=Pn(c);i.t=d.t,i.yi=u.yi,e.Bt=n.qt().It(u.yi/n.At().zt()),t.Bt=c,t.O=d.i,e.O=d.i}fh(t,e,i,n){let r="";const o=this.$t.uh();return i&&o.length!==0&&(r+=`${o} `),e&&n&&(r+=this.$t.At().ph()?t.mh:t.bh),r.trim()}dh(t,e,i){return e?i?this.$t.At().ph()?t.bh:t.mh:t.Jt:""}}function Ql(s,t,e,i){const n=Number.isFinite(t),r=Number.isFinite(e);return n&&r?s(t,e):n||r?n?t:e:i}class ne{constructor(t,e){this.wh=t,this.gh=e}Mh(t){return t!==null&&this.wh===t.wh&&this.gh===t.gh}xh(){return new ne(this.wh,this.gh)}Sh(){return this.wh}kh(){return this.gh}yh(){return this.gh-this.wh}Fi(){return this.gh===this.wh||Number.isNaN(this.gh)||Number.isNaN(this.wh)}ts(t){return t===null?this:new ne(Ql(Math.min,this.Sh(),t.Sh(),-1/0),Ql(Math.max,this.kh(),t.kh(),1/0))}Ch(t){if(!ke(t)||this.gh-this.wh===0)return;const e=.5*(this.gh+this.wh);let i=this.gh-e,n=this.wh-e;i*=t,n*=t,this.gh=e+i,this.wh=e+n}Th(t){ke(t)&&(this.gh+=t,this.wh+=t)}Ph(){return{minValue:this.wh,maxValue:this.gh}}static Rh(t){return t===null?null:new ne(t.minValue,t.maxValue)}}class vn{constructor(t,e){this.Dh=t,this.Oh=e||null}Ah(){return this.Dh}Vh(){return this.Oh}Ph(){return this.Dh===null?null:{priceRange:this.Dh.Ph(),margins:this.Oh||void 0}}static Rh(t){return t===null?null:new vn(ne.Rh(t.priceRange),t.margins)}}class zg extends Mo{constructor(t,e){super(t),this.Bh=e}kr(){const t=this.Mr;t.Tt=!1;const e=this.Bh.W();if(!this.Es.Tt()||!e.lineVisible)return;const i=this.Bh.Ih();i!==null&&(t.Tt=!0,t.rt=i,t.O=e.color,t.ht=e.lineWidth,t.Wt=e.lineStyle,t.wr=this.Bh.W().id)}}class qg extends Nn{constructor(t,e){super(),this.Wr=t,this.Bh=e}Ei(t,e,i){t.Tt=!1,e.Tt=!1;const n=this.Bh.W(),r=n.axisLabelVisible,o=n.title!=="",l=this.Wr;if(!r||!l.Tt())return;const a=this.Bh.Ih();if(a===null)return;o&&(e.Jt=n.title,e.Tt=!0),e.Bt=l.qt().It(a/l.At().zt()),t.Jt=this.zh(n.price),t.Tt=!0;const u=Pn(n.axisLabelColor||n.color);i.t=u.t;const c=n.axisLabelTextColor||u.i;t.O=c,e.O=c,i.yi=a}zh(t){const e=this.Wr.Pt();return e===null?"":this.Wr.At().Wi(t,e.Vt)}}class Wg{constructor(t,e){this.Wr=t,this.cn=e,this.Eh=new zg(t,this),this._r=new qg(t,this),this.Lh=new yh(this._r,t,t.qt())}Nh(t){be(this.cn,t),this.gt(),this.Wr.qt().Fh()}W(){return this.cn}Wh(){return this.Eh}jh(){return this.Lh}Hh(){return this._r}gt(){this.Eh.gt(),this._r.gt()}Ih(){const t=this.Wr,e=t.At();if(t.qt().yt().Fi()||e.Fi())return null;const i=t.Pt();return i===null?null:e.Ot(this.cn.price,i.Vt)}}class Hg extends Eo{constructor(t){super(),this.Ui=t}qt(){return this.Ui}}const Kg={Bar:(s,t,e,i)=>{var n;const r=t.upColor,o=t.downColor,l=U(s(e,i)),a=Ms(l.Vt[0])<=Ms(l.Vt[3]);return{ue:(n=l.O)!==null&&n!==void 0?n:a?r:o}},Candlestick:(s,t,e,i)=>{var n,r,o;const l=t.upColor,a=t.downColor,u=t.borderUpColor,c=t.borderDownColor,d=t.wickUpColor,f=t.wickDownColor,p=U(s(e,i)),v=Ms(p.Vt[0])<=Ms(p.Vt[3]);return{ue:(n=p.O)!==null&&n!==void 0?n:v?l:a,Le:(r=p.Bt)!==null&&r!==void 0?r:v?u:c,Ee:(o=p.$h)!==null&&o!==void 0?o:v?d:f}},Custom:(s,t,e,i)=>{var n;return{ue:(n=U(s(e,i)).O)!==null&&n!==void 0?n:t.color}},Area:(s,t,e,i)=>{var n,r,o,l;const a=U(s(e,i));return{ue:(n=a._t)!==null&&n!==void 0?n:t.lineColor,_t:(r=a._t)!==null&&r!==void 0?r:t.lineColor,Ts:(o=a.Ts)!==null&&o!==void 0?o:t.topColor,Ps:(l=a.Ps)!==null&&l!==void 0?l:t.bottomColor}},Baseline:(s,t,e,i)=>{var n,r,o,l,a,u;const c=U(s(e,i));return{ue:c.Vt[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,Pe:(n=c.Pe)!==null&&n!==void 0?n:t.topLineColor,Re:(r=c.Re)!==null&&r!==void 0?r:t.bottomLineColor,Se:(o=c.Se)!==null&&o!==void 0?o:t.topFillColor1,ke:(l=c.ke)!==null&&l!==void 0?l:t.topFillColor2,ye:(a=c.ye)!==null&&a!==void 0?a:t.bottomFillColor1,Ce:(u=c.Ce)!==null&&u!==void 0?u:t.bottomFillColor2}},Line:(s,t,e,i)=>{var n,r;const o=U(s(e,i));return{ue:(n=o.O)!==null&&n!==void 0?n:t.color,_t:(r=o.O)!==null&&r!==void 0?r:t.color}},Histogram:(s,t,e,i)=>{var n;return{ue:(n=U(s(e,i)).O)!==null&&n!==void 0?n:t.color}}};class jg{constructor(t){this.Uh=(e,i)=>i!==void 0?i.Vt:this.Wr.In().qh(e),this.Wr=t,this.Yh=Kg[t.Xh()]}Hs(t,e){return this.Yh(this.Uh,this.Wr.W(),t,e)}}var Zl;(function(s){s[s.NearestLeft=-1]="NearestLeft",s[s.None=0]="None",s[s.NearestRight=1]="NearestRight"})(Zl||(Zl={}));const Ye=30;class Gg{constructor(){this.Kh=[],this.Zh=new Map,this.Gh=new Map}Jh(){return this.Ks()>0?this.Kh[this.Kh.length-1]:null}Qh(){return this.Ks()>0?this.tl(0):null}Bn(){return this.Ks()>0?this.tl(this.Kh.length-1):null}Ks(){return this.Kh.length}Fi(){return this.Ks()===0}Kr(t){return this.il(t,0)!==null}qh(t){return this.nl(t)}nl(t,e=0){const i=this.il(t,e);return i===null?null:Object.assign(Object.assign({},this.sl(i)),{se:this.tl(i)})}ie(){return this.Kh}el(t,e,i){if(this.Fi())return null;let n=null;for(const r of i)n=Bi(n,this.rl(t,e,r));return n}it(t){this.Gh.clear(),this.Zh.clear(),this.Kh=t}tl(t){return this.Kh[t].se}sl(t){return this.Kh[t]}il(t,e){const i=this.hl(t);if(i===null&&e!==0)switch(e){case-1:return this.ll(t);case 1:return this.al(t);default:throw new TypeError("Unknown search mode")}return i}ll(t){let e=this.ol(t);return e>0&&(e-=1),e!==this.Kh.length&&this.tl(e)<t?e:null}al(t){const e=this._l(t);return e!==this.Kh.length&&t<this.tl(e)?e:null}hl(t){const e=this.ol(t);return e===this.Kh.length||t<this.Kh[e].se?null:e}ol(t){return Pi(this.Kh,t,((e,i)=>e.se<i))}_l(t){return vh(this.Kh,t,((e,i)=>e.se>i))}ul(t,e,i){let n=null;for(let r=t;r<e;r++){const o=this.Kh[r].Vt[i];Number.isNaN(o)||(n===null?n={cl:o,dl:o}:(o<n.cl&&(n.cl=o),o>n.dl&&(n.dl=o)))}return n}rl(t,e,i){if(this.Fi())return null;let n=null;const r=U(this.Qh()),o=U(this.Bn()),l=Math.max(t,r),a=Math.min(e,o),u=Math.ceil(l/Ye)*Ye,c=Math.max(u,Math.floor(a/Ye)*Ye);{const f=this.ol(l),p=this._l(Math.min(a,u,e));n=Bi(n,this.ul(f,p,i))}let d=this.Zh.get(i);d===void 0&&(d=new Map,this.Zh.set(i,d));for(let f=Math.max(u+1,l);f<c;f+=Ye){const p=Math.floor(f/Ye);let v=d.get(p);if(v===void 0){const g=this.ol(p*Ye),_=this._l((p+1)*Ye-1);v=this.ul(g,_,i),d.set(p,v)}n=Bi(n,v)}{const f=this.ol(c),p=this._l(a);n=Bi(n,this.ul(f,p,i))}return n}}function Bi(s,t){return s===null?t:t===null?s:{cl:Math.min(s.cl,t.cl),dl:Math.max(s.dl,t.dl)}}class Jg{constructor(t){this.fl=t}K(t,e,i){this.fl.draw(t)}G(t,e,i){var n,r;(r=(n=this.fl).drawBackground)===null||r===void 0||r.call(n,t)}}class sr{constructor(t){this.Qe=null,this.wn=t}xt(){var t;const e=this.wn.renderer();if(e===null)return null;if(((t=this.Qe)===null||t===void 0?void 0:t.vl)===e)return this.Qe.pl;const i=new Jg(e);return this.Qe={vl:e,pl:i},i}ml(){var t,e,i;return(i=(e=(t=this.wn).zOrder)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:"normal"}}function Sh(s){var t,e,i,n,r;return{Jt:s.text(),yi:s.coordinate(),ki:(t=s.fixedCoordinate)===null||t===void 0?void 0:t.call(s),O:s.textColor(),t:s.backColor(),Tt:(i=(e=s.visible)===null||e===void 0?void 0:e.call(s))===null||i===void 0||i,ai:(r=(n=s.tickVisible)===null||n===void 0?void 0:n.call(s))===null||r===void 0||r}}class Xg{constructor(t,e){this.Ht=new ah,this.bl=t,this.wl=e}xt(){return this.Ht.it(Object.assign({$i:this.wl.$i()},Sh(this.bl))),this.Ht}}class Yg extends Nn{constructor(t,e){super(),this.bl=t,this.Li=e}Ei(t,e,i){const n=Sh(this.bl);i.t=n.t,t.O=n.O;const r=2/12*this.Li.P();i.gi=r,i.Mi=r,i.yi=n.yi,i.ki=n.ki,t.Jt=n.Jt,t.Tt=n.Tt,t.ai=n.ai}}class Qg{constructor(t,e){this.gl=null,this.Ml=null,this.xl=null,this.Sl=null,this.kl=null,this.yl=t,this.Wr=e}Cl(){return this.yl}On(){var t,e;(e=(t=this.yl).updateAllViews)===null||e===void 0||e.call(t)}Pn(){var t,e,i,n;const r=(i=(e=(t=this.yl).paneViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((n=this.gl)===null||n===void 0?void 0:n.vl)===r)return this.gl.pl;const o=r.map((l=>new sr(l)));return this.gl={vl:r,pl:o},o}tn(){var t,e,i,n;const r=(i=(e=(t=this.yl).timeAxisViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((n=this.Ml)===null||n===void 0?void 0:n.vl)===r)return this.Ml.pl;const o=this.Wr.qt().yt(),l=r.map((a=>new Xg(a,o)));return this.Ml={vl:r,pl:l},l}Rn(){var t,e,i,n;const r=(i=(e=(t=this.yl).priceAxisViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((n=this.xl)===null||n===void 0?void 0:n.vl)===r)return this.xl.pl;const o=this.Wr.At(),l=r.map((a=>new Yg(a,o)));return this.xl={vl:r,pl:l},l}Tl(){var t,e,i,n;const r=(i=(e=(t=this.yl).priceAxisPaneViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((n=this.Sl)===null||n===void 0?void 0:n.vl)===r)return this.Sl.pl;const o=r.map((l=>new sr(l)));return this.Sl={vl:r,pl:o},o}Pl(){var t,e,i,n;const r=(i=(e=(t=this.yl).timeAxisPaneViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((n=this.kl)===null||n===void 0?void 0:n.vl)===r)return this.kl.pl;const o=r.map((l=>new sr(l)));return this.kl={vl:r,pl:o},o}Rl(t,e){var i,n,r;return(r=(n=(i=this.yl).autoscaleInfo)===null||n===void 0?void 0:n.call(i,t,e))!==null&&r!==void 0?r:null}br(t,e){var i,n,r;return(r=(n=(i=this.yl).hitTest)===null||n===void 0?void 0:n.call(i,t,e))!==null&&r!==void 0?r:null}}function ir(s,t,e,i){s.forEach((n=>{t(n).forEach((r=>{r.ml()===e&&i.push(r)}))}))}function nr(s){return s.Pn()}function Zg(s){return s.Tl()}function tb(s){return s.Pl()}class Ao extends Hg{constructor(t,e,i,n,r){super(t),this.Lt=new Gg,this.Eh=new Fg(this),this.Dl=[],this.Ol=new Og(this),this.Al=null,this.Vl=null,this.Bl=[],this.Il=[],this.zl=null,this.El=[],this.cn=e,this.Ll=i;const o=new Ug(this);this.hn=[o],this.Lh=new yh(o,this,t),i!=="Area"&&i!=="Line"&&i!=="Baseline"||(this.Al=new Rg(this)),this.Nl(),this.Fl(r)}S(){this.zl!==null&&clearTimeout(this.zl)}_h(t){return this.cn.priceLineColor||t}Yr(t){const e={Xr:!0},i=this.At();if(this.qt().yt().Fi()||i.Fi()||this.Lt.Fi())return e;const n=this.qt().yt().Xs(),r=this.Pt();if(n===null||r===null)return e;let o,l;if(t){const d=this.Lt.Jh();if(d===null)return e;o=d,l=d.se}else{const d=this.Lt.nl(n.di(),-1);if(d===null||(o=this.Lt.qh(d.se),o===null))return e;l=d.se}const a=o.Vt[3],u=this.$s().Hs(l,{Vt:o}),c=i.Ot(a,r.Vt);return{Xr:!1,ct:a,Jt:i.Wi(a,r.Vt),mh:i.Wl(a),bh:i.jl(a,r.Vt),O:u.ue,yi:c,se:l}}$s(){return this.Vl!==null||(this.Vl=new jg(this)),this.Vl}W(){return this.cn}Nh(t){const e=t.priceScaleId;e!==void 0&&e!==this.cn.priceScaleId&&this.qt().Hl(this,e),be(this.cn,t),t.priceFormat!==void 0&&(this.Nl(),this.qt().$l()),this.qt().Ul(this),this.qt().ql(),this.wn.gt("options")}it(t,e){this.Lt.it(t),this.Yl(),this.wn.gt("data"),this.dn.gt("data"),this.Al!==null&&(e&&e.Xl?this.Al.Hr():t.length===0&&this.Al.jr());const i=this.qt().cr(this);this.qt().Kl(i),this.qt().Ul(this),this.qt().ql(),this.qt().Fh()}Zl(t){this.Bl=t,this.Yl();const e=this.qt().cr(this);this.dn.gt("data"),this.qt().Kl(e),this.qt().Ul(this),this.qt().ql(),this.qt().Fh()}Gl(){return this.Bl}ah(){return this.Il}Jl(t){const e=new Wg(this,t);return this.Dl.push(e),this.qt().Ul(this),e}Ql(t){const e=this.Dl.indexOf(t);e!==-1&&this.Dl.splice(e,1),this.qt().Ul(this)}Xh(){return this.Ll}Pt(){const t=this.ta();return t===null?null:{Vt:t.Vt[3],ia:t.ut}}ta(){const t=this.qt().yt().Xs();if(t===null)return null;const e=t.Os();return this.Lt.nl(e,1)}In(){return this.Lt}oh(t){const e=this.Lt.qh(t);return e===null?null:this.Ll==="Bar"||this.Ll==="Candlestick"||this.Ll==="Custom"?{we:e.Vt[0],ge:e.Vt[1],Me:e.Vt[2],xe:e.Vt[3]}:e.Vt[3]}na(t){const e=[];ir(this.El,nr,"top",e);const i=this.Al;return i!==null&&i.Tt()&&(this.zl===null&&i.Ur()&&(this.zl=setTimeout((()=>{this.zl=null,this.qt().sa()}),0)),i.$r(),e.push(i)),e}Pn(){const t=[];this.ea()||t.push(this.Ol),t.push(this.wn,this.Eh,this.dn);const e=this.Dl.map((i=>i.Wh()));return t.push(...e),ir(this.El,nr,"normal",t),t}ra(){return this.ha(nr,"bottom")}la(t){return this.ha(Zg,t)}aa(t){return this.ha(tb,t)}oa(t,e){return this.El.map((i=>i.br(t,e))).filter((i=>i!==null))}Qi(t){return[this.Lh,...this.Dl.map((e=>e.jh()))]}Rn(t,e){if(e!==this.Xi&&!this.ea())return[];const i=[...this.hn];for(const n of this.Dl)i.push(n.Hh());return this.El.forEach((n=>{i.push(...n.Rn())})),i}tn(){const t=[];return this.El.forEach((e=>{t.push(...e.tn())})),t}Rl(t,e){if(this.cn.autoscaleInfoProvider!==void 0){const i=this.cn.autoscaleInfoProvider((()=>{const n=this._a(t,e);return n===null?null:n.Ph()}));return vn.Rh(i)}return this._a(t,e)}ua(){return this.cn.priceFormat.minMove}ca(){return this.da}On(){var t;this.wn.gt(),this.dn.gt();for(const e of this.hn)e.gt();for(const e of this.Dl)e.gt();this.Eh.gt(),this.Ol.gt(),(t=this.Al)===null||t===void 0||t.gt(),this.El.forEach((e=>e.On()))}At(){return U(super.At())}Ct(t){if(!((this.Ll==="Line"||this.Ll==="Area"||this.Ll==="Baseline")&&this.cn.crosshairMarkerVisible))return null;const e=this.Lt.qh(t);return e===null?null:{ct:e.Vt[3],ot:this.fa(),Bt:this.va(),Dt:this.pa(),Rt:this.ma(t)}}uh(){return this.cn.title}Tt(){return this.cn.visible}ba(t){this.El.push(new Qg(t,this))}wa(t){this.El=this.El.filter((e=>e.Cl()!==t))}ga(){if(this.wn instanceof er)return t=>this.wn.Fe(t)}Ma(){if(this.wn instanceof er)return t=>this.wn.We(t)}ea(){return!$n(this.At().xa())}_a(t,e){if(!wi(t)||!wi(e)||this.Lt.Fi())return null;const i=this.Ll==="Line"||this.Ll==="Area"||this.Ll==="Baseline"||this.Ll==="Histogram"?[3]:[2,1],n=this.Lt.el(t,e,i);let r=n!==null?new ne(n.cl,n.dl):null;if(this.Xh()==="Histogram"){const l=this.cn.base,a=new ne(l,l);r=r!==null?r.ts(a):a}let o=this.dn.lh();return this.El.forEach((l=>{const a=l.Rl(t,e);if(a?.priceRange){const p=new ne(a.priceRange.minValue,a.priceRange.maxValue);r=r!==null?r.ts(p):p}var u,c,d,f;a?.margins&&(u=o,c=a.margins,o={above:Math.max((d=u?.above)!==null&&d!==void 0?d:0,c.above),below:Math.max((f=u?.below)!==null&&f!==void 0?f:0,c.below)})})),new vn(r,o)}fa(){switch(this.Ll){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerRadius}return 0}va(){switch(this.Ll){case"Line":case"Area":case"Baseline":{const t=this.cn.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}pa(){switch(this.Ll){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerBorderWidth}return 0}ma(t){switch(this.Ll){case"Line":case"Area":case"Baseline":{const e=this.cn.crosshairMarkerBackgroundColor;if(e.length!==0)return e}}return this.$s().Hs(t).ue}Nl(){switch(this.cn.priceFormat.type){case"custom":this.da={format:this.cn.priceFormat.formatter};break;case"volume":this.da=new lg(this.cn.priceFormat.precision);break;case"percent":this.da=new uh(this.cn.priceFormat.precision);break;default:{const t=Math.pow(10,this.cn.priceFormat.precision);this.da=new Dn(t,this.cn.priceFormat.minMove*t)}}this.Xi!==null&&this.Xi.Sa()}Yl(){const t=this.qt().yt();if(!t.ka()||this.Lt.Fi())return void(this.Il=[]);const e=U(this.Lt.Qh());this.Il=this.Bl.map(((i,n)=>{const r=U(t.ya(i.time,!0)),o=r<e?1:-1;return{time:U(this.Lt.nl(r,o)).se,position:i.position,shape:i.shape,color:i.color,id:i.id,Jr:n,text:i.text,size:i.size,originalTime:i.originalTime}}))}Fl(t){switch(this.dn=new Vg(this,this.qt()),this.Ll){case"Bar":this.wn=new vg(this,this.qt());break;case"Candlestick":this.wn=new wg(this,this.qt());break;case"Line":this.wn=new Tg(this,this.qt());break;case"Custom":this.wn=new er(this,this.qt(),Yt(t));break;case"Area":this.wn=new pg(this,this.qt());break;case"Baseline":this.wn=new yg(this,this.qt());break;case"Histogram":this.wn=new Eg(this,this.qt());break;default:throw Error("Unknown chart style assigned: "+this.Ll)}}ha(t,e){const i=[];return ir(this.El,t,e,i),i}}class eb{constructor(t){this.cn=t}Ca(t,e,i){let n=t;if(this.cn.mode===0)return n;const r=i.vn(),o=r.Pt();if(o===null)return n;const l=r.Ot(t,o),a=i.Ta().filter((c=>c instanceof Ao)).reduce(((c,d)=>{if(i.dr(d)||!d.Tt())return c;const f=d.At(),p=d.In();if(f.Fi()||!p.Kr(e))return c;const v=p.qh(e);if(v===null)return c;const g=Ms(d.Pt());return c.concat([f.Ot(v.Vt[3],g.Vt)])}),[]);if(a.length===0)return n;a.sort(((c,d)=>Math.abs(c-l)-Math.abs(d-l)));const u=a[0];return n=r.pn(u,o),n}}class sb extends Je{constructor(){super(...arguments),this.Lt=null}it(t){this.Lt=t}Z({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(this.Lt===null)return;const r=Math.max(1,Math.floor(i));t.lineWidth=r,(function(o,l){o.save(),o.lineWidth%2&&o.translate(.5,.5),l(),o.restore()})(t,(()=>{const o=U(this.Lt);if(o.Pa){t.strokeStyle=o.Ra,ws(t,o.Da),t.beginPath();for(const l of o.Oa){const a=Math.round(l.Aa*i);t.moveTo(a,-r),t.lineTo(a,e.height+r)}t.stroke()}if(o.Va){t.strokeStyle=o.Ba,ws(t,o.Ia),t.beginPath();for(const l of o.za){const a=Math.round(l.Aa*n);t.moveTo(-r,a),t.lineTo(e.width+r,a)}t.stroke()}}))}}class ib{constructor(t){this.Ht=new sb,this.bt=!0,this.nn=t}gt(){this.bt=!0}xt(){if(this.bt){const t=this.nn.qt().W().grid,e={Va:t.horzLines.visible,Pa:t.vertLines.visible,Ba:t.horzLines.color,Ra:t.vertLines.color,Ia:t.horzLines.style,Da:t.vertLines.style,za:this.nn.vn().Ea(),Oa:(this.nn.qt().yt().Ea()||[]).map((i=>({Aa:i.coord})))};this.Ht.it(e),this.bt=!1}return this.Ht}}class nb{constructor(t){this.wn=new ib(t)}Wh(){return this.wn}}const rr={La:4,Na:1e-4};function As(s,t){const e=100*(s-t)/t;return t<0?-e:e}function rb(s,t){const e=As(s.Sh(),t),i=As(s.kh(),t);return new ne(e,i)}function hi(s,t){const e=100*(s-t)/t+100;return t<0?-e:e}function ob(s,t){const e=hi(s.Sh(),t),i=hi(s.kh(),t);return new ne(e,i)}function gn(s,t){const e=Math.abs(s);if(e<1e-15)return 0;const i=Math.log10(e+t.Na)+t.La;return s<0?-i:i}function ci(s,t){const e=Math.abs(s);if(e<1e-15)return 0;const i=Math.pow(10,e-t.La)-t.Na;return s<0?-i:i}function Qs(s,t){if(s===null)return null;const e=gn(s.Sh(),t),i=gn(s.kh(),t);return new ne(e,i)}function Vi(s,t){if(s===null)return null;const e=ci(s.Sh(),t),i=ci(s.kh(),t);return new ne(e,i)}function or(s){if(s===null)return rr;const t=Math.abs(s.kh()-s.Sh());if(t>=1||t<1e-15)return rr;const e=Math.ceil(Math.abs(Math.log10(t))),i=rr.La+e;return{La:i,Na:1/Math.pow(10,i)}}class lr{constructor(t,e){if(this.Fa=t,this.Wa=e,(function(i){if(i<0)return!1;for(let n=i;n>1;n/=10)if(n%10!=0)return!1;return!0})(this.Fa))this.ja=[2,2.5,2];else{this.ja=[];for(let i=this.Fa;i!==1;){if(i%2==0)this.ja.push(2),i/=2;else{if(i%5!=0)throw new Error("unexpected base");this.ja.push(2,2.5),i/=5}if(this.ja.length>100)throw new Error("something wrong with base")}}}Ha(t,e,i){const n=this.Fa===0?0:1/this.Fa;let r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),o=0,l=this.Wa[0];for(;;){const d=Ii(r,n,1e-14)&&r>n+1e-14,f=Ii(r,i*l,1e-14),p=Ii(r,1,1e-14);if(!(d&&f&&p))break;r/=l,l=this.Wa[++o%this.Wa.length]}if(r<=n+1e-14&&(r=n),r=Math.max(1,r),this.ja.length>0&&(a=r,u=1,c=1e-14,Math.abs(a-u)<c))for(o=0,l=this.ja[0];Ii(r,i*l,1e-14)&&r>n+1e-14;)r/=l,l=this.ja[++o%this.ja.length];var a,u,c;return r}}class ta{constructor(t,e,i,n){this.$a=[],this.Li=t,this.Fa=e,this.Ua=i,this.qa=n}Ha(t,e){if(t<e)throw new Error("high < low");const i=this.Li.zt(),n=(t-e)*this.Ya()/i,r=new lr(this.Fa,[2,2.5,2]),o=new lr(this.Fa,[2,2,2.5]),l=new lr(this.Fa,[2.5,2,2]),a=[];return a.push(r.Ha(t,e,n),o.Ha(t,e,n),l.Ha(t,e,n)),(function(u){if(u.length<1)throw Error("array is empty");let c=u[0];for(let d=1;d<u.length;++d)u[d]<c&&(c=u[d]);return c})(a)}Xa(){const t=this.Li,e=t.Pt();if(e===null)return void(this.$a=[]);const i=t.zt(),n=this.Ua(i-1,e),r=this.Ua(0,e),o=this.Li.W().entireTextOnly?this.Ka()/2:0,l=o,a=i-1-o,u=Math.max(n,r),c=Math.min(n,r);if(u===c)return void(this.$a=[]);let d=this.Ha(u,c),f=u%d;f+=f<0?d:0;const p=u>=c?1:-1;let v=null,g=0;for(let _=u-f;_>c;_-=d){const w=this.qa(_,e,!0);v!==null&&Math.abs(w-v)<this.Ya()||w<l||w>a||(g<this.$a.length?(this.$a[g].Aa=w,this.$a[g].Za=t.Ga(_)):this.$a.push({Aa:w,Za:t.Ga(_)}),g++,v=w,t.Ja()&&(d=this.Ha(_*p,c)))}this.$a.length=g}Ea(){return this.$a}Ka(){return this.Li.P()}Ya(){return Math.ceil(2.5*this.Ka())}}function xh(s){return s.slice().sort(((t,e)=>U(t.Zi())-U(e.Zi())))}var Ur;(function(s){s[s.Normal=0]="Normal",s[s.Logarithmic=1]="Logarithmic",s[s.Percentage=2]="Percentage",s[s.IndexedTo100=3]="IndexedTo100"})(Ur||(Ur={}));const ea=new uh,sa=new Dn(100,1);class lb{constructor(t,e,i,n){this.Qa=0,this.io=null,this.Dh=null,this.no=null,this.so={eo:!1,ro:null},this.ho=0,this.lo=0,this.ao=new Mt,this.oo=new Mt,this._o=[],this.uo=null,this.co=null,this.do=null,this.fo=null,this.da=sa,this.vo=or(null),this.po=t,this.cn=e,this.mo=i,this.bo=n,this.wo=new ta(this,100,this.Mo.bind(this),this.xo.bind(this))}xa(){return this.po}W(){return this.cn}Nh(t){if(be(this.cn,t),this.Sa(),t.mode!==void 0&&this.So({yr:t.mode}),t.scaleMargins!==void 0){const e=Yt(t.scaleMargins.top),i=Yt(t.scaleMargins.bottom);if(e<0||e>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(i<0||i>1||e+i>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(e+i>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${e+i}`);this.ko(),this.co=null}}yo(){return this.cn.autoScale}Ja(){return this.cn.mode===1}ph(){return this.cn.mode===2}Co(){return this.cn.mode===3}yr(){return{Wn:this.cn.autoScale,To:this.cn.invertScale,yr:this.cn.mode}}So(t){const e=this.yr();let i=null;t.Wn!==void 0&&(this.cn.autoScale=t.Wn),t.yr!==void 0&&(this.cn.mode=t.yr,t.yr!==2&&t.yr!==3||(this.cn.autoScale=!0),this.so.eo=!1),e.yr===1&&t.yr!==e.yr&&((function(r,o){if(r===null)return!1;const l=ci(r.Sh(),o),a=ci(r.kh(),o);return isFinite(l)&&isFinite(a)})(this.Dh,this.vo)?(i=Vi(this.Dh,this.vo),i!==null&&this.Po(i)):this.cn.autoScale=!0),t.yr===1&&t.yr!==e.yr&&(i=Qs(this.Dh,this.vo),i!==null&&this.Po(i));const n=e.yr!==this.cn.mode;n&&(e.yr===2||this.ph())&&this.Sa(),n&&(e.yr===3||this.Co())&&this.Sa(),t.To!==void 0&&e.To!==t.To&&(this.cn.invertScale=t.To,this.Ro()),this.oo.m(e,this.yr())}Do(){return this.oo}P(){return this.mo.fontSize}zt(){return this.Qa}Oo(t){this.Qa!==t&&(this.Qa=t,this.ko(),this.co=null)}Ao(){if(this.io)return this.io;const t=this.zt()-this.Vo()-this.Bo();return this.io=t,t}Ah(){return this.Io(),this.Dh}Po(t,e){const i=this.Dh;(e||i===null&&t!==null||i!==null&&!i.Mh(t))&&(this.co=null,this.Dh=t)}Fi(){return this.Io(),this.Qa===0||!this.Dh||this.Dh.Fi()}zo(t){return this.To()?t:this.zt()-1-t}Ot(t,e){return this.ph()?t=As(t,e):this.Co()&&(t=hi(t,e)),this.xo(t,e)}Qs(t,e,i){this.Io();const n=this.Bo(),r=U(this.Ah()),o=r.Sh(),l=r.kh(),a=this.Ao()-1,u=this.To(),c=a/(l-o),d=i===void 0?0:i.from,f=i===void 0?t.length:i.to,p=this.Eo();for(let v=d;v<f;v++){const g=t[v],_=g.ct;if(isNaN(_))continue;let w=_;p!==null&&(w=p(g.ct,e));const y=n+c*(w-o),M=u?y:this.Qa-1-y;g.rt=M}}me(t,e,i){this.Io();const n=this.Bo(),r=U(this.Ah()),o=r.Sh(),l=r.kh(),a=this.Ao()-1,u=this.To(),c=a/(l-o),d=i===void 0?0:i.from,f=i===void 0?t.length:i.to,p=this.Eo();for(let v=d;v<f;v++){const g=t[v];let _=g.we,w=g.ge,y=g.Me,M=g.xe;p!==null&&(_=p(g.we,e),w=p(g.ge,e),y=p(g.Me,e),M=p(g.xe,e));let D=n+c*(_-o),X=u?D:this.Qa-1-D;g.ve=X,D=n+c*(w-o),X=u?D:this.Qa-1-D,g.ce=X,D=n+c*(y-o),X=u?D:this.Qa-1-D,g.de=X,D=n+c*(M-o),X=u?D:this.Qa-1-D,g.pe=X}}pn(t,e){const i=this.Mo(t,e);return this.Lo(i,e)}Lo(t,e){let i=t;return this.ph()?i=(function(n,r){return r<0&&(n=-n),n/100*r+r})(i,e):this.Co()&&(i=(function(n,r){return n-=100,r<0&&(n=-n),n/100*r+r})(i,e)),i}Ta(){return this._o}No(){if(this.uo)return this.uo;let t=[];for(let e=0;e<this._o.length;e++){const i=this._o[e];i.Zi()===null&&i.Gi(e+1),t.push(i)}return t=xh(t),this.uo=t,this.uo}Fo(t){this._o.indexOf(t)===-1&&(this._o.push(t),this.Sa(),this.Wo())}jo(t){const e=this._o.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this._o.splice(e,1),this._o.length===0&&(this.So({Wn:!0}),this.Po(null)),this.Sa(),this.Wo()}Pt(){let t=null;for(const e of this._o){const i=e.Pt();i!==null&&(t===null||i.ia<t.ia)&&(t=i)}return t===null?null:t.Vt}To(){return this.cn.invertScale}Ea(){const t=this.Pt()===null;if(this.co!==null&&(t||this.co.Ho===t))return this.co.Ea;this.wo.Xa();const e=this.wo.Ea();return this.co={Ea:e,Ho:t},this.ao.m(),e}$o(){return this.ao}Uo(t){this.ph()||this.Co()||this.do===null&&this.no===null&&(this.Fi()||(this.do=this.Qa-t,this.no=U(this.Ah()).xh()))}qo(t){if(this.ph()||this.Co()||this.do===null)return;this.So({Wn:!1}),(t=this.Qa-t)<0&&(t=0);let e=(this.do+.2*(this.Qa-1))/(t+.2*(this.Qa-1));const i=U(this.no).xh();e=Math.max(e,.1),i.Ch(e),this.Po(i)}Yo(){this.ph()||this.Co()||(this.do=null,this.no=null)}Xo(t){this.yo()||this.fo===null&&this.no===null&&(this.Fi()||(this.fo=t,this.no=U(this.Ah()).xh()))}Ko(t){if(this.yo()||this.fo===null)return;const e=U(this.Ah()).yh()/(this.Ao()-1);let i=t-this.fo;this.To()&&(i*=-1);const n=i*e,r=U(this.no).xh();r.Th(n),this.Po(r,!0),this.co=null}Zo(){this.yo()||this.fo!==null&&(this.fo=null,this.no=null)}ca(){return this.da||this.Sa(),this.da}Wi(t,e){switch(this.cn.mode){case 2:return this.Go(As(t,e));case 3:return this.ca().format(hi(t,e));default:return this.zh(t)}}Ga(t){switch(this.cn.mode){case 2:return this.Go(t);case 3:return this.ca().format(t);default:return this.zh(t)}}Wl(t){return this.zh(t,U(this.Jo()).ca())}jl(t,e){return t=As(t,e),this.Go(t,ea)}Qo(){return this._o}t_(t){this.so={ro:t,eo:!1}}On(){this._o.forEach((t=>t.On()))}Sa(){this.co=null;const t=this.Jo();let e=100;t!==null&&(e=Math.round(1/t.ua())),this.da=sa,this.ph()?(this.da=ea,e=100):this.Co()?(this.da=new Dn(100,1),e=100):t!==null&&(this.da=t.ca()),this.wo=new ta(this,e,this.Mo.bind(this),this.xo.bind(this)),this.wo.Xa()}Wo(){this.uo=null}Jo(){return this._o[0]||null}Vo(){return this.To()?this.cn.scaleMargins.bottom*this.zt()+this.lo:this.cn.scaleMargins.top*this.zt()+this.ho}Bo(){return this.To()?this.cn.scaleMargins.top*this.zt()+this.ho:this.cn.scaleMargins.bottom*this.zt()+this.lo}Io(){this.so.eo||(this.so.eo=!0,this.i_())}ko(){this.io=null}xo(t,e){if(this.Io(),this.Fi())return 0;t=this.Ja()&&t?gn(t,this.vo):t;const i=U(this.Ah()),n=this.Bo()+(this.Ao()-1)*(t-i.Sh())/i.yh();return this.zo(n)}Mo(t,e){if(this.Io(),this.Fi())return 0;const i=this.zo(t),n=U(this.Ah()),r=n.Sh()+n.yh()*((i-this.Bo())/(this.Ao()-1));return this.Ja()?ci(r,this.vo):r}Ro(){this.co=null,this.wo.Xa()}i_(){const t=this.so.ro;if(t===null)return;let e=null;const i=this.Qo();let n=0,r=0;for(const a of i){if(!a.Tt())continue;const u=a.Pt();if(u===null)continue;const c=a.Rl(t.Os(),t.di());let d=c&&c.Ah();if(d!==null){switch(this.cn.mode){case 1:d=Qs(d,this.vo);break;case 2:d=rb(d,u.Vt);break;case 3:d=ob(d,u.Vt)}if(e=e===null?d:e.ts(U(d)),c!==null){const f=c.Vh();f!==null&&(n=Math.max(n,f.above),r=Math.max(n,f.below))}}}if(n===this.ho&&r===this.lo||(this.ho=n,this.lo=r,this.co=null,this.ko()),e!==null){if(e.Sh()===e.kh()){const a=this.Jo(),u=5*(a===null||this.ph()||this.Co()?1:a.ua());this.Ja()&&(e=Vi(e,this.vo)),e=new ne(e.Sh()-u,e.kh()+u),this.Ja()&&(e=Qs(e,this.vo))}if(this.Ja()){const a=Vi(e,this.vo),u=or(a);if(o=u,l=this.vo,o.La!==l.La||o.Na!==l.Na){const c=this.no!==null?Vi(this.no,this.vo):null;this.vo=u,e=Qs(a,u),c!==null&&(this.no=Qs(c,u))}}this.Po(e)}else this.Dh===null&&(this.Po(new ne(-.5,.5)),this.vo=or(null));var o,l;this.so.eo=!0}Eo(){return this.ph()?As:this.Co()?hi:this.Ja()?t=>gn(t,this.vo):null}n_(t,e,i){return e===void 0?(i===void 0&&(i=this.ca()),i.format(t)):e(t)}zh(t,e){return this.n_(t,this.bo.priceFormatter,e)}Go(t,e){return this.n_(t,this.bo.percentageFormatter,e)}}class ab{constructor(t,e){this._o=[],this.s_=new Map,this.Qa=0,this.e_=0,this.r_=1e3,this.uo=null,this.h_=new Mt,this.wl=t,this.Ui=e,this.l_=new nb(this);const i=e.W();this.a_=this.o_("left",i.leftPriceScale),this.__=this.o_("right",i.rightPriceScale),this.a_.Do().l(this.u_.bind(this,this.a_),this),this.__.Do().l(this.u_.bind(this,this.__),this),this.c_(i)}c_(t){if(t.leftPriceScale&&this.a_.Nh(t.leftPriceScale),t.rightPriceScale&&this.__.Nh(t.rightPriceScale),t.localization&&(this.a_.Sa(),this.__.Sa()),t.overlayPriceScales){const e=Array.from(this.s_.values());for(const i of e){const n=U(i[0].At());n.Nh(t.overlayPriceScales),t.localization&&n.Sa()}}}d_(t){switch(t){case"left":return this.a_;case"right":return this.__}return this.s_.has(t)?Yt(this.s_.get(t))[0].At():null}S(){this.qt().f_().p(this),this.a_.Do().p(this),this.__.Do().p(this),this._o.forEach((t=>{t.S&&t.S()})),this.h_.m()}v_(){return this.r_}p_(t){this.r_=t}qt(){return this.Ui}$i(){return this.e_}zt(){return this.Qa}m_(t){this.e_=t,this.b_()}Oo(t){this.Qa=t,this.a_.Oo(t),this.__.Oo(t),this._o.forEach((e=>{if(this.dr(e)){const i=e.At();i!==null&&i.Oo(t)}})),this.b_()}Ta(){return this._o}dr(t){const e=t.At();return e===null||this.a_!==e&&this.__!==e}Fo(t,e,i){const n=i!==void 0?i:this.g_().w_+1;this.M_(t,e,n)}jo(t){const e=this._o.indexOf(t);ls(e!==-1,"removeDataSource: invalid data source"),this._o.splice(e,1);const i=U(t.At()).xa();if(this.s_.has(i)){const r=Yt(this.s_.get(i)),o=r.indexOf(t);o!==-1&&(r.splice(o,1),r.length===0&&this.s_.delete(i))}const n=t.At();n&&n.Ta().indexOf(t)>=0&&n.jo(t),n!==null&&(n.Wo(),this.x_(n)),this.uo=null}pr(t){return t===this.a_?"left":t===this.__?"right":"overlay"}S_(){return this.a_}k_(){return this.__}y_(t,e){t.Uo(e)}C_(t,e){t.qo(e),this.b_()}T_(t){t.Yo()}P_(t,e){t.Xo(e)}R_(t,e){t.Ko(e),this.b_()}D_(t){t.Zo()}b_(){this._o.forEach((t=>{t.On()}))}vn(){let t=null;return this.Ui.W().rightPriceScale.visible&&this.__.Ta().length!==0?t=this.__:this.Ui.W().leftPriceScale.visible&&this.a_.Ta().length!==0?t=this.a_:this._o.length!==0&&(t=this._o[0].At()),t===null&&(t=this.__),t}vr(){let t=null;return this.Ui.W().rightPriceScale.visible?t=this.__:this.Ui.W().leftPriceScale.visible&&(t=this.a_),t}x_(t){t!==null&&t.yo()&&this.O_(t)}A_(t){const e=this.wl.Xs();t.So({Wn:!0}),e!==null&&t.t_(e),this.b_()}V_(){this.O_(this.a_),this.O_(this.__)}B_(){this.x_(this.a_),this.x_(this.__),this._o.forEach((t=>{this.dr(t)&&this.x_(t.At())})),this.b_(),this.Ui.Fh()}No(){return this.uo===null&&(this.uo=xh(this._o)),this.uo}I_(){return this.h_}z_(){return this.l_}O_(t){const e=t.Qo();if(e&&e.length>0&&!this.wl.Fi()){const i=this.wl.Xs();i!==null&&t.t_(i)}t.On()}g_(){const t=this.No();if(t.length===0)return{E_:0,w_:0};let e=0,i=0;for(let n=0;n<t.length;n++){const r=t[n].Zi();r!==null&&(r<e&&(e=r),r>i&&(i=r))}return{E_:e,w_:i}}M_(t,e,i){let n=this.d_(e);if(n===null&&(n=this.o_(e,this.Ui.W().overlayPriceScales)),this._o.push(t),!$n(e)){const r=this.s_.get(e)||[];r.push(t),this.s_.set(e,r)}n.Fo(t),t.Ji(n),t.Gi(i),this.x_(n),this.uo=null}u_(t,e,i){e.yr!==i.yr&&this.O_(t)}o_(t,e){const i=Object.assign({visible:!0,autoScale:!0},Fe(e)),n=new lb(t,i,this.Ui.W().layout,this.Ui.W().localization);return n.Oo(this.zt()),n}}class ub{constructor(t,e,i=50){this.Ke=0,this.Ze=1,this.Ge=1,this.Qe=new Map,this.Je=new Map,this.L_=t,this.N_=e,this.tr=i}F_(t){const e=t.time,i=this.N_.cacheKey(e),n=this.Qe.get(i);if(n!==void 0)return n.W_;if(this.Ke===this.tr){const o=this.Je.get(this.Ge);this.Je.delete(this.Ge),this.Qe.delete(Yt(o)),this.Ge++,this.Ke--}const r=this.L_(t);return this.Qe.set(i,{W_:r,er:this.Ze}),this.Je.set(this.Ze,i),this.Ke++,this.Ze++,r}}class di{constructor(t,e){ls(t<=e,"right should be >= left"),this.j_=t,this.H_=e}Os(){return this.j_}di(){return this.H_}U_(){return this.H_-this.j_+1}Kr(t){return this.j_<=t&&t<=this.H_}Mh(t){return this.j_===t.Os()&&this.H_===t.di()}}function ia(s,t){return s===null||t===null?s===t:s.Mh(t)}class hb{constructor(){this.q_=new Map,this.Qe=null,this.Y_=!1}X_(t){this.Y_=t,this.Qe=null}K_(t,e){this.Z_(e),this.Qe=null;for(let i=e;i<t.length;++i){const n=t[i];let r=this.q_.get(n.timeWeight);r===void 0&&(r=[],this.q_.set(n.timeWeight,r)),r.push({index:i,time:n.time,weight:n.timeWeight,originalTime:n.originalTime})}}G_(t,e){const i=Math.ceil(e/t);return this.Qe!==null&&this.Qe.J_===i||(this.Qe={Ea:this.Q_(i),J_:i}),this.Qe.Ea}Z_(t){if(t===0)return void this.q_.clear();const e=[];this.q_.forEach(((i,n)=>{t<=i[0].index?e.push(n):i.splice(Pi(i,t,(r=>r.index<t)),1/0)}));for(const i of e)this.q_.delete(i)}Q_(t){let e=[];for(const i of Array.from(this.q_.keys()).sort(((n,r)=>r-n))){if(!this.q_.get(i))continue;const n=e;e=[];const r=n.length;let o=0;const l=Yt(this.q_.get(i)),a=l.length;let u=1/0,c=-1/0;for(let d=0;d<a;d++){const f=l[d],p=f.index;for(;o<r;){const v=n[o],g=v.index;if(!(g<p)){u=g;break}o++,e.push(v),c=g,u=1/0}if(u-p>=t&&p-c>=t)e.push(f),c=p;else if(this.Y_)return n}for(;o<r;o++)e.push(n[o])}return e}}class $s{constructor(t){this.tu=t}iu(){return this.tu===null?null:new di(Math.floor(this.tu.Os()),Math.ceil(this.tu.di()))}nu(){return this.tu}static su(){return new $s(null)}}function cb(s,t){return s.weight>t.weight?s:t}class db{constructor(t,e,i,n){this.e_=0,this.eu=null,this.ru=[],this.fo=null,this.do=null,this.hu=new hb,this.lu=new Map,this.au=$s.su(),this.ou=!0,this._u=new Mt,this.uu=new Mt,this.cu=new Mt,this.du=null,this.fu=null,this.vu=[],this.cn=e,this.bo=i,this.pu=e.rightOffset,this.mu=e.barSpacing,this.Ui=t,this.N_=n,this.bu(),this.hu.X_(e.uniformDistribution)}W(){return this.cn}wu(t){be(this.bo,t),this.gu(),this.bu()}Nh(t,e){var i;be(this.cn,t),this.cn.fixLeftEdge&&this.Mu(),this.cn.fixRightEdge&&this.xu(),t.barSpacing!==void 0&&this.Ui.Gn(t.barSpacing),t.rightOffset!==void 0&&this.Ui.Jn(t.rightOffset),t.minBarSpacing!==void 0&&this.Ui.Gn((i=t.barSpacing)!==null&&i!==void 0?i:this.mu),this.gu(),this.bu(),this.cu.m()}mn(t){var e,i;return(i=(e=this.ru[t])===null||e===void 0?void 0:e.time)!==null&&i!==void 0?i:null}qi(t){var e;return(e=this.ru[t])!==null&&e!==void 0?e:null}ya(t,e){if(this.ru.length<1)return null;if(this.N_.key(t)>this.N_.key(this.ru[this.ru.length-1].time))return e?this.ru.length-1:null;const i=Pi(this.ru,this.N_.key(t),((n,r)=>this.N_.key(n.time)<r));return this.N_.key(t)<this.N_.key(this.ru[i].time)?e?i:null:i}Fi(){return this.e_===0||this.ru.length===0||this.eu===null}ka(){return this.ru.length>0}Xs(){return this.Su(),this.au.iu()}ku(){return this.Su(),this.au.nu()}yu(){const t=this.Xs();if(t===null)return null;const e={from:t.Os(),to:t.di()};return this.Cu(e)}Cu(t){const e=Math.round(t.from),i=Math.round(t.to),n=U(this.Tu()),r=U(this.Bn());return{from:U(this.qi(Math.max(n,e))),to:U(this.qi(Math.min(r,i)))}}Pu(t){return{from:U(this.ya(t.from,!0)),to:U(this.ya(t.to,!0))}}$i(){return this.e_}m_(t){if(!isFinite(t)||t<=0||this.e_===t)return;const e=this.ku(),i=this.e_;if(this.e_=t,this.ou=!0,this.cn.lockVisibleTimeRangeOnResize&&i!==0){const n=this.mu*t/i;this.mu=n}if(this.cn.fixLeftEdge&&e!==null&&e.Os()<=0){const n=i-t;this.pu-=Math.round(n/this.mu)+1,this.ou=!0}this.Ru(),this.Du()}Et(t){if(this.Fi()||!wi(t))return 0;const e=this.Ou()+this.pu-t;return this.e_-(e+.5)*this.mu-1}Js(t,e){const i=this.Ou(),n=e===void 0?0:e.from,r=e===void 0?t.length:e.to;for(let o=n;o<r;o++){const l=t[o].ut,a=i+this.pu-l,u=this.e_-(a+.5)*this.mu-1;t[o].et=u}}Au(t){return Math.ceil(this.Vu(t))}Jn(t){this.ou=!0,this.pu=t,this.Du(),this.Ui.Bu(),this.Ui.Fh()}he(){return this.mu}Gn(t){this.Iu(t),this.Du(),this.Ui.Bu(),this.Ui.Fh()}zu(){return this.pu}Ea(){if(this.Fi())return null;if(this.fu!==null)return this.fu;const t=this.mu,e=5*(this.Ui.W().layout.fontSize+4)/8*(this.cn.tickMarkMaxCharacterLength||8),i=Math.round(e/t),n=U(this.Xs()),r=Math.max(n.Os(),n.Os()-i),o=Math.max(n.di(),n.di()-i),l=this.hu.G_(t,e),a=this.Tu()+i,u=this.Bn()-i,c=this.Eu(),d=this.cn.fixLeftEdge||c,f=this.cn.fixRightEdge||c;let p=0;for(const v of l){if(!(r<=v.index&&v.index<=o))continue;let g;p<this.vu.length?(g=this.vu[p],g.coord=this.Et(v.index),g.label=this.Lu(v),g.weight=v.weight):(g={needAlignCoordinate:!1,coord:this.Et(v.index),label:this.Lu(v),weight:v.weight},this.vu.push(g)),this.mu>e/2&&!c?g.needAlignCoordinate=!1:g.needAlignCoordinate=d&&v.index<=a||f&&v.index>=u,p++}return this.vu.length=p,this.fu=this.vu,this.vu}Nu(){this.ou=!0,this.Gn(this.cn.barSpacing),this.Jn(this.cn.rightOffset)}Fu(t){this.ou=!0,this.eu=t,this.Du(),this.Mu()}Wu(t,e){const i=this.Vu(t),n=this.he(),r=n+e*(n/10);this.Gn(r),this.cn.rightBarStaysOnScroll||this.Jn(this.zu()+(i-this.Vu(t)))}Uo(t){this.fo&&this.Zo(),this.do===null&&this.du===null&&(this.Fi()||(this.do=t,this.ju()))}qo(t){if(this.du===null)return;const e=Fr(this.e_-t,0,this.e_),i=Fr(this.e_-U(this.do),0,this.e_);e!==0&&i!==0&&this.Gn(this.du.he*e/i)}Yo(){this.do!==null&&(this.do=null,this.Hu())}Xo(t){this.fo===null&&this.du===null&&(this.Fi()||(this.fo=t,this.ju()))}Ko(t){if(this.fo===null)return;const e=(this.fo-t)/this.he();this.pu=U(this.du).zu+e,this.ou=!0,this.Du()}Zo(){this.fo!==null&&(this.fo=null,this.Hu())}$u(){this.Uu(this.cn.rightOffset)}Uu(t,e=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const i=this.pu,n=performance.now();this.Ui.Xn({qu:r=>(r-n)/e>=1,Yu:r=>{const o=(r-n)/e;return o>=1?t:i+(t-i)*o}})}gt(t,e){this.ou=!0,this.ru=t,this.hu.K_(t,e),this.Du()}Xu(){return this._u}Ku(){return this.uu}Zu(){return this.cu}Ou(){return this.eu||0}Gu(t){const e=t.U_();this.Iu(this.e_/e),this.pu=t.di()-this.Ou(),this.Du(),this.ou=!0,this.Ui.Bu(),this.Ui.Fh()}Ju(){const t=this.Tu(),e=this.Bn();t!==null&&e!==null&&this.Gu(new di(t,e+this.cn.rightOffset))}Qu(t){const e=new di(t.from,t.to);this.Gu(e)}Yi(t){return this.bo.timeFormatter!==void 0?this.bo.timeFormatter(t.originalTime):this.N_.formatHorzItem(t.time)}Bn(){return this.ru.length===0?null:this.ru.length-1}Eu(){const{handleScroll:t,handleScale:e}=this.Ui.W();return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}Tu(){return this.ru.length===0?null:0}tc(t){return(this.e_-1-t)/this.mu}Vu(t){const e=this.tc(t),i=this.Ou()+this.pu-e;return Math.round(1e6*i)/1e6}Iu(t){const e=this.mu;this.mu=t,this.Ru(),e!==this.mu&&(this.ou=!0,this.ic())}Su(){if(!this.ou)return;if(this.ou=!1,this.Fi())return void this.nc($s.su());const t=this.Ou(),e=this.e_/this.mu,i=this.pu+t,n=new di(i-e+1,i);this.nc(new $s(n))}Ru(){const t=this.sc();if(this.mu<t&&(this.mu=t,this.ou=!0),this.e_!==0){const e=.5*this.e_;this.mu>e&&(this.mu=e,this.ou=!0)}}sc(){return this.cn.fixLeftEdge&&this.cn.fixRightEdge&&this.ru.length!==0?this.e_/this.ru.length:this.cn.minBarSpacing}Du(){const t=this.ec();this.pu>t&&(this.pu=t,this.ou=!0);const e=this.rc();e!==null&&this.pu<e&&(this.pu=e,this.ou=!0)}rc(){const t=this.Tu(),e=this.eu;return t===null||e===null?null:t-e-1+(this.cn.fixLeftEdge?this.e_/this.mu:Math.min(2,this.ru.length))}ec(){return this.cn.fixRightEdge?0:this.e_/this.mu-Math.min(2,this.ru.length)}ju(){this.du={he:this.he(),zu:this.zu()}}Hu(){this.du=null}Lu(t){let e=this.lu.get(t.weight);return e===void 0&&(e=new ub((i=>this.hc(i)),this.N_),this.lu.set(t.weight,e)),e.F_(t)}hc(t){return this.N_.formatTickmark(t,this.bo)}nc(t){const e=this.au;this.au=t,ia(e.iu(),this.au.iu())||this._u.m(),ia(e.nu(),this.au.nu())||this.uu.m(),this.ic()}ic(){this.fu=null}gu(){this.ic(),this.lu.clear()}bu(){this.N_.updateFormatter(this.bo)}Mu(){if(!this.cn.fixLeftEdge)return;const t=this.Tu();if(t===null)return;const e=this.Xs();if(e===null)return;const i=e.Os()-t;if(i<0){const n=this.pu-i-1;this.Jn(n)}this.Ru()}xu(){this.Du(),this.Ru()}}class fb extends Co{constructor(t){super(),this.lc=new Map,this.Lt=t}Z(t){}J(t){if(!this.Lt.Tt)return;const{context:e,mediaSize:i}=t;let n=0;for(const o of this.Lt.ac){if(o.Jt.length===0)continue;e.font=o.R;const l=this.oc(e,o.Jt);l>i.width?o.Wu=i.width/l:o.Wu=1,n+=o._c*o.Wu}let r=0;switch(this.Lt.uc){case"top":r=0;break;case"center":r=Math.max((i.height-n)/2,0);break;case"bottom":r=Math.max(i.height-n,0)}e.fillStyle=this.Lt.O;for(const o of this.Lt.ac){e.save();let l=0;switch(this.Lt.cc){case"left":e.textAlign="left",l=o._c/2;break;case"center":e.textAlign="center",l=i.width/2;break;case"right":e.textAlign="right",l=i.width-1-o._c/2}e.translate(l,r),e.textBaseline="top",e.font=o.R,e.scale(o.Wu,o.Wu),e.fillText(o.Jt,0,o.dc),e.restore(),r+=o._c*o.Wu}}oc(t,e){const i=this.fc(t.font);let n=i.get(e);return n===void 0&&(n=t.measureText(e).width,i.set(e,n)),n}fc(t){let e=this.lc.get(t);return e===void 0&&(e=new Map,this.lc.set(t,e)),e}}class pb{constructor(t){this.bt=!0,this.jt={Tt:!1,O:"",ac:[],uc:"center",cc:"center"},this.Ht=new fb(this.jt),this.$t=t}gt(){this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.Ht}St(){const t=this.$t.W(),e=this.jt;e.Tt=t.visible,e.Tt&&(e.O=t.color,e.cc=t.horzAlign,e.uc=t.vertAlign,e.ac=[{Jt:t.text,R:zs(t.fontSize,t.fontFamily,t.fontStyle),_c:1.2*t.fontSize,dc:0,Wu:0}])}}class mb extends Eo{constructor(t,e){super(),this.cn=e,this.wn=new pb(this)}Rn(){return[]}Pn(){return[this.wn]}W(){return this.cn}On(){this.wn.gt()}}var na,ra,oa,la,aa;(function(s){s[s.OnTouchEnd=0]="OnTouchEnd",s[s.OnNextTap=1]="OnNextTap"})(na||(na={}));class vb{constructor(t,e,i){this.vc=[],this.mc=[],this.e_=0,this.bc=null,this.wc=new Mt,this.gc=new Mt,this.Mc=null,this.xc=t,this.cn=e,this.N_=i,this.Sc=new Jv(this),this.wl=new db(this,e.timeScale,this.cn.localization,i),this.wt=new og(this,e.crosshair),this.kc=new eb(e.crosshair),this.yc=new mb(this,e.watermark),this.Cc(),this.vc[0].p_(2e3),this.Tc=this.Pc(0),this.Rc=this.Pc(1)}$l(){this.Dc($t.es())}Fh(){this.Dc($t.ss())}sa(){this.Dc(new $t(1))}Ul(t){const e=this.Oc(t);this.Dc(e)}Ac(){return this.bc}Vc(t){const e=this.bc;this.bc=t,e!==null&&this.Ul(e.Bc),t!==null&&this.Ul(t.Bc)}W(){return this.cn}Nh(t){be(this.cn,t),this.vc.forEach((e=>e.c_(t))),t.timeScale!==void 0&&this.wl.Nh(t.timeScale),t.localization!==void 0&&this.wl.wu(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.wc.m(),this.Tc=this.Pc(0),this.Rc=this.Pc(1),this.$l()}Ic(t,e){if(t==="left")return void this.Nh({leftPriceScale:e});if(t==="right")return void this.Nh({rightPriceScale:e});const i=this.zc(t);i!==null&&(i.At.Nh(e),this.wc.m())}zc(t){for(const e of this.vc){const i=e.d_(t);if(i!==null)return{Ut:e,At:i}}return null}yt(){return this.wl}Ec(){return this.vc}Lc(){return this.yc}Nc(){return this.wt}Fc(){return this.gc}Wc(t,e){t.Oo(e),this.Bu()}m_(t){this.e_=t,this.wl.m_(this.e_),this.vc.forEach((e=>e.m_(t))),this.Bu()}Cc(t){const e=new ab(this.wl,this);t!==void 0?this.vc.splice(t,0,e):this.vc.push(e);const i=t===void 0?this.vc.length-1:t,n=$t.es();return n.Nn(i,{Fn:0,Wn:!0}),this.Dc(n),e}y_(t,e,i){t.y_(e,i)}C_(t,e,i){t.C_(e,i),this.ql(),this.Dc(this.jc(t,2))}T_(t,e){t.T_(e),this.Dc(this.jc(t,2))}P_(t,e,i){e.yo()||t.P_(e,i)}R_(t,e,i){e.yo()||(t.R_(e,i),this.ql(),this.Dc(this.jc(t,2)))}D_(t,e){e.yo()||(t.D_(e),this.Dc(this.jc(t,2)))}A_(t,e){t.A_(e),this.Dc(this.jc(t,2))}Hc(t){this.wl.Uo(t)}$c(t,e){const i=this.yt();if(i.Fi()||e===0)return;const n=i.$i();t=Math.max(1,Math.min(t,n)),i.Wu(t,e),this.Bu()}Uc(t){this.qc(0),this.Yc(t),this.Xc()}Kc(t){this.wl.qo(t),this.Bu()}Zc(){this.wl.Yo(),this.Fh()}qc(t){this.wl.Xo(t)}Yc(t){this.wl.Ko(t),this.Bu()}Xc(){this.wl.Zo(),this.Fh()}Mt(){return this.mc}Gc(t,e,i,n,r){this.wt.gn(t,e);let o=NaN,l=this.wl.Au(t);const a=this.wl.Xs();a!==null&&(l=Math.min(Math.max(a.Os(),l),a.di()));const u=n.vn(),c=u.Pt();c!==null&&(o=u.pn(e,c)),o=this.kc.Ca(o,l,n),this.wt.kn(l,o,n),this.sa(),r||this.gc.m(this.wt.kt(),{x:t,y:e},i)}Jc(t,e,i){const n=i.vn(),r=n.Pt(),o=n.Ot(t,U(r)),l=this.wl.ya(e,!0),a=this.wl.Et(U(l));this.Gc(a,o,null,i,!0)}Qc(t){this.Nc().Cn(),this.sa(),t||this.gc.m(null,null,null)}ql(){const t=this.wt.Ut();if(t!==null){const e=this.wt.xn(),i=this.wt.Sn();this.Gc(e,i,null,t)}this.wt.On()}td(t,e,i){const n=this.wl.mn(0),r=this.wl.Bn();e!==void 0&&i!==void 0&&this.wl.gt(e,i);const o=this.wl.mn(0),l=this.wl.Ou(),a=this.wl.Xs();if(a!==null&&n!==null&&o!==null){const u=a.Kr(l),c=this.N_.key(n)>this.N_.key(o),d=t!==null&&t>l&&!c,f=this.wl.Bn(),p=u&&f!==r&&this.wl.W().shiftVisibleRangeOnNewBar;if(d&&!p){const v=t-l;this.wl.Jn(this.wl.zu()-v)}}this.wl.Fu(t)}Kl(t){t!==null&&t.B_()}cr(t){const e=this.vc.find((i=>i.No().includes(t)));return e===void 0?null:e}Bu(){this.yc.On(),this.vc.forEach((t=>t.B_())),this.ql()}S(){this.vc.forEach((t=>t.S())),this.vc.length=0,this.cn.localization.priceFormatter=void 0,this.cn.localization.percentageFormatter=void 0,this.cn.localization.timeFormatter=void 0}nd(){return this.Sc}mr(){return this.Sc.W()}f_(){return this.wc}sd(t,e,i){const n=this.vc[0],r=this.ed(e,t,n,i);return this.mc.push(r),this.mc.length===1?this.$l():this.Fh(),r}rd(t){const e=this.cr(t),i=this.mc.indexOf(t);ls(i!==-1,"Series not found"),this.mc.splice(i,1),U(e).jo(t),t.S&&t.S()}Hl(t,e){const i=U(this.cr(t));i.jo(t);const n=this.zc(e);if(n===null){const r=t.Zi();i.Fo(t,e,r)}else{const r=n.Ut===i?t.Zi():void 0;n.Ut.Fo(t,e,r)}}Ju(){const t=$t.ss();t.$n(),this.Dc(t)}hd(t){const e=$t.ss();e.Yn(t),this.Dc(e)}Zn(){const t=$t.ss();t.Zn(),this.Dc(t)}Gn(t){const e=$t.ss();e.Gn(t),this.Dc(e)}Jn(t){const e=$t.ss();e.Jn(t),this.Dc(e)}Xn(t){const e=$t.ss();e.Xn(t),this.Dc(e)}Un(){const t=$t.ss();t.Un(),this.Dc(t)}ld(){return this.cn.rightPriceScale.visible?"right":"left"}ad(){return this.Rc}q(){return this.Tc}It(t){const e=this.Rc,i=this.Tc;if(e===i)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Mc===null||this.Mc.Ts!==i||this.Mc.Ps!==e)this.Mc={Ts:i,Ps:e,od:new Map};else{const r=this.Mc.od.get(t);if(r!==void 0)return r}const n=(function(r,o,l){const[a,u,c,d]=mn(r),[f,p,v,g]=mn(o),_=[ue(a+l*(f-a)),ue(u+l*(p-u)),ue(c+l*(v-c)),oh(d+l*(g-d))];return`rgba(${_[0]}, ${_[1]}, ${_[2]}, ${_[3]})`})(i,e,t/100);return this.Mc.od.set(t,n),n}jc(t,e){const i=new $t(e);if(t!==null){const n=this.vc.indexOf(t);i.Nn(n,{Fn:e})}return i}Oc(t,e){return e===void 0&&(e=2),this.jc(this.cr(t),e)}Dc(t){this.xc&&this.xc(t),this.vc.forEach((e=>e.z_().Wh().gt()))}ed(t,e,i,n){const r=new Ao(this,t,e,i,n),o=t.priceScaleId!==void 0?t.priceScaleId:this.ld();return i.Fo(r,o),$n(o)||r.Nh(t),r}Pc(t){const e=this.cn.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color}}function zr(s){return!ke(s)&&!Li(s)}function Ch(s){return ke(s)}(function(s){s[s.Disabled=0]="Disabled",s[s.Continuous=1]="Continuous",s[s.OnDataUpdate=2]="OnDataUpdate"})(ra||(ra={})),(function(s){s[s.LastBar=0]="LastBar",s[s.LastVisible=1]="LastVisible"})(oa||(oa={})),(function(s){s.Solid="solid",s.VerticalGradient="gradient"})(la||(la={})),(function(s){s[s.Year=0]="Year",s[s.Month=1]="Month",s[s.DayOfMonth=2]="DayOfMonth",s[s.Time=3]="Time",s[s.TimeWithSeconds=4]="TimeWithSeconds"})(aa||(aa={}));const ua=s=>s.getUTCFullYear();function gb(s,t,e){return t.replace(/yyyy/g,(i=>Ue(ua(i),4))(s)).replace(/yy/g,(i=>Ue(ua(i)%100,2))(s)).replace(/MMMM/g,((i,n)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(n,{month:"long"}))(s,e)).replace(/MMM/g,((i,n)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(n,{month:"short"}))(s,e)).replace(/MM/g,(i=>Ue((n=>n.getUTCMonth()+1)(i),2))(s)).replace(/dd/g,(i=>Ue((n=>n.getUTCDate())(i),2))(s))}class Eh{constructor(t="yyyy-MM-dd",e="default"){this._d=t,this.ud=e}F_(t){return gb(t,this._d,this.ud)}}class bb{constructor(t){this.dd=t||"%h:%m:%s"}F_(t){return this.dd.replace("%h",Ue(t.getUTCHours(),2)).replace("%m",Ue(t.getUTCMinutes(),2)).replace("%s",Ue(t.getUTCSeconds(),2))}}const yb={fd:"yyyy-MM-dd",vd:"%h:%m:%s",pd:" ",md:"default"};class _b{constructor(t={}){const e=Object.assign(Object.assign({},yb),t);this.bd=new Eh(e.fd,e.md),this.wd=new bb(e.vd),this.gd=e.pd}F_(t){return`${this.bd.F_(t)}${this.gd}${this.wd.F_(t)}`}}function Fi(s){return 60*s*60*1e3}function ar(s){return 60*s*1e3}const Ui=[{Md:(ha=1,1e3*ha),xd:10},{Md:ar(1),xd:20},{Md:ar(5),xd:21},{Md:ar(30),xd:22},{Md:Fi(1),xd:30},{Md:Fi(3),xd:31},{Md:Fi(6),xd:32},{Md:Fi(12),xd:33}];var ha;function ca(s,t){if(s.getUTCFullYear()!==t.getUTCFullYear())return 70;if(s.getUTCMonth()!==t.getUTCMonth())return 60;if(s.getUTCDate()!==t.getUTCDate())return 50;for(let e=Ui.length-1;e>=0;--e)if(Math.floor(t.getTime()/Ui[e].Md)!==Math.floor(s.getTime()/Ui[e].Md))return Ui[e].xd;return 0}function ur(s){let t=s;if(Li(s)&&(t=Oo(s)),!zr(t))throw new Error("time must be of type BusinessDay");const e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Sd:Math.round(e.getTime()/1e3),kd:t}}function da(s){if(!Ch(s))throw new Error("time must be of type isUTCTimestamp");return{Sd:s}}function Oo(s){const t=new Date(s);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${s}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function fa(s){Li(s.time)&&(s.time=Oo(s.time))}class pa{options(){return this.cn}setOptions(t){this.cn=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?(function(e){e.forEach(fa)})(t):fa(t)}createConverterToInternalObj(t){return U((function(e){return e.length===0?null:zr(e[0].time)||Li(e[0].time)?ur:da})(t))}key(t){return typeof t=="object"&&"Sd"in t?t.Sd:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const e=t;return e.kd===void 0?new Date(1e3*e.Sd).getTime():new Date(Date.UTC(e.kd.year,e.kd.month-1,e.kd.day)).getTime()}convertHorzItemToInternal(t){return Ch(e=t)?da(e):zr(e)?ur(e):ur(Oo(e));var e}updateFormatter(t){if(!this.cn)return;const e=t.dateFormat;this.cn.timeScale.timeVisible?this.yd=new _b({fd:e,vd:this.cn.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",pd:"   ",md:t.locale}):this.yd=new Eh(e,t.locale)}formatHorzItem(t){const e=t;return this.yd.F_(new Date(1e3*e.Sd))}formatTickmark(t,e){const i=(function(r,o,l){switch(r){case 0:case 10:return o?l?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return o?3:2;case 50:return 2;case 60:return 1;case 70:return 0}})(t.weight,this.cn.timeScale.timeVisible,this.cn.timeScale.secondsVisible),n=this.cn.timeScale;if(n.tickMarkFormatter!==void 0){const r=n.tickMarkFormatter(t.originalTime,i,e.locale);if(r!==null)return r}return(function(r,o,l){const a={};switch(o){case 0:a.year="numeric";break;case 1:a.month="short";break;case 2:a.day="numeric";break;case 3:a.hour12=!1,a.hour="2-digit",a.minute="2-digit";break;case 4:a.hour12=!1,a.hour="2-digit",a.minute="2-digit",a.second="2-digit"}const u=r.kd===void 0?new Date(1e3*r.Sd):new Date(Date.UTC(r.kd.year,r.kd.month-1,r.kd.day));return new Date(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate(),u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()).toLocaleString(l,a)})(t.time,i,e.locale)}maxTickMarkWeight(t){let e=t.reduce(cb,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){(function(i,n=0){if(i.length===0)return;let r=n===0?null:i[n-1].time.Sd,o=r!==null?new Date(1e3*r):null,l=0;for(let a=n;a<i.length;++a){const u=i[a],c=new Date(1e3*u.time.Sd);o!==null&&(u.timeWeight=ca(c,o)),l+=u.time.Sd-(r||u.time.Sd),r=u.time.Sd,o=c}if(n===0&&i.length>1){const a=Math.ceil(l/(i.length-1)),u=new Date(1e3*(i[0].time.Sd-a));i[0].timeWeight=ca(new Date(1e3*i[0].time.Sd),u)}})(t,e)}static Cd(t){return be({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const qs=typeof window<"u";function ma(){return!!qs&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function hr(){return!!qs&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function qr(s){return s+s%2}function cr(s,t){return s.Td-t.Td}function dr(s,t,e){const i=(s.Td-t.Td)/(s.ut-t.ut);return Math.sign(i)*Math.min(Math.abs(i),e)}class wb{constructor(t,e,i,n){this.Pd=null,this.Rd=null,this.Dd=null,this.Od=null,this.Ad=null,this.Vd=0,this.Bd=0,this.Id=t,this.zd=e,this.Ed=i,this.rs=n}Ld(t,e){if(this.Pd!==null){if(this.Pd.ut===e)return void(this.Pd.Td=t);if(Math.abs(this.Pd.Td-t)<this.rs)return}this.Od=this.Dd,this.Dd=this.Rd,this.Rd=this.Pd,this.Pd={ut:e,Td:t}}Dr(t,e){if(this.Pd===null||this.Rd===null||e-this.Pd.ut>50)return;let i=0;const n=dr(this.Pd,this.Rd,this.zd),r=cr(this.Pd,this.Rd),o=[n],l=[r];if(i+=r,this.Dd!==null){const u=dr(this.Rd,this.Dd,this.zd);if(Math.sign(u)===Math.sign(n)){const c=cr(this.Rd,this.Dd);if(o.push(u),l.push(c),i+=c,this.Od!==null){const d=dr(this.Dd,this.Od,this.zd);if(Math.sign(d)===Math.sign(n)){const f=cr(this.Dd,this.Od);o.push(d),l.push(f),i+=f}}}}let a=0;for(let u=0;u<o.length;++u)a+=l[u]/i*o[u];Math.abs(a)<this.Id||(this.Ad={Td:t,ut:e},this.Bd=a,this.Vd=(function(u,c){const d=Math.log(c);return Math.log(1*d/-u)/d})(Math.abs(a),this.Ed))}Yu(t){const e=U(this.Ad),i=t-e.ut;return e.Td+this.Bd*(Math.pow(this.Ed,i)-1)/Math.log(this.Ed)}qu(t){return this.Ad===null||this.Nd(t)===this.Vd}Nd(t){const e=t-U(this.Ad).ut;return Math.min(e,this.Vd)}}function Ss(s,t){const e=U(s.ownerDocument).createElement("canvas");s.appendChild(e);const i=Nv(e,{options:{allowResizeObserver:!1},transform:(n,r)=>({width:Math.max(n.width,r.width),height:Math.max(n.height,r.height)})});return i.resizeCanvasElement(t),i}function Wr(s,t,e,i){s.G&&s.G(t,e,i)}function sn(s,t,e,i){s.K(t,e,i)}function Hr(s,t,e,i){const n=s(e,i);for(const r of n){const o=r.xt();o!==null&&t(o)}}function Sb(s){qs&&window.chrome!==void 0&&s.addEventListener("mousedown",(t=>{if(t.button===1)return t.preventDefault(),!1}))}class Lo{constructor(t,e,i){this.Fd=0,this.Wd=null,this.jd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY},this.Hd=0,this.$d=null,this.Ud={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY},this.qd=null,this.Yd=!1,this.Xd=null,this.Kd=null,this.Zd=!1,this.Gd=!1,this.Jd=!1,this.Qd=null,this.tf=null,this.if=null,this.nf=null,this.sf=null,this.ef=null,this.rf=null,this.hf=0,this.lf=!1,this.af=!1,this._f=!1,this.uf=0,this.cf=null,this.df=!hr(),this.ff=n=>{this.vf(n)},this.pf=n=>{if(this.mf(n)){const r=this.bf(n);if(++this.Hd,this.$d&&this.Hd>1){const{wf:o}=this.gf(Ce(n),this.Ud);o<30&&!this.Jd&&this.Mf(r,this.Sf.xf),this.kf()}}else{const r=this.bf(n);if(++this.Fd,this.Wd&&this.Fd>1){const{wf:o}=this.gf(Ce(n),this.jd);o<5&&!this.Gd&&this.yf(r,this.Sf.Cf),this.Tf()}}},this.Pf=t,this.Sf=e,this.cn=i,this.Rf()}S(){this.Qd!==null&&(this.Qd(),this.Qd=null),this.tf!==null&&(this.tf(),this.tf=null),this.nf!==null&&(this.nf(),this.nf=null),this.sf!==null&&(this.sf(),this.sf=null),this.ef!==null&&(this.ef(),this.ef=null),this.if!==null&&(this.if(),this.if=null),this.Df(),this.Tf()}Of(t){this.nf&&this.nf();const e=this.Af.bind(this);if(this.nf=()=>{this.Pf.removeEventListener("mousemove",e)},this.Pf.addEventListener("mousemove",e),this.mf(t))return;const i=this.bf(t);this.yf(i,this.Sf.Vf),this.df=!0}Tf(){this.Wd!==null&&clearTimeout(this.Wd),this.Fd=0,this.Wd=null,this.jd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY}}kf(){this.$d!==null&&clearTimeout(this.$d),this.Hd=0,this.$d=null,this.Ud={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY}}Af(t){if(this._f||this.Kd!==null||this.mf(t))return;const e=this.bf(t);this.yf(e,this.Sf.Bf),this.df=!0}If(t){const e=fr(t.changedTouches,U(this.cf));if(e===null||(this.uf=zi(t),this.rf!==null)||this.af)return;this.lf=!0;const i=this.gf(Ce(e),U(this.Kd)),{zf:n,Ef:r,wf:o}=i;if(this.Zd||!(o<5)){if(!this.Zd){const l=.5*n,a=r>=l&&!this.cn.Lf(),u=l>r&&!this.cn.Nf();a||u||(this.af=!0),this.Zd=!0,this.Jd=!0,this.Df(),this.kf()}if(!this.af){const l=this.bf(t,e);this.Mf(l,this.Sf.Ff),Es(t)}}}Wf(t){if(t.button!==0)return;const e=this.gf(Ce(t),U(this.Xd)),{wf:i}=e;if(i>=5&&(this.Gd=!0,this.Tf()),this.Gd){const n=this.bf(t);this.yf(n,this.Sf.jf)}}gf(t,e){const i=Math.abs(e.et-t.et),n=Math.abs(e.rt-t.rt);return{zf:i,Ef:n,wf:i+n}}Hf(t){let e=fr(t.changedTouches,U(this.cf));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e===null)return;this.cf=null,this.uf=zi(t),this.Df(),this.Kd=null,this.ef&&(this.ef(),this.ef=null);const i=this.bf(t,e);if(this.Mf(i,this.Sf.$f),++this.Hd,this.$d&&this.Hd>1){const{wf:n}=this.gf(Ce(e),this.Ud);n<30&&!this.Jd&&this.Mf(i,this.Sf.xf),this.kf()}else this.Jd||(this.Mf(i,this.Sf.Uf),this.Sf.Uf&&Es(t));this.Hd===0&&Es(t),t.touches.length===0&&this.Yd&&(this.Yd=!1,Es(t))}vf(t){if(t.button!==0)return;const e=this.bf(t);if(this.Xd=null,this._f=!1,this.sf&&(this.sf(),this.sf=null),ma()&&this.Pf.ownerDocument.documentElement.removeEventListener("mouseleave",this.ff),!this.mf(t))if(this.yf(e,this.Sf.qf),++this.Fd,this.Wd&&this.Fd>1){const{wf:i}=this.gf(Ce(t),this.jd);i<5&&!this.Gd&&this.yf(e,this.Sf.Cf),this.Tf()}else this.Gd||this.yf(e,this.Sf.Yf)}Df(){this.qd!==null&&(clearTimeout(this.qd),this.qd=null)}Xf(t){if(this.cf!==null)return;const e=t.changedTouches[0];this.cf=e.identifier,this.uf=zi(t);const i=this.Pf.ownerDocument.documentElement;this.Jd=!1,this.Zd=!1,this.af=!1,this.Kd=Ce(e),this.ef&&(this.ef(),this.ef=null);{const r=this.If.bind(this),o=this.Hf.bind(this);this.ef=()=>{i.removeEventListener("touchmove",r),i.removeEventListener("touchend",o)},i.addEventListener("touchmove",r,{passive:!1}),i.addEventListener("touchend",o,{passive:!1}),this.Df(),this.qd=setTimeout(this.Kf.bind(this,t),240)}const n=this.bf(t,e);this.Mf(n,this.Sf.Zf),this.$d||(this.Hd=0,this.$d=setTimeout(this.kf.bind(this),500),this.Ud=Ce(e))}Gf(t){if(t.button!==0)return;const e=this.Pf.ownerDocument.documentElement;ma()&&e.addEventListener("mouseleave",this.ff),this.Gd=!1,this.Xd=Ce(t),this.sf&&(this.sf(),this.sf=null);{const n=this.Wf.bind(this),r=this.vf.bind(this);this.sf=()=>{e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",r)},e.addEventListener("mousemove",n),e.addEventListener("mouseup",r)}if(this._f=!0,this.mf(t))return;const i=this.bf(t);this.yf(i,this.Sf.Jf),this.Wd||(this.Fd=0,this.Wd=setTimeout(this.Tf.bind(this),500),this.jd=Ce(t))}Rf(){this.Pf.addEventListener("mouseenter",this.Of.bind(this)),this.Pf.addEventListener("touchcancel",this.Df.bind(this));{const t=this.Pf.ownerDocument,e=i=>{this.Sf.Qf&&(i.composed&&this.Pf.contains(i.composedPath()[0])||i.target&&this.Pf.contains(i.target)||this.Sf.Qf())};this.tf=()=>{t.removeEventListener("touchstart",e)},this.Qd=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}hr()&&(this.if=()=>{this.Pf.removeEventListener("dblclick",this.pf)},this.Pf.addEventListener("dblclick",this.pf)),this.Pf.addEventListener("mouseleave",this.tv.bind(this)),this.Pf.addEventListener("touchstart",this.Xf.bind(this),{passive:!0}),Sb(this.Pf),this.Pf.addEventListener("mousedown",this.Gf.bind(this)),this.iv(),this.Pf.addEventListener("touchmove",(()=>{}),{passive:!1})}iv(){this.Sf.nv===void 0&&this.Sf.sv===void 0&&this.Sf.ev===void 0||(this.Pf.addEventListener("touchstart",(t=>this.rv(t.touches)),{passive:!0}),this.Pf.addEventListener("touchmove",(t=>{if(t.touches.length===2&&this.rf!==null&&this.Sf.sv!==void 0){const e=va(t.touches[0],t.touches[1])/this.hf;this.Sf.sv(this.rf,e),Es(t)}}),{passive:!1}),this.Pf.addEventListener("touchend",(t=>{this.rv(t.touches)})))}rv(t){t.length===1&&(this.lf=!1),t.length!==2||this.lf||this.Yd?this.hv():this.lv(t)}lv(t){const e=this.Pf.getBoundingClientRect()||{left:0,top:0};this.rf={et:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,rt:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.hf=va(t[0],t[1]),this.Sf.nv!==void 0&&this.Sf.nv(),this.Df()}hv(){this.rf!==null&&(this.rf=null,this.Sf.ev!==void 0&&this.Sf.ev())}tv(t){if(this.nf&&this.nf(),this.mf(t)||!this.df)return;const e=this.bf(t);this.yf(e,this.Sf.av),this.df=!hr()}Kf(t){const e=fr(t.touches,U(this.cf));if(e===null)return;const i=this.bf(t,e);this.Mf(i,this.Sf.ov),this.Jd=!0,this.Yd=!0}mf(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:zi(t)<this.uf+500}Mf(t,e){e&&e.call(this.Sf,t)}yf(t,e){e&&e.call(this.Sf,t)}bf(t,e){const i=e||t,n=this.Pf.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-n.left,localY:i.clientY-n.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,_v:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",uv:t.type,cv:i.target,dv:t.view,fv:()=>{t.type!=="touchstart"&&Es(t)}}}}function va(s,t){const e=s.clientX-t.clientX,i=s.clientY-t.clientY;return Math.sqrt(e*e+i*i)}function Es(s){s.cancelable&&s.preventDefault()}function Ce(s){return{et:s.pageX,rt:s.pageY}}function zi(s){return s.timeStamp||performance.now()}function fr(s,t){for(let e=0;e<s.length;++e)if(s[e].identifier===t)return s[e];return null}function qi(s){return{Bc:s.Bc,vv:{wr:s.pv.externalId},mv:s.pv.cursorStyle}}function xb(s,t,e){for(const i of s){const n=i.xt();if(n!==null&&n.br){const r=n.br(t,e);if(r!==null)return{dv:i,vv:r}}}return null}function pr(s,t){return e=>{var i,n,r,o;return((n=(i=e.At())===null||i===void 0?void 0:i.xa())!==null&&n!==void 0?n:"")!==t?[]:(o=(r=e.la)===null||r===void 0?void 0:r.call(e,s))!==null&&o!==void 0?o:[]}}class ga{constructor(t,e,i,n){this.Li=null,this.bv=null,this.wv=!1,this.gv=new xi(200),this.Gr=null,this.Mv=0,this.xv=!1,this.Sv=()=>{this.xv||this.nn.kv().qt().Fh()},this.yv=()=>{this.xv||this.nn.kv().qt().Fh()},this.nn=t,this.cn=e,this.mo=e.layout,this.Sc=i,this.Cv=n==="left",this.Tv=pr("normal",n),this.Pv=pr("top",n),this.Rv=pr("bottom",n),this.Dv=document.createElement("div"),this.Dv.style.height="100%",this.Dv.style.overflow="hidden",this.Dv.style.width="25px",this.Dv.style.left="0",this.Dv.style.position="relative",this.Ov=Ss(this.Dv,xt({width:16,height:16})),this.Ov.subscribeSuggestedBitmapSizeChanged(this.Sv);const r=this.Ov.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Av=Ss(this.Dv,xt({width:16,height:16})),this.Av.subscribeSuggestedBitmapSizeChanged(this.yv);const o=this.Av.canvasElement;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";const l={Jf:this.Vv.bind(this),Zf:this.Vv.bind(this),jf:this.Bv.bind(this),Ff:this.Bv.bind(this),Qf:this.Iv.bind(this),qf:this.zv.bind(this),$f:this.zv.bind(this),Cf:this.Ev.bind(this),xf:this.Ev.bind(this),Vf:this.Lv.bind(this),av:this.Nv.bind(this)};this.Fv=new Lo(this.Av.canvasElement,l,{Lf:()=>!1,Nf:()=>!0})}S(){this.Fv.S(),this.Av.unsubscribeSuggestedBitmapSizeChanged(this.yv),this.Av.dispose(),this.Ov.unsubscribeSuggestedBitmapSizeChanged(this.Sv),this.Ov.dispose(),this.Li!==null&&this.Li.$o().p(this),this.Li=null}Wv(){return this.Dv}P(){return this.mo.fontSize}jv(){const t=this.Sc.W();return this.Gr!==t.R&&(this.gv.ir(),this.Gr=t.R),t}Hv(){if(this.Li===null)return 0;let t=0;const e=this.jv(),i=U(this.Ov.canvasElement.getContext("2d"));i.save();const n=this.Li.Ea();i.font=this.$v(),n.length>0&&(t=Math.max(this.gv.Si(i,n[0].Za),this.gv.Si(i,n[n.length-1].Za)));const r=this.Uv();for(let a=r.length;a--;){const u=this.gv.Si(i,r[a].Jt());u>t&&(t=u)}const o=this.Li.Pt();if(o!==null&&this.bv!==null){const a=this.Li.pn(1,o),u=this.Li.pn(this.bv.height-2,o);t=Math.max(t,this.gv.Si(i,this.Li.Wi(Math.floor(Math.min(a,u))+.11111111111111,o)),this.gv.Si(i,this.Li.Wi(Math.ceil(Math.max(a,u))-.11111111111111,o)))}i.restore();const l=t||34;return qr(Math.ceil(e.C+e.T+e.B+e.I+5+l))}qv(t){this.bv!==null&&gs(this.bv,t)||(this.bv=t,this.xv=!0,this.Ov.resizeCanvasElement(t),this.Av.resizeCanvasElement(t),this.xv=!1,this.Dv.style.width=`${t.width}px`,this.Dv.style.height=`${t.height}px`)}Yv(){return U(this.bv).width}Ji(t){this.Li!==t&&(this.Li!==null&&this.Li.$o().p(this),this.Li=t,t.$o().l(this.ao.bind(this),this))}At(){return this.Li}ir(){const t=this.nn.Xv();this.nn.kv().qt().A_(t,U(this.At()))}Kv(t){if(this.bv===null)return;if(t!==1){this.Zv(),this.Ov.applySuggestedBitmapSize();const i=_s(this.Ov);i!==null&&(i.useBitmapCoordinateSpace((n=>{this.Gv(n),this.Be(n)})),this.nn.Jv(i,this.Rv),this.Qv(i),this.nn.Jv(i,this.Tv),this.tp(i))}this.Av.applySuggestedBitmapSize();const e=_s(this.Av);e!==null&&(e.useBitmapCoordinateSpace((({context:i,bitmapSize:n})=>{i.clearRect(0,0,n.width,n.height)})),this.ip(e),this.nn.Jv(e,this.Pv))}np(){return this.Ov.bitmapSize}sp(t,e,i){const n=this.np();n.width>0&&n.height>0&&t.drawImage(this.Ov.canvasElement,e,i)}gt(){var t;(t=this.Li)===null||t===void 0||t.Ea()}Vv(t){if(this.Li===null||this.Li.Fi()||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.nn.kv().qt(),i=this.nn.Xv();this.wv=!0,e.y_(i,this.Li,t.localY)}Bv(t){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.nn.kv().qt(),i=this.nn.Xv(),n=this.Li;e.C_(i,n,t.localY)}Iv(){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const t=this.nn.kv().qt(),e=this.nn.Xv(),i=this.Li;this.wv&&(this.wv=!1,t.T_(e,i))}zv(t){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.nn.kv().qt(),i=this.nn.Xv();this.wv=!1,e.T_(i,this.Li)}Ev(t){this.cn.handleScale.axisDoubleClickReset.price&&this.ir()}Lv(t){this.Li!==null&&(!this.nn.kv().qt().W().handleScale.axisPressedMouseMove.price||this.Li.ph()||this.Li.Co()||this.ep(1))}Nv(t){this.ep(0)}Uv(){const t=[],e=this.Li===null?void 0:this.Li;return(i=>{for(let n=0;n<i.length;++n){const r=i[n].Rn(this.nn.Xv(),e);for(let o=0;o<r.length;o++)t.push(r[o])}})(this.nn.Xv().No()),t}Gv({context:t,bitmapSize:e}){const{width:i,height:n}=e,r=this.nn.Xv().qt(),o=r.q(),l=r.ad();o===l?Rn(t,0,0,i,n,o):lh(t,0,0,i,n,o,l)}Be({context:t,bitmapSize:e,horizontalPixelRatio:i}){if(this.bv===null||this.Li===null||!this.Li.W().borderVisible)return;t.fillStyle=this.Li.W().borderColor;const n=Math.max(1,Math.floor(this.jv().C*i));let r;r=this.Cv?e.width-n:0,t.fillRect(r,0,n,e.height)}Qv(t){if(this.bv===null||this.Li===null)return;const e=this.Li.Ea(),i=this.Li.W(),n=this.jv(),r=this.Cv?this.bv.width-n.T:0;i.borderVisible&&i.ticksVisible&&t.useBitmapCoordinateSpace((({context:o,horizontalPixelRatio:l,verticalPixelRatio:a})=>{o.fillStyle=i.borderColor;const u=Math.max(1,Math.floor(a)),c=Math.floor(.5*a),d=Math.round(n.T*l);o.beginPath();for(const f of e)o.rect(Math.floor(r*l),Math.round(f.Aa*a)-c,d,u);o.fill()})),t.useMediaCoordinateSpace((({context:o})=>{var l;o.font=this.$v(),o.fillStyle=(l=i.textColor)!==null&&l!==void 0?l:this.mo.textColor,o.textAlign=this.Cv?"right":"left",o.textBaseline="middle";const a=this.Cv?Math.round(r-n.B):Math.round(r+n.T+n.B),u=e.map((c=>this.gv.xi(o,c.Za)));for(let c=e.length;c--;){const d=e[c];o.fillText(d.Za,a,d.Aa+u[c])}}))}Zv(){if(this.bv===null||this.Li===null)return;let t=this.bv.height/2;const e=[],i=this.Li.No().slice(),n=this.nn.Xv(),r=this.jv();this.Li===n.vr()&&this.nn.Xv().No().forEach((a=>{n.dr(a)&&i.push(a)}));const o=this.Li.Ta()[0],l=this.Li;i.forEach((a=>{const u=a.Rn(n,l);u.forEach((c=>{c.Vi(null),c.Bi()&&e.push(c)})),o===a&&u.length>0&&(t=u[0].yi())})),e.forEach((a=>a.Vi(a.yi()))),this.Li.W().alignLabels&&this.rp(e,r,t)}rp(t,e,i){if(this.bv===null)return;const n=t.filter((o=>o.yi()<=i)),r=t.filter((o=>o.yi()>i));n.sort(((o,l)=>l.yi()-o.yi())),n.length&&r.length&&r.push(n[0]),r.sort(((o,l)=>o.yi()-l.yi()));for(const o of t){const l=Math.floor(o.zt(e)/2),a=o.yi();a>-l&&a<l&&o.Vi(l),a>this.bv.height-l&&a<this.bv.height+l&&o.Vi(this.bv.height-l)}for(let o=1;o<n.length;o++){const l=n[o],a=n[o-1],u=a.zt(e,!1),c=l.yi(),d=a.Ai();c>d-u&&l.Vi(d-u)}for(let o=1;o<r.length;o++){const l=r[o],a=r[o-1],u=a.zt(e,!0),c=l.yi(),d=a.Ai();c<d+u&&l.Vi(d+u)}}tp(t){if(this.bv===null)return;const e=this.Uv(),i=this.jv(),n=this.Cv?"right":"left";e.forEach((r=>{r.Ii()&&r.xt(U(this.Li)).K(t,i,this.gv,n)}))}ip(t){if(this.bv===null||this.Li===null)return;const e=this.nn.kv().qt(),i=[],n=this.nn.Xv(),r=e.Nc().Rn(n,this.Li);r.length&&i.push(r);const o=this.jv(),l=this.Cv?"right":"left";i.forEach((a=>{a.forEach((u=>{u.xt(U(this.Li)).K(t,o,this.gv,l)}))}))}ep(t){this.Dv.style.cursor=t===1?"ns-resize":"default"}ao(){const t=this.Hv();this.Mv<t&&this.nn.kv().qt().$l(),this.Mv=t}$v(){return zs(this.mo.fontSize,this.mo.fontFamily)}}function Cb(s,t){var e,i;return(i=(e=s.ra)===null||e===void 0?void 0:e.call(s,t))!==null&&i!==void 0?i:[]}function Wi(s,t){var e,i;return(i=(e=s.Pn)===null||e===void 0?void 0:e.call(s,t))!==null&&i!==void 0?i:[]}function Eb(s,t){var e,i;return(i=(e=s.Qi)===null||e===void 0?void 0:e.call(s,t))!==null&&i!==void 0?i:[]}function Tb(s,t){var e,i;return(i=(e=s.na)===null||e===void 0?void 0:e.call(s,t))!==null&&i!==void 0?i:[]}class Po{constructor(t,e){this.bv=xt({width:0,height:0}),this.hp=null,this.lp=null,this.ap=null,this.op=!1,this._p=new Mt,this.up=new Mt,this.cp=0,this.dp=!1,this.fp=null,this.vp=!1,this.pp=null,this.mp=null,this.xv=!1,this.Sv=()=>{this.xv||this.bp===null||this.Ui().Fh()},this.yv=()=>{this.xv||this.bp===null||this.Ui().Fh()},this.wp=t,this.bp=e,this.bp.I_().l(this.gp.bind(this),this,!0),this.Mp=document.createElement("td"),this.Mp.style.padding="0",this.Mp.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.xp=document.createElement("td"),this.xp.style.padding="0",this.Sp=document.createElement("td"),this.Sp.style.padding="0",this.Mp.appendChild(i),this.Ov=Ss(i,xt({width:16,height:16})),this.Ov.subscribeSuggestedBitmapSizeChanged(this.Sv);const n=this.Ov.canvasElement;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Av=Ss(i,xt({width:16,height:16})),this.Av.subscribeSuggestedBitmapSizeChanged(this.yv);const r=this.Av.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.kp=document.createElement("tr"),this.kp.appendChild(this.xp),this.kp.appendChild(this.Mp),this.kp.appendChild(this.Sp),this.yp(),this.Fv=new Lo(this.Av.canvasElement,this,{Lf:()=>this.fp===null&&!this.wp.W().handleScroll.vertTouchDrag,Nf:()=>this.fp===null&&!this.wp.W().handleScroll.horzTouchDrag})}S(){this.hp!==null&&this.hp.S(),this.lp!==null&&this.lp.S(),this.Av.unsubscribeSuggestedBitmapSizeChanged(this.yv),this.Av.dispose(),this.Ov.unsubscribeSuggestedBitmapSizeChanged(this.Sv),this.Ov.dispose(),this.bp!==null&&this.bp.I_().p(this),this.Fv.S()}Xv(){return U(this.bp)}Cp(t){this.bp!==null&&this.bp.I_().p(this),this.bp=t,this.bp!==null&&this.bp.I_().l(Po.prototype.gp.bind(this),this,!0),this.yp()}kv(){return this.wp}Wv(){return this.kp}yp(){if(this.bp!==null&&(this.Tp(),this.Ui().Mt().length!==0)){if(this.hp!==null){const t=this.bp.S_();this.hp.Ji(U(t))}if(this.lp!==null){const t=this.bp.k_();this.lp.Ji(U(t))}}}Pp(){this.hp!==null&&this.hp.gt(),this.lp!==null&&this.lp.gt()}v_(){return this.bp!==null?this.bp.v_():0}p_(t){this.bp&&this.bp.p_(t)}Vf(t){if(!this.bp)return;this.Rp();const e=t.localX,i=t.localY;this.Dp(e,i,t)}Jf(t){this.Rp(),this.Op(),this.Dp(t.localX,t.localY,t)}Bf(t){var e;if(!this.bp)return;this.Rp();const i=t.localX,n=t.localY;this.Dp(i,n,t);const r=this.br(i,n);this.wp.Ap((e=r?.mv)!==null&&e!==void 0?e:null),this.Ui().Vc(r&&{Bc:r.Bc,vv:r.vv})}Yf(t){this.bp!==null&&(this.Rp(),this.Vp(t))}Cf(t){this.bp!==null&&this.Bp(this.up,t)}xf(t){this.Cf(t)}jf(t){this.Rp(),this.Ip(t),this.Dp(t.localX,t.localY,t)}qf(t){this.bp!==null&&(this.Rp(),this.dp=!1,this.zp(t))}Uf(t){this.bp!==null&&this.Vp(t)}ov(t){if(this.dp=!0,this.fp===null){const e={x:t.localX,y:t.localY};this.Ep(e,e,t)}}av(t){this.bp!==null&&(this.Rp(),this.bp.qt().Vc(null),this.Lp())}Np(){return this._p}Fp(){return this.up}nv(){this.cp=1,this.Ui().Un()}sv(t,e){if(!this.wp.W().handleScale.pinch)return;const i=5*(e-this.cp);this.cp=e,this.Ui().$c(t.et,i)}Zf(t){this.dp=!1,this.vp=this.fp!==null,this.Op();const e=this.Ui().Nc();this.fp!==null&&e.Tt()&&(this.pp={x:e.Kt(),y:e.Zt()},this.fp={x:t.localX,y:t.localY})}Ff(t){if(this.bp===null)return;const e=t.localX,i=t.localY;if(this.fp===null)this.Ip(t);else{this.vp=!1;const n=U(this.pp),r=n.x+(e-this.fp.x),o=n.y+(i-this.fp.y);this.Dp(r,o,t)}}$f(t){this.kv().W().trackingMode.exitMode===0&&(this.vp=!0),this.Wp(),this.zp(t)}br(t,e){const i=this.bp;return i===null?null:(function(n,r,o){const l=n.No(),a=(function(u,c,d){var f,p;let v,g;for(const y of u){const M=(p=(f=y.oa)===null||f===void 0?void 0:f.call(y,c,d))!==null&&p!==void 0?p:[];for(const D of M)_=D.zOrder,(!(w=v?.zOrder)||_==="top"&&w!=="top"||_==="normal"&&w==="bottom")&&(v=D,g=y)}var _,w;return v&&g?{pv:v,Bc:g}:null})(l,r,o);if(a?.pv.zOrder==="top")return qi(a);for(const u of l){if(a&&a.Bc===u&&a.pv.zOrder!=="bottom"&&!a.pv.isBackground)return qi(a);const c=xb(u.Pn(n),r,o);if(c!==null)return{Bc:u,dv:c.dv,vv:c.vv};if(a&&a.Bc===u&&a.pv.zOrder!=="bottom"&&a.pv.isBackground)return qi(a)}return a?.pv?qi(a):null})(i,t,e)}jp(t,e){U(e==="left"?this.hp:this.lp).qv(xt({width:t,height:this.bv.height}))}Hp(){return this.bv}qv(t){gs(this.bv,t)||(this.bv=t,this.xv=!0,this.Ov.resizeCanvasElement(t),this.Av.resizeCanvasElement(t),this.xv=!1,this.Mp.style.width=t.width+"px",this.Mp.style.height=t.height+"px")}$p(){const t=U(this.bp);t.x_(t.S_()),t.x_(t.k_());for(const e of t.Ta())if(t.dr(e)){const i=e.At();i!==null&&t.x_(i),e.On()}}np(){return this.Ov.bitmapSize}sp(t,e,i){const n=this.np();n.width>0&&n.height>0&&t.drawImage(this.Ov.canvasElement,e,i)}Kv(t){if(t===0||this.bp===null)return;if(t>1&&this.$p(),this.hp!==null&&this.hp.Kv(t),this.lp!==null&&this.lp.Kv(t),t!==1){this.Ov.applySuggestedBitmapSize();const i=_s(this.Ov);i!==null&&(i.useBitmapCoordinateSpace((n=>{this.Gv(n)})),this.bp&&(this.Up(i,Cb),this.qp(i),this.Yp(i),this.Up(i,Wi),this.Up(i,Eb)))}this.Av.applySuggestedBitmapSize();const e=_s(this.Av);e!==null&&(e.useBitmapCoordinateSpace((({context:i,bitmapSize:n})=>{i.clearRect(0,0,n.width,n.height)})),this.Xp(e),this.Up(e,Tb))}Kp(){return this.hp}Zp(){return this.lp}Jv(t,e){this.Up(t,e)}gp(){this.bp!==null&&this.bp.I_().p(this),this.bp=null}Vp(t){this.Bp(this._p,t)}Bp(t,e){const i=e.localX,n=e.localY;t.M()&&t.m(this.Ui().yt().Au(i),{x:i,y:n},e)}Gv({context:t,bitmapSize:e}){const{width:i,height:n}=e,r=this.Ui(),o=r.q(),l=r.ad();o===l?Rn(t,0,0,i,n,l):lh(t,0,0,i,n,o,l)}qp(t){const e=U(this.bp).z_().Wh().xt();e!==null&&e.K(t,!1)}Yp(t){const e=this.Ui().Lc();this.Gp(t,Wi,Wr,e),this.Gp(t,Wi,sn,e)}Xp(t){this.Gp(t,Wi,sn,this.Ui().Nc())}Up(t,e){const i=U(this.bp).No();for(const n of i)this.Gp(t,e,Wr,n);for(const n of i)this.Gp(t,e,sn,n)}Gp(t,e,i,n){const r=U(this.bp),o=r.qt().Ac(),l=o!==null&&o.Bc===n,a=o!==null&&l&&o.vv!==void 0?o.vv.gr:void 0;Hr(e,(u=>i(u,t,l,a)),n,r)}Tp(){if(this.bp===null)return;const t=this.wp,e=this.bp.S_().W().visible,i=this.bp.k_().W().visible;e||this.hp===null||(this.xp.removeChild(this.hp.Wv()),this.hp.S(),this.hp=null),i||this.lp===null||(this.Sp.removeChild(this.lp.Wv()),this.lp.S(),this.lp=null);const n=t.qt().nd();e&&this.hp===null&&(this.hp=new ga(this,t.W(),n,"left"),this.xp.appendChild(this.hp.Wv())),i&&this.lp===null&&(this.lp=new ga(this,t.W(),n,"right"),this.Sp.appendChild(this.lp.Wv()))}Jp(t){return t._v&&this.dp||this.fp!==null}Qp(t){return Math.max(0,Math.min(t,this.bv.width-1))}tm(t){return Math.max(0,Math.min(t,this.bv.height-1))}Dp(t,e,i){this.Ui().Gc(this.Qp(t),this.tm(e),i,U(this.bp))}Lp(){this.Ui().Qc()}Wp(){this.vp&&(this.fp=null,this.Lp())}Ep(t,e,i){this.fp=t,this.vp=!1,this.Dp(e.x,e.y,i);const n=this.Ui().Nc();this.pp={x:n.Kt(),y:n.Zt()}}Ui(){return this.wp.qt()}zp(t){if(!this.op)return;const e=this.Ui(),i=this.Xv();if(e.D_(i,i.vn()),this.ap=null,this.op=!1,e.Xc(),this.mp!==null){const n=performance.now(),r=e.yt();this.mp.Dr(r.zu(),n),this.mp.qu(n)||e.Xn(this.mp)}}Rp(){this.fp=null}Op(){if(this.bp){if(this.Ui().Un(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)U(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this.bp.vn().Fi()&&this.Ui().yt().Fi()}}Ip(t){if(this.bp===null)return;const e=this.Ui(),i=e.yt();if(i.Fi())return;const n=this.wp.W(),r=n.handleScroll,o=n.kineticScroll;if((!r.pressedMouseMove||t._v)&&(!r.horzTouchDrag&&!r.vertTouchDrag||!t._v))return;const l=this.bp.vn(),a=performance.now();if(this.ap!==null||this.Jp(t)||(this.ap={x:t.clientX,y:t.clientY,Sd:a,im:t.localX,nm:t.localY}),this.ap!==null&&!this.op&&(this.ap.x!==t.clientX||this.ap.y!==t.clientY)){if(t._v&&o.touch||!t._v&&o.mouse){const u=i.he();this.mp=new wb(.2/u,7/u,.997,15/u),this.mp.Ld(i.zu(),this.ap.Sd)}else this.mp=null;l.Fi()||e.P_(this.bp,l,t.localY),e.qc(t.localX),this.op=!0}this.op&&(l.Fi()||e.R_(this.bp,l,t.localY),e.Yc(t.localX),this.mp!==null&&this.mp.Ld(i.zu(),a))}}class ba{constructor(t,e,i,n,r){this.bt=!0,this.bv=xt({width:0,height:0}),this.Sv=()=>this.Kv(3),this.Cv=t==="left",this.Sc=i.nd,this.cn=e,this.sm=n,this.rm=r,this.Dv=document.createElement("div"),this.Dv.style.width="25px",this.Dv.style.height="100%",this.Dv.style.overflow="hidden",this.Ov=Ss(this.Dv,xt({width:16,height:16})),this.Ov.subscribeSuggestedBitmapSizeChanged(this.Sv)}S(){this.Ov.unsubscribeSuggestedBitmapSizeChanged(this.Sv),this.Ov.dispose()}Wv(){return this.Dv}Hp(){return this.bv}qv(t){gs(this.bv,t)||(this.bv=t,this.Ov.resizeCanvasElement(t),this.Dv.style.width=`${t.width}px`,this.Dv.style.height=`${t.height}px`,this.bt=!0)}Kv(t){if(t<3&&!this.bt||this.bv.width===0||this.bv.height===0)return;this.bt=!1,this.Ov.applySuggestedBitmapSize();const e=_s(this.Ov);e!==null&&e.useBitmapCoordinateSpace((i=>{this.Gv(i),this.Be(i)}))}np(){return this.Ov.bitmapSize}sp(t,e,i){const n=this.np();n.width>0&&n.height>0&&t.drawImage(this.Ov.canvasElement,e,i)}Be({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(!this.sm())return;t.fillStyle=this.cn.timeScale.borderColor;const r=Math.floor(this.Sc.W().C*i),o=Math.floor(this.Sc.W().C*n),l=this.Cv?e.width-r:0;t.fillRect(l,0,r,o)}Gv({context:t,bitmapSize:e}){Rn(t,0,0,e.width,e.height,this.rm())}}function Ro(s){return t=>{var e,i;return(i=(e=t.aa)===null||e===void 0?void 0:e.call(t,s))!==null&&i!==void 0?i:[]}}const kb=Ro("normal"),Mb=Ro("top"),Ab=Ro("bottom");class Ob{constructor(t,e){this.hm=null,this.lm=null,this.k=null,this.am=!1,this.bv=xt({width:0,height:0}),this.om=new Mt,this.gv=new xi(5),this.xv=!1,this.Sv=()=>{this.xv||this.wp.qt().Fh()},this.yv=()=>{this.xv||this.wp.qt().Fh()},this.wp=t,this.N_=e,this.cn=t.W().layout,this._m=document.createElement("tr"),this.um=document.createElement("td"),this.um.style.padding="0",this.dm=document.createElement("td"),this.dm.style.padding="0",this.Dv=document.createElement("td"),this.Dv.style.height="25px",this.Dv.style.padding="0",this.fm=document.createElement("div"),this.fm.style.width="100%",this.fm.style.height="100%",this.fm.style.position="relative",this.fm.style.overflow="hidden",this.Dv.appendChild(this.fm),this.Ov=Ss(this.fm,xt({width:16,height:16})),this.Ov.subscribeSuggestedBitmapSizeChanged(this.Sv);const i=this.Ov.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Av=Ss(this.fm,xt({width:16,height:16})),this.Av.subscribeSuggestedBitmapSizeChanged(this.yv);const n=this.Av.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this._m.appendChild(this.um),this._m.appendChild(this.Dv),this._m.appendChild(this.dm),this.vm(),this.wp.qt().f_().l(this.vm.bind(this),this),this.Fv=new Lo(this.Av.canvasElement,this,{Lf:()=>!0,Nf:()=>!1})}S(){this.Fv.S(),this.hm!==null&&this.hm.S(),this.lm!==null&&this.lm.S(),this.Av.unsubscribeSuggestedBitmapSizeChanged(this.yv),this.Av.dispose(),this.Ov.unsubscribeSuggestedBitmapSizeChanged(this.Sv),this.Ov.dispose()}Wv(){return this._m}pm(){return this.hm}bm(){return this.lm}Jf(t){if(this.am)return;this.am=!0;const e=this.wp.qt();!e.yt().Fi()&&this.wp.W().handleScale.axisPressedMouseMove.time&&e.Hc(t.localX)}Zf(t){this.Jf(t)}Qf(){const t=this.wp.qt();!t.yt().Fi()&&this.am&&(this.am=!1,this.wp.W().handleScale.axisPressedMouseMove.time&&t.Zc())}jf(t){const e=this.wp.qt();!e.yt().Fi()&&this.wp.W().handleScale.axisPressedMouseMove.time&&e.Kc(t.localX)}Ff(t){this.jf(t)}qf(){this.am=!1;const t=this.wp.qt();t.yt().Fi()&&!this.wp.W().handleScale.axisPressedMouseMove.time||t.Zc()}$f(){this.qf()}Cf(){this.wp.W().handleScale.axisDoubleClickReset.time&&this.wp.qt().Zn()}xf(){this.Cf()}Vf(){this.wp.qt().W().handleScale.axisPressedMouseMove.time&&this.ep(1)}av(){this.ep(0)}Hp(){return this.bv}wm(){return this.om}gm(t,e,i){gs(this.bv,t)||(this.bv=t,this.xv=!0,this.Ov.resizeCanvasElement(t),this.Av.resizeCanvasElement(t),this.xv=!1,this.Dv.style.width=`${t.width}px`,this.Dv.style.height=`${t.height}px`,this.om.m(t)),this.hm!==null&&this.hm.qv(xt({width:e,height:t.height})),this.lm!==null&&this.lm.qv(xt({width:i,height:t.height}))}Mm(){const t=this.xm();return Math.ceil(t.C+t.T+t.P+t.L+t.V+t.Sm)}gt(){this.wp.qt().yt().Ea()}np(){return this.Ov.bitmapSize}sp(t,e,i){const n=this.np();n.width>0&&n.height>0&&t.drawImage(this.Ov.canvasElement,e,i)}Kv(t){if(t===0)return;if(t!==1){this.Ov.applySuggestedBitmapSize();const i=_s(this.Ov);i!==null&&(i.useBitmapCoordinateSpace((n=>{this.Gv(n),this.Be(n),this.km(i,Ab)})),this.Qv(i),this.km(i,kb)),this.hm!==null&&this.hm.Kv(t),this.lm!==null&&this.lm.Kv(t)}this.Av.applySuggestedBitmapSize();const e=_s(this.Av);e!==null&&(e.useBitmapCoordinateSpace((({context:i,bitmapSize:n})=>{i.clearRect(0,0,n.width,n.height)})),this.ym([...this.wp.qt().Mt(),this.wp.qt().Nc()],e),this.km(e,Mb))}km(t,e){const i=this.wp.qt().Mt();for(const n of i)Hr(e,(r=>Wr(r,t,!1,void 0)),n,void 0);for(const n of i)Hr(e,(r=>sn(r,t,!1,void 0)),n,void 0)}Gv({context:t,bitmapSize:e}){Rn(t,0,0,e.width,e.height,this.wp.qt().ad())}Be({context:t,bitmapSize:e,verticalPixelRatio:i}){if(this.wp.W().timeScale.borderVisible){t.fillStyle=this.Cm();const n=Math.max(1,Math.floor(this.xm().C*i));t.fillRect(0,0,e.width,n)}}Qv(t){const e=this.wp.qt().yt(),i=e.Ea();if(!i||i.length===0)return;const n=this.N_.maxTickMarkWeight(i),r=this.xm(),o=e.W();o.borderVisible&&o.ticksVisible&&t.useBitmapCoordinateSpace((({context:l,horizontalPixelRatio:a,verticalPixelRatio:u})=>{l.strokeStyle=this.Cm(),l.fillStyle=this.Cm();const c=Math.max(1,Math.floor(a)),d=Math.floor(.5*a);l.beginPath();const f=Math.round(r.T*u);for(let p=i.length;p--;){const v=Math.round(i[p].coord*a);l.rect(v-d,0,c,f)}l.fill()})),t.useMediaCoordinateSpace((({context:l})=>{const a=r.C+r.T+r.L+r.P/2;l.textAlign="center",l.textBaseline="middle",l.fillStyle=this.$(),l.font=this.$v();for(const u of i)if(u.weight<n){const c=u.needAlignCoordinate?this.Tm(l,u.coord,u.label):u.coord;l.fillText(u.label,c,a)}l.font=this.Pm();for(const u of i)if(u.weight>=n){const c=u.needAlignCoordinate?this.Tm(l,u.coord,u.label):u.coord;l.fillText(u.label,c,a)}}))}Tm(t,e,i){const n=this.gv.Si(t,i),r=n/2,o=Math.floor(e-r)+.5;return o<0?e+=Math.abs(0-o):o+n>this.bv.width&&(e-=Math.abs(this.bv.width-(o+n))),e}ym(t,e){const i=this.xm();for(const n of t)for(const r of n.tn())r.xt().K(e,i)}Cm(){return this.wp.W().timeScale.borderColor}$(){return this.cn.textColor}j(){return this.cn.fontSize}$v(){return zs(this.j(),this.cn.fontFamily)}Pm(){return zs(this.j(),this.cn.fontFamily,"bold")}xm(){this.k===null&&(this.k={C:1,N:NaN,L:NaN,V:NaN,Hi:NaN,T:5,P:NaN,R:"",ji:new xi,Sm:0});const t=this.k,e=this.$v();if(t.R!==e){const i=this.j();t.P=i,t.R=e,t.L=3*i/12,t.V=3*i/12,t.Hi=9*i/12,t.N=0,t.Sm=4*i/12,t.ji.ir()}return this.k}ep(t){this.Dv.style.cursor=t===1?"ew-resize":"default"}vm(){const t=this.wp.qt(),e=t.W();e.leftPriceScale.visible||this.hm===null||(this.um.removeChild(this.hm.Wv()),this.hm.S(),this.hm=null),e.rightPriceScale.visible||this.lm===null||(this.dm.removeChild(this.lm.Wv()),this.lm.S(),this.lm=null);const i={nd:this.wp.qt().nd()},n=()=>e.leftPriceScale.borderVisible&&t.yt().W().borderVisible,r=()=>t.ad();e.leftPriceScale.visible&&this.hm===null&&(this.hm=new ba("left",e,i,n,r),this.um.appendChild(this.hm.Wv())),e.rightPriceScale.visible&&this.lm===null&&(this.lm=new ba("right",e,i,n,r),this.dm.appendChild(this.lm.Wv()))}}const Lb=!!qs&&!!navigator.userAgentData&&navigator.userAgentData.brands.some((s=>s.brand.includes("Chromium")))&&!!qs&&(!((mr=navigator?.userAgentData)===null||mr===void 0)&&mr.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);var mr;class Pb{constructor(t,e,i){var n;this.Rm=[],this.Dm=0,this.Qa=0,this.e_=0,this.Om=0,this.Am=0,this.Vm=null,this.Bm=!1,this._p=new Mt,this.up=new Mt,this.gc=new Mt,this.Im=null,this.zm=null,this.Em=t,this.cn=e,this.N_=i,this._m=document.createElement("div"),this._m.classList.add("tv-lightweight-charts"),this._m.style.overflow="hidden",this._m.style.direction="ltr",this._m.style.width="100%",this._m.style.height="100%",(n=this._m).style.userSelect="none",n.style.webkitUserSelect="none",n.style.msUserSelect="none",n.style.MozUserSelect="none",n.style.webkitTapHighlightColor="transparent",this.Lm=document.createElement("table"),this.Lm.setAttribute("cellspacing","0"),this._m.appendChild(this.Lm),this.Nm=this.Fm.bind(this),vr(this.cn)&&this.Wm(!0),this.Ui=new vb(this.xc.bind(this),this.cn,i),this.qt().Fc().l(this.jm.bind(this),this),this.Hm=new Ob(this,this.N_),this.Lm.appendChild(this.Hm.Wv());const r=e.autoSize&&this.$m();let o=this.cn.width,l=this.cn.height;if(r||o===0||l===0){const a=t.getBoundingClientRect();o=o||a.width,l=l||a.height}this.Um(o,l),this.qm(),t.appendChild(this._m),this.Ym(),this.Ui.yt().Zu().l(this.Ui.$l.bind(this.Ui),this),this.Ui.f_().l(this.Ui.$l.bind(this.Ui),this)}qt(){return this.Ui}W(){return this.cn}Xm(){return this.Rm}Km(){return this.Hm}S(){this.Wm(!1),this.Dm!==0&&window.cancelAnimationFrame(this.Dm),this.Ui.Fc().p(this),this.Ui.yt().Zu().p(this),this.Ui.f_().p(this),this.Ui.S();for(const t of this.Rm)this.Lm.removeChild(t.Wv()),t.Np().p(this),t.Fp().p(this),t.S();this.Rm=[],U(this.Hm).S(),this._m.parentElement!==null&&this._m.parentElement.removeChild(this._m),this.gc.S(),this._p.S(),this.up.S(),this.Zm()}Um(t,e,i=!1){if(this.Qa===e&&this.e_===t)return;const n=(function(l){const a=Math.floor(l.width),u=Math.floor(l.height);return xt({width:a-a%2,height:u-u%2})})(xt({width:t,height:e}));this.Qa=n.height,this.e_=n.width;const r=this.Qa+"px",o=this.e_+"px";U(this._m).style.height=r,U(this._m).style.width=o,this.Lm.style.height=r,this.Lm.style.width=o,i?this.Gm($t.es(),performance.now()):this.Ui.$l()}Kv(t){t===void 0&&(t=$t.es());for(let e=0;e<this.Rm.length;e++)this.Rm[e].Kv(t.Hn(e).Fn);this.cn.timeScale.visible&&this.Hm.Kv(t.jn())}Nh(t){const e=vr(this.cn);this.Ui.Nh(t);const i=vr(this.cn);i!==e&&this.Wm(i),this.Ym(),this.Jm(t)}Np(){return this._p}Fp(){return this.up}Fc(){return this.gc}Qm(){this.Vm!==null&&(this.Gm(this.Vm,performance.now()),this.Vm=null);const t=this.tb(null),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=U(e.getContext("2d"));return this.tb(i),e}ib(t){return t==="left"&&!this.nb()||t==="right"&&!this.sb()||this.Rm.length===0?0:U(t==="left"?this.Rm[0].Kp():this.Rm[0].Zp()).Yv()}eb(){return this.cn.autoSize&&this.Im!==null}rb(){return this._m}Ap(t){this.zm=t,this.zm?this.rb().style.setProperty("cursor",t):this.rb().style.removeProperty("cursor")}hb(){return this.zm}lb(){return Yt(this.Rm[0]).Hp()}Jm(t){(t.autoSize!==void 0||!this.Im||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.Im&&this.$m(),t.autoSize===!1&&this.Im!==null&&this.Zm(),t.autoSize||t.width===void 0&&t.height===void 0||this.Um(t.width||this.e_,t.height||this.Qa))}tb(t){let e=0,i=0;const n=this.Rm[0],r=(l,a)=>{let u=0;for(let c=0;c<this.Rm.length;c++){const d=this.Rm[c],f=U(l==="left"?d.Kp():d.Zp()),p=f.np();t!==null&&f.sp(t,a,u),u+=p.height}};this.nb()&&(r("left",0),e+=U(n.Kp()).np().width);for(let l=0;l<this.Rm.length;l++){const a=this.Rm[l],u=a.np();t!==null&&a.sp(t,e,i),i+=u.height}e+=n.np().width,this.sb()&&(r("right",e),e+=U(n.Zp()).np().width);const o=(l,a,u)=>{U(l==="left"?this.Hm.pm():this.Hm.bm()).sp(U(t),a,u)};if(this.cn.timeScale.visible){const l=this.Hm.np();if(t!==null){let a=0;this.nb()&&(o("left",a,i),a=U(n.Kp()).np().width),this.Hm.sp(t,a,i),a+=l.width,this.sb()&&o("right",a,i)}i+=l.height}return xt({width:e,height:i})}ab(){let t=0,e=0,i=0;for(const v of this.Rm)this.nb()&&(e=Math.max(e,U(v.Kp()).Hv(),this.cn.leftPriceScale.minimumWidth)),this.sb()&&(i=Math.max(i,U(v.Zp()).Hv(),this.cn.rightPriceScale.minimumWidth)),t+=v.v_();e=qr(e),i=qr(i);const n=this.e_,r=this.Qa,o=Math.max(n-e-i,0),l=this.cn.timeScale.visible;let a=l?Math.max(this.Hm.Mm(),this.cn.timeScale.minimumHeight):0;var u;a=(u=a)+u%2;const c=0+a,d=r<c?0:r-c,f=d/t;let p=0;for(let v=0;v<this.Rm.length;++v){const g=this.Rm[v];g.Cp(this.Ui.Ec()[v]);let _=0,w=0;w=v===this.Rm.length-1?d-p:Math.round(g.v_()*f),_=Math.max(w,2),p+=_,g.qv(xt({width:o,height:_})),this.nb()&&g.jp(e,"left"),this.sb()&&g.jp(i,"right"),g.Xv()&&this.Ui.Wc(g.Xv(),_)}this.Hm.gm(xt({width:l?o:0,height:a}),l?e:0,l?i:0),this.Ui.m_(o),this.Om!==e&&(this.Om=e),this.Am!==i&&(this.Am=i)}Wm(t){t?this._m.addEventListener("wheel",this.Nm,{passive:!1}):this._m.removeEventListener("wheel",this.Nm)}ob(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return Lb?1/window.devicePixelRatio:1}Fm(t){if(!(t.deltaX!==0&&this.cn.handleScroll.mouseWheel||t.deltaY!==0&&this.cn.handleScale.mouseWheel))return;const e=this.ob(t),i=e*t.deltaX/100,n=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),n!==0&&this.cn.handleScale.mouseWheel){const r=Math.sign(n)*Math.min(1,Math.abs(n)),o=t.clientX-this._m.getBoundingClientRect().left;this.qt().$c(o,r)}i!==0&&this.cn.handleScroll.mouseWheel&&this.qt().Uc(-80*i)}Gm(t,e){var i;const n=t.jn();n===3&&this._b(),n!==3&&n!==2||(this.ub(t),this.cb(t,e),this.Hm.gt(),this.Rm.forEach((r=>{r.Pp()})),((i=this.Vm)===null||i===void 0?void 0:i.jn())===3&&(this.Vm.ts(t),this._b(),this.ub(this.Vm),this.cb(this.Vm,e),t=this.Vm,this.Vm=null)),this.Kv(t)}cb(t,e){for(const i of t.Qn())this.ns(i,e)}ub(t){const e=this.Ui.Ec();for(let i=0;i<e.length;i++)t.Hn(i).Wn&&e[i].V_()}ns(t,e){const i=this.Ui.yt();switch(t.qn){case 0:i.Ju();break;case 1:i.Qu(t.Vt);break;case 2:i.Gn(t.Vt);break;case 3:i.Jn(t.Vt);break;case 4:i.Nu();break;case 5:t.Vt.qu(e)||i.Jn(t.Vt.Yu(e))}}xc(t){this.Vm!==null?this.Vm.ts(t):this.Vm=t,this.Bm||(this.Bm=!0,this.Dm=window.requestAnimationFrame((e=>{if(this.Bm=!1,this.Dm=0,this.Vm!==null){const i=this.Vm;this.Vm=null,this.Gm(i,e);for(const n of i.Qn())if(n.qn===5&&!n.Vt.qu(e)){this.qt().Xn(n.Vt);break}}})))}_b(){this.qm()}qm(){const t=this.Ui.Ec(),e=t.length,i=this.Rm.length;for(let n=e;n<i;n++){const r=Yt(this.Rm.pop());this.Lm.removeChild(r.Wv()),r.Np().p(this),r.Fp().p(this),r.S()}for(let n=i;n<e;n++){const r=new Po(this,t[n]);r.Np().l(this.fb.bind(this),this),r.Fp().l(this.vb.bind(this),this),this.Rm.push(r),this.Lm.insertBefore(r.Wv(),this.Hm.Wv())}for(let n=0;n<e;n++){const r=t[n],o=this.Rm[n];o.Xv()!==r?o.Cp(r):o.yp()}this.Ym(),this.ab()}pb(t,e,i){var n;const r=new Map;t!==null&&this.Ui.Mt().forEach((c=>{const d=c.In().nl(t);d!==null&&r.set(c,d)}));let o;if(t!==null){const c=(n=this.Ui.yt().qi(t))===null||n===void 0?void 0:n.originalTime;c!==void 0&&(o=c)}const l=this.qt().Ac(),a=l!==null&&l.Bc instanceof Ao?l.Bc:void 0,u=l!==null&&l.vv!==void 0?l.vv.wr:void 0;return{mb:o,se:t??void 0,bb:e??void 0,wb:a,gb:r,Mb:u,xb:i??void 0}}fb(t,e,i){this._p.m((()=>this.pb(t,e,i)))}vb(t,e,i){this.up.m((()=>this.pb(t,e,i)))}jm(t,e,i){this.gc.m((()=>this.pb(t,e,i)))}Ym(){const t=this.cn.timeScale.visible?"":"none";this.Hm.Wv().style.display=t}nb(){return this.Rm[0].Xv().S_().W().visible}sb(){return this.Rm[0].Xv().k_().W().visible}$m(){return"ResizeObserver"in window&&(this.Im=new ResizeObserver((t=>{const e=t.find((i=>i.target===this.Em));e&&this.Um(e.contentRect.width,e.contentRect.height)})),this.Im.observe(this.Em,{box:"border-box"}),!0)}Zm(){this.Im!==null&&this.Im.disconnect(),this.Im=null}}function vr(s){return!!(s.handleScroll.mouseWheel||s.handleScale.mouseWheel)}function Th(s,t){var e={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&t.indexOf(i)<0&&(e[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(i=Object.getOwnPropertySymbols(s);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(s,i[n])&&(e[i[n]]=s[i[n]])}return e}function ya(s,t,e,i){const n=e.value,r={se:t,ut:s,Vt:[n,n,n,n],mb:i};return e.color!==void 0&&(r.O=e.color),r}function Rb(s,t,e,i){const n=e.value,r={se:t,ut:s,Vt:[n,n,n,n],mb:i};return e.lineColor!==void 0&&(r._t=e.lineColor),e.topColor!==void 0&&(r.Ts=e.topColor),e.bottomColor!==void 0&&(r.Ps=e.bottomColor),r}function Nb(s,t,e,i){const n=e.value,r={se:t,ut:s,Vt:[n,n,n,n],mb:i};return e.topLineColor!==void 0&&(r.Pe=e.topLineColor),e.bottomLineColor!==void 0&&(r.Re=e.bottomLineColor),e.topFillColor1!==void 0&&(r.Se=e.topFillColor1),e.topFillColor2!==void 0&&(r.ke=e.topFillColor2),e.bottomFillColor1!==void 0&&(r.ye=e.bottomFillColor1),e.bottomFillColor2!==void 0&&(r.Ce=e.bottomFillColor2),r}function $b(s,t,e,i){const n={se:t,ut:s,Vt:[e.open,e.high,e.low,e.close],mb:i};return e.color!==void 0&&(n.O=e.color),n}function Db(s,t,e,i){const n={se:t,ut:s,Vt:[e.open,e.high,e.low,e.close],mb:i};return e.color!==void 0&&(n.O=e.color),e.borderColor!==void 0&&(n.Bt=e.borderColor),e.wickColor!==void 0&&(n.$h=e.wickColor),n}function Ib(s,t,e,i,n){const r=Yt(n)(e),o=Math.max(...r),l=Math.min(...r),a=r[r.length-1],u=[a,o,l,a],c=e,{time:d,color:f}=c;return{se:t,ut:s,Vt:u,mb:i,He:Th(c,["time","color"]),O:f}}function Hi(s){return s.Vt!==void 0}function _a(s,t){return t.customValues!==void 0&&(s.Sb=t.customValues),s}function cs(s){return(t,e,i,n,r,o)=>(function(l,a){return a?a(l):(u=l).open===void 0&&u.value===void 0;var u})(i,o)?_a({ut:t,se:e,mb:n},i):_a(s(t,e,i,n,r),i)}function wa(s){return{Candlestick:cs(Db),Bar:cs($b),Area:cs(Rb),Baseline:cs(Nb),Histogram:cs(ya),Line:cs(ya),Custom:cs(Ib)}[s]}function Sa(s){return{se:0,kb:new Map,ia:s}}function xa(s,t){if(s!==void 0&&s.length!==0)return{yb:t.key(s[0].ut),Cb:t.key(s[s.length-1].ut)}}function Ca(s){let t;return s.forEach((e=>{t===void 0&&(t=e.mb)})),Yt(t)}class Bb{constructor(t){this.Tb=new Map,this.Pb=new Map,this.Rb=new Map,this.Db=[],this.N_=t}S(){this.Tb.clear(),this.Pb.clear(),this.Rb.clear(),this.Db=[]}Ob(t,e){let i=this.Tb.size!==0,n=!1;const r=this.Pb.get(t);if(r!==void 0)if(this.Pb.size===1)i=!1,n=!0,this.Tb.clear();else for(const a of this.Db)a.pointData.kb.delete(t)&&(n=!0);let o=[];if(e.length!==0){const a=e.map((p=>p.time)),u=this.N_.createConverterToInternalObj(e),c=wa(t.Xh()),d=t.ga(),f=t.Ma();o=e.map(((p,v)=>{const g=u(p.time),_=this.N_.key(g);let w=this.Tb.get(_);w===void 0&&(w=Sa(g),this.Tb.set(_,w),n=!0);const y=c(g,w.se,p,a[v],d,f);return w.kb.set(t,y),y}))}i&&this.Ab(),this.Vb(t,o);let l=-1;if(n){const a=[];this.Tb.forEach((u=>{a.push({timeWeight:0,time:u.ia,pointData:u,originalTime:Ca(u.kb)})})),a.sort(((u,c)=>this.N_.key(u.time)-this.N_.key(c.time))),l=this.Bb(a)}return this.Ib(t,l,(function(a,u,c){const d=xa(a,c),f=xa(u,c);if(d!==void 0&&f!==void 0)return{Xl:d.Cb>=f.Cb&&d.yb>=f.yb}})(this.Pb.get(t),r,this.N_))}rd(t){return this.Ob(t,[])}zb(t,e){const i=e;(function(g){g.mb===void 0&&(g.mb=g.time)})(i),this.N_.preprocessData(e);const n=this.N_.createConverterToInternalObj([e])(e.time),r=this.Rb.get(t);if(r!==void 0&&this.N_.key(n)<this.N_.key(r))throw new Error(`Cannot update oldest data, last time=${r}, new time=${n}`);let o=this.Tb.get(this.N_.key(n));const l=o===void 0;o===void 0&&(o=Sa(n),this.Tb.set(this.N_.key(n),o));const a=wa(t.Xh()),u=t.ga(),c=t.Ma(),d=a(n,o.se,e,i.mb,u,c);o.kb.set(t,d),this.Eb(t,d);const f={Xl:Hi(d)};if(!l)return this.Ib(t,-1,f);const p={timeWeight:0,time:o.ia,pointData:o,originalTime:Ca(o.kb)},v=Pi(this.Db,this.N_.key(p.time),((g,_)=>this.N_.key(g.time)<_));this.Db.splice(v,0,p);for(let g=v;g<this.Db.length;++g)gr(this.Db[g].pointData,g);return this.N_.fillWeightsForPoints(this.Db,v),this.Ib(t,v,f)}Eb(t,e){let i=this.Pb.get(t);i===void 0&&(i=[],this.Pb.set(t,i));const n=i.length!==0?i[i.length-1]:null;n===null||this.N_.key(e.ut)>this.N_.key(n.ut)?Hi(e)&&i.push(e):Hi(e)?i[i.length-1]=e:i.splice(-1,1),this.Rb.set(t,e.ut)}Vb(t,e){e.length!==0?(this.Pb.set(t,e.filter(Hi)),this.Rb.set(t,e[e.length-1].ut)):(this.Pb.delete(t),this.Rb.delete(t))}Ab(){for(const t of this.Db)t.pointData.kb.size===0&&this.Tb.delete(this.N_.key(t.time))}Bb(t){let e=-1;for(let i=0;i<this.Db.length&&i<t.length;++i){const n=this.Db[i],r=t[i];if(this.N_.key(n.time)!==this.N_.key(r.time)){e=i;break}r.timeWeight=n.timeWeight,gr(r.pointData,i)}if(e===-1&&this.Db.length!==t.length&&(e=Math.min(this.Db.length,t.length)),e===-1)return-1;for(let i=e;i<t.length;++i)gr(t[i].pointData,i);return this.N_.fillWeightsForPoints(t,e),this.Db=t,e}Lb(){if(this.Pb.size===0)return null;let t=0;return this.Pb.forEach((e=>{e.length!==0&&(t=Math.max(t,e[e.length-1].se))})),t}Ib(t,e,i){const n={Nb:new Map,yt:{Ou:this.Lb()}};if(e!==-1)this.Pb.forEach(((r,o)=>{n.Nb.set(o,{He:r,Fb:o===t?i:void 0})})),this.Pb.has(t)||n.Nb.set(t,{He:[],Fb:i}),n.yt.Wb=this.Db,n.yt.jb=e;else{const r=this.Pb.get(t);n.Nb.set(t,{He:r||[],Fb:i})}return n}}function gr(s,t){s.se=t,s.kb.forEach((e=>{e.se=t}))}function No(s){const t={value:s.Vt[3],time:s.mb};return s.Sb!==void 0&&(t.customValues=s.Sb),t}function Ea(s){const t=No(s);return s.O!==void 0&&(t.color=s.O),t}function Vb(s){const t=No(s);return s._t!==void 0&&(t.lineColor=s._t),s.Ts!==void 0&&(t.topColor=s.Ts),s.Ps!==void 0&&(t.bottomColor=s.Ps),t}function Fb(s){const t=No(s);return s.Pe!==void 0&&(t.topLineColor=s.Pe),s.Re!==void 0&&(t.bottomLineColor=s.Re),s.Se!==void 0&&(t.topFillColor1=s.Se),s.ke!==void 0&&(t.topFillColor2=s.ke),s.ye!==void 0&&(t.bottomFillColor1=s.ye),s.Ce!==void 0&&(t.bottomFillColor2=s.Ce),t}function kh(s){const t={open:s.Vt[0],high:s.Vt[1],low:s.Vt[2],close:s.Vt[3],time:s.mb};return s.Sb!==void 0&&(t.customValues=s.Sb),t}function Ub(s){const t=kh(s);return s.O!==void 0&&(t.color=s.O),t}function zb(s){const t=kh(s),{O:e,Bt:i,$h:n}=s;return e!==void 0&&(t.color=e),i!==void 0&&(t.borderColor=i),n!==void 0&&(t.wickColor=n),t}function Kr(s){return{Area:Vb,Line:Ea,Baseline:Fb,Histogram:Ea,Bar:Ub,Candlestick:zb,Custom:qb}[s]}function qb(s){const t=s.mb;return Object.assign(Object.assign({},s.He),{time:t})}const Wb={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},Hb={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},Kb={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:So},br={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},jb={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0},Gb={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:So,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};function Ta(){return{width:0,height:0,autoSize:!1,layout:Kb,crosshair:Wb,grid:Hb,overlayPriceScales:Object.assign({},br),leftPriceScale:Object.assign(Object.assign({},br),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},br),{visible:!0}),timeScale:jb,watermark:Gb,localization:{locale:qs?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class Jb{constructor(t,e){this.Hb=t,this.$b=e}applyOptions(t){this.Hb.qt().Ic(this.$b,t)}options(){return this.Li().W()}width(){return $n(this.$b)?this.Hb.ib(this.$b):0}Li(){return U(this.Hb.qt().zc(this.$b)).At}}function ka(s,t,e){const i=Th(s,["time","originalTime"]),n=Object.assign({time:t},i);return e!==void 0&&(n.originalTime=e),n}const Xb={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class Yb{constructor(t){this.Bh=t}applyOptions(t){this.Bh.Nh(t)}options(){return this.Bh.W()}Ub(){return this.Bh}}class Qb{constructor(t,e,i,n,r){this.qb=new Mt,this.Es=t,this.Yb=e,this.Xb=i,this.N_=r,this.Kb=n}S(){this.qb.S()}priceFormatter(){return this.Es.ca()}priceToCoordinate(t){const e=this.Es.Pt();return e===null?null:this.Es.At().Ot(t,e.Vt)}coordinateToPrice(t){const e=this.Es.Pt();return e===null?null:this.Es.At().pn(t,e.Vt)}barsInLogicalRange(t){if(t===null)return null;const e=new $s(new di(t.from,t.to)).iu(),i=this.Es.In();if(i.Fi())return null;const n=i.nl(e.Os(),1),r=i.nl(e.di(),-1),o=U(i.Qh()),l=U(i.Bn());if(n!==null&&r!==null&&n.se>r.se)return{barsBefore:t.from-o,barsAfter:l-t.to};const a={barsBefore:n===null||n.se===o?t.from-o:n.se-o,barsAfter:r===null||r.se===l?l-t.to:l-r.se};return n!==null&&r!==null&&(a.from=n.mb,a.to=r.mb),a}setData(t){this.N_,this.Es.Xh(),this.Yb.Zb(this.Es,t),this.Gb("full")}update(t){this.Es.Xh(),this.Yb.Jb(this.Es,t),this.Gb("update")}dataByIndex(t,e){const i=this.Es.In().nl(t,e);return i===null?null:Kr(this.seriesType())(i)}data(){const t=Kr(this.seriesType());return this.Es.In().ie().map((e=>t(e)))}subscribeDataChanged(t){this.qb.l(t)}unsubscribeDataChanged(t){this.qb.v(t)}setMarkers(t){this.N_;const e=t.map((i=>ka(i,this.N_.convertHorzItemToInternal(i.time),i.time)));this.Es.Zl(e)}markers(){return this.Es.Gl().map((t=>ka(t,t.originalTime,void 0)))}applyOptions(t){this.Es.Nh(t)}options(){return Fe(this.Es.W())}priceScale(){return this.Xb.priceScale(this.Es.At().xa())}createPriceLine(t){const e=be(Fe(Xb),t),i=this.Es.Jl(e);return new Yb(i)}removePriceLine(t){this.Es.Ql(t.Ub())}seriesType(){return this.Es.Xh()}attachPrimitive(t){this.Es.ba(t),t.attached&&t.attached({chart:this.Kb,series:this,requestUpdate:()=>this.Es.qt().$l()})}detachPrimitive(t){this.Es.wa(t),t.detached&&t.detached()}Gb(t){this.qb.M()&&this.qb.m(t)}}class Zb{constructor(t,e,i){this.Qb=new Mt,this.uu=new Mt,this.om=new Mt,this.Ui=t,this.wl=t.yt(),this.Hm=e,this.wl.Xu().l(this.tw.bind(this)),this.wl.Ku().l(this.iw.bind(this)),this.Hm.wm().l(this.nw.bind(this)),this.N_=i}S(){this.wl.Xu().p(this),this.wl.Ku().p(this),this.Hm.wm().p(this),this.Qb.S(),this.uu.S(),this.om.S()}scrollPosition(){return this.wl.zu()}scrollToPosition(t,e){e?this.wl.Uu(t,1e3):this.Ui.Jn(t)}scrollToRealTime(){this.wl.$u()}getVisibleRange(){const t=this.wl.yu();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const e={from:this.N_.convertHorzItemToInternal(t.from),to:this.N_.convertHorzItemToInternal(t.to)},i=this.wl.Pu(e);this.Ui.hd(i)}getVisibleLogicalRange(){const t=this.wl.ku();return t===null?null:{from:t.Os(),to:t.di()}}setVisibleLogicalRange(t){ls(t.from<=t.to,"The from index cannot be after the to index."),this.Ui.hd(t)}resetTimeScale(){this.Ui.Zn()}fitContent(){this.Ui.Ju()}logicalToCoordinate(t){const e=this.Ui.yt();return e.Fi()?null:e.Et(t)}coordinateToLogical(t){return this.wl.Fi()?null:this.wl.Au(t)}timeToCoordinate(t){const e=this.N_.convertHorzItemToInternal(t),i=this.wl.ya(e,!1);return i===null?null:this.wl.Et(i)}coordinateToTime(t){const e=this.Ui.yt(),i=e.Au(t),n=e.qi(i);return n===null?null:n.originalTime}width(){return this.Hm.Hp().width}height(){return this.Hm.Hp().height}subscribeVisibleTimeRangeChange(t){this.Qb.l(t)}unsubscribeVisibleTimeRangeChange(t){this.Qb.v(t)}subscribeVisibleLogicalRangeChange(t){this.uu.l(t)}unsubscribeVisibleLogicalRangeChange(t){this.uu.v(t)}subscribeSizeChange(t){this.om.l(t)}unsubscribeSizeChange(t){this.om.v(t)}applyOptions(t){this.wl.Nh(t)}options(){return Object.assign(Object.assign({},Fe(this.wl.W())),{barSpacing:this.wl.he()})}tw(){this.Qb.M()&&this.Qb.m(this.getVisibleRange())}iw(){this.uu.M()&&this.uu.m(this.getVisibleLogicalRange())}nw(t){this.om.m(t.width,t.height)}}function t0(s){if(s===void 0||s.type==="custom")return;const t=s;t.minMove!==void 0&&t.precision===void 0&&(t.precision=(function(e){if(e>=1)return 0;let i=0;for(;i<8;i++){const n=Math.round(e);if(Math.abs(n-e)<1e-8)return i;e*=10}return i})(t.minMove))}function Ma(s){return(function(t){if(Di(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:{time:i,price:i},axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:i,axisDoubleClickReset:n}=t.handleScale;Di(i)&&(t.handleScale.axisPressedMouseMove={time:i,price:i}),Di(n)&&(t.handleScale.axisDoubleClickReset={time:n,price:n})}const e=t.handleScroll;Di(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})})(s),s}class e0{constructor(t,e,i){this.sw=new Map,this.ew=new Map,this.rw=new Mt,this.hw=new Mt,this.lw=new Mt,this.aw=new Bb(e);const n=i===void 0?Fe(Ta()):be(Fe(Ta()),Ma(i));this.N_=e,this.Hb=new Pb(t,n,e),this.Hb.Np().l((o=>{this.rw.M()&&this.rw.m(this.ow(o()))}),this),this.Hb.Fp().l((o=>{this.hw.M()&&this.hw.m(this.ow(o()))}),this),this.Hb.Fc().l((o=>{this.lw.M()&&this.lw.m(this.ow(o()))}),this);const r=this.Hb.qt();this._w=new Zb(r,this.Hb.Km(),this.N_)}remove(){this.Hb.Np().p(this),this.Hb.Fp().p(this),this.Hb.Fc().p(this),this._w.S(),this.Hb.S(),this.sw.clear(),this.ew.clear(),this.rw.S(),this.hw.S(),this.lw.S(),this.aw.S()}resize(t,e,i){this.autoSizeActive()||this.Hb.Um(t,e,i)}addCustomSeries(t,e){const i=Ms(t),n=Object.assign(Object.assign({},ih),i.defaultOptions());return this.uw("Custom",n,e,i)}addAreaSeries(t){return this.uw("Area",Uv,t)}addBaselineSeries(t){return this.uw("Baseline",zv,t)}addBarSeries(t){return this.uw("Bar",Vv,t)}addCandlestickSeries(t={}){return(function(e){e.borderColor!==void 0&&(e.borderUpColor=e.borderColor,e.borderDownColor=e.borderColor),e.wickColor!==void 0&&(e.wickUpColor=e.wickColor,e.wickDownColor=e.wickColor)})(t),this.uw("Candlestick",Bv,t)}addHistogramSeries(t){return this.uw("Histogram",qv,t)}addLineSeries(t){return this.uw("Line",Fv,t)}removeSeries(t){const e=Yt(this.sw.get(t)),i=this.aw.rd(e);this.Hb.qt().rd(e),this.cw(i),this.sw.delete(t),this.ew.delete(e)}Zb(t,e){this.cw(this.aw.Ob(t,e))}Jb(t,e){this.cw(this.aw.zb(t,e))}subscribeClick(t){this.rw.l(t)}unsubscribeClick(t){this.rw.v(t)}subscribeCrosshairMove(t){this.lw.l(t)}unsubscribeCrosshairMove(t){this.lw.v(t)}subscribeDblClick(t){this.hw.l(t)}unsubscribeDblClick(t){this.hw.v(t)}priceScale(t){return new Jb(this.Hb,t)}timeScale(){return this._w}applyOptions(t){this.Hb.Nh(Ma(t))}options(){return this.Hb.W()}takeScreenshot(){return this.Hb.Qm()}autoSizeActive(){return this.Hb.eb()}chartElement(){return this.Hb.rb()}paneSize(){const t=this.Hb.lb();return{height:t.height,width:t.width}}setCrosshairPosition(t,e,i){const n=this.sw.get(i);if(n===void 0)return;const r=this.Hb.qt().cr(n);r!==null&&this.Hb.qt().Jc(t,e,r)}clearCrosshairPosition(){this.Hb.qt().Qc(!0)}uw(t,e,i={},n){t0(i.priceFormat);const r=be(Fe(nh),Fe(e),i),o=this.Hb.qt().sd(t,r,n),l=new Qb(o,this,this,this,this.N_);return this.sw.set(l,o),this.ew.set(o,l),l}cw(t){const e=this.Hb.qt();e.td(t.yt.Ou,t.yt.Wb,t.yt.jb),t.Nb.forEach(((i,n)=>n.it(i.He,i.Fb))),e.Bu()}dw(t){return Yt(this.ew.get(t))}ow(t){const e=new Map;t.gb.forEach(((n,r)=>{const o=r.Xh(),l=Kr(o)(n);if(o!=="Custom")ls((function(a){return a.open!==void 0||a.value!==void 0})(l));else{const a=r.Ma();ls(!a||a(l)===!1)}e.set(this.dw(r),l)}));const i=t.wb===void 0?void 0:this.dw(t.wb);return{time:t.mb,logical:t.se,point:t.bb,hoveredSeries:i,hoveredObjectId:t.Mb,seriesData:e,sourceEvent:t.xb}}}function s0(s,t,e){let i;if(Li(s)){const r=document.getElementById(s);ls(r!==null,`Cannot find element in DOM with id=${s}`),i=r}else i=s;const n=new e0(i,t,e);return t.setOptions(n.options()),n}function jr(s,t){return s0(s,new pa,pa.Cd(t))}Object.assign(Object.assign({},nh),ih);const $o=(s,t)=>{const e=s.__vccOpts||s;for(const[i,n]of t)e[i]=n;return e},i0={class:"chart"},n0={__name:"ChartView",props:{data:{type:Object,default:null},title:{type:String,default:""},height:{type:Number,default:420}},setup(s){const t=s,e=$(null);let i=null,n=null,r=null;function o(){i&&(i.remove(),i=null,n=null,r=null)}function l(){if(!t.data?.overlays||!n)return;const c=[];for(const d of t.data.overlays)try{if(d.type==="horizontal_line"&&d.price&&n.createPriceLine({price:d.price,color:d.color||"rgba(0, 122, 255, 0.8)",lineWidth:d.width||2,lineStyle:2,axisLabelVisible:!0,title:d.text||""}),(d.type==="marker"||d.type==="label")&&d.start){const f=t.data.bars?.[d.start.barIndex];if(!f)continue;c.push({time:f.time,position:d.position==="below"?"belowBar":"aboveBar",color:d.color||"rgba(0, 122, 255, 0.9)",shape:d.shape||"circle",text:d.text||""})}}catch{}c.length&&n.setMarkers(c)}function a(){if(!e.value||!t.data?.bars?.length)return;const c=e.value.clientWidth;i=jr(e.value,{width:c,height:t.height,layout:{background:{color:"rgba(0, 0, 0, 0.85)"},textColor:"rgba(255, 255, 255, 0.75)"},grid:{vertLines:{color:"rgba(255, 255, 255, 0.06)"},horzLines:{color:"rgba(255, 255, 255, 0.06)"}},crosshair:{mode:Vr.Normal},rightPriceScale:{borderColor:"rgba(255, 255, 255, 0.12)",mode:Ur.Normal},timeScale:{borderColor:"rgba(255, 255, 255, 0.12)",timeVisible:!0,secondsVisible:!1},watermark:{visible:!0,text:t.title||t.data?.symbol||"Chart",fontSize:28,color:"rgba(255, 255, 255, 0.06)"}}),n=i.addCandlestickSeries({upColor:"rgba(38, 166, 154, 1)",downColor:"rgba(239, 83, 80, 1)",borderUpColor:"rgba(38, 166, 154, 1)",borderDownColor:"rgba(239, 83, 80, 1)",wickUpColor:"rgba(38, 166, 154, 1)",wickDownColor:"rgba(239, 83, 80, 1)"}),r=i.addHistogramSeries({priceFormat:{type:"volume"},priceScaleId:"",scaleMargins:{top:.82,bottom:0}});const d=t.data.bars.map(p=>({time:p.time,open:p.open,high:p.high,low:p.low,close:p.close})),f=t.data.bars.map(p=>({time:p.time,value:p.volume,color:p.close>=p.open?"rgba(38, 166, 154, 0.45)":"rgba(239, 83, 80, 0.45)"}));n.setData(d),r.setData(f),l(),i.timeScale().fitContent()}function u(){!i||!e.value||i.applyOptions({width:e.value.clientWidth})}return ae(()=>{Is(a),window.addEventListener("resize",u)}),Hs(()=>{window.removeEventListener("resize",u),o()}),ns(()=>t.data,async()=>{o(),await Is(),a()},{deep:!0}),(c,d)=>(C(),k("div",i0,[h("div",{ref_key:"chartContainer",ref:e,class:"chart-canvas"},null,512)]))}},yr=$o(n0,[["__scopeId","data-v-e357f0a7"]]),r0={key:0,class:"terminal-empty"},o0={class:"terminal-time"},l0={__name:"LogTerminal",props:{logs:{type:Array,default:()=>[]}},setup(s){const t=s,e=$(null);function i(r){try{return new Date(r).toLocaleTimeString("zh-CN")}catch{return""}}function n(r){return r==="stderr"?"terminal-stderr":r==="error"?"terminal-error":"terminal-stdout"}return ns(()=>t.logs.length,async()=>{await Is(),e.value&&(e.value.scrollTop=e.value.scrollHeight)}),(r,o)=>(C(),k("div",{ref_key:"container",ref:e,class:"terminal"},[s.logs.length===0?(C(),k("div",r0,"...")):K("",!0),(C(!0),k(pt,null,Jt(s.logs,(l,a)=>(C(),k("div",{key:a,class:"terminal-line"},[h("span",o0,"["+x(i(l.timestamp))+"]",1),h("span",{class:bs(n(l.type))},x(l.data),3)]))),128))],512))}},a0={key:0,class:"iv-card"},u0={class:"iv-header"},h0={class:"iv-title"},c0={class:"iv-title-text"},d0={class:"iv-body"},f0={class:"iv-row-top"},p0={class:"iv-left"},m0={key:0,class:"iv-note"},v0={__name:"IndicatorViewsCard",props:{views:{type:Object,default:null},title:{type:String,default:""}},setup(s){const t=s;function e(a){const u=String(a||"").trim().toLowerCase();return["bullish","long","buy","","","",""].includes(u)?"bullish":["bearish","short","sell","","","",""].includes(u)?"bearish":["neutral","none","wait","hold","",""].includes(u)?"neutral":u||"neutral"}function i(a){const u=String(a||"").trim().toLowerCase();return["above_average","above","strong","high","","",""].includes(u)?"above_average":["below_average","below","weak","low","","",""].includes(u)?"below_average":["average","mid","normal","","",""].includes(u)?"average":u||"average"}function n(a){const u=e(a);return u==="bullish"?"":u==="bearish"?"":u==="neutral"?"":u}function r(a){const u=i(a);return u==="above_average"?"":u==="below_average"?"":u==="average"?"":u}function o(a){const u=e(a);return u==="bullish"?"iv-badge iv-badge--bullish":u==="bearish"?"iv-badge iv-badge--bearish":"iv-badge iv-badge--neutral"}const l=ht(()=>{const a=t.views||{},u=e(a?.bollinger?.bias),c=e(a?.macd?.bias),d=i(a?.trend_strength?.level),f=e(a?.trend_strength?.bias),p=(u==="bullish"?1:u==="bearish"?-1:0)+(c==="bullish"?1:c==="bearish"?-1:0)+(f==="bullish"?1:f==="bearish"?-1:0),v=p>=2?"bullish":p<=-2?"bearish":"neutral";return[{key:"macd",name:"MACD",right:n(c),badgeClass:o(c),note:a?.macd?.note||""},{key:"boll",name:"",right:n(u),badgeClass:o(u),note:a?.bollinger?.note||""},{key:"trend",name:"",right:`${r(d)}  ${n(f)}`,badgeClass:"iv-badge iv-badge--purple",note:a?.trend_strength?.note||""},{key:"overall",name:"",right:n(v),badgeClass:o(v),note:""}]});return(a,u)=>s.views?(C(),k("div",a0,[h("div",u0,[h("div",h0,[h("span",c0,x(s.title),1)]),u[0]||(u[0]=h("span",{class:"iv-subtitle"},"AI ",-1))]),h("div",d0,[(C(!0),k(pt,null,Jt(l.value,c=>(C(),k("div",{key:c.key,class:"iv-row"},[h("div",f0,[h("span",p0,x(c.name),1),h("span",{class:bs(c.badgeClass)},x(c.right),3)]),c.note?(C(),k("div",m0,x(c.note),1)):K("",!0)]))),128))])])):K("",!0)}},g0=$o(v0,[["__scopeId","data-v-5ac50a0d"]]),Pe=Object.create(null);Pe.open="0";Pe.close="1";Pe.ping="2";Pe.pong="3";Pe.message="4";Pe.upgrade="5";Pe.noop="6";const nn=Object.create(null);Object.keys(Pe).forEach(s=>{nn[Pe[s]]=s});const Gr={type:"error",data:"parser error"},Mh=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ah=typeof ArrayBuffer=="function",Oh=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,Do=({type:s,data:t},e,i)=>Mh&&t instanceof Blob?e?i(t):Aa(t,i):Ah&&(t instanceof ArrayBuffer||Oh(t))?e?i(t):Aa(new Blob([t]),i):i(Pe[s]+(t||"")),Aa=(s,t)=>{const e=new FileReader;return e.onload=function(){const i=e.result.split(",")[1];t("b"+(i||""))},e.readAsDataURL(s)};function Oa(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let _r;function b0(s,t){if(Mh&&s.data instanceof Blob)return s.data.arrayBuffer().then(Oa).then(t);if(Ah&&(s.data instanceof ArrayBuffer||Oh(s.data)))return t(Oa(s.data));Do(s,!1,e=>{_r||(_r=new TextEncoder),t(_r.encode(e))})}const La="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ei=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<La.length;s++)ei[La.charCodeAt(s)]=s;const y0=s=>{let t=s.length*.75,e=s.length,i,n=0,r,o,l,a;s[s.length-1]==="="&&(t--,s[s.length-2]==="="&&t--);const u=new ArrayBuffer(t),c=new Uint8Array(u);for(i=0;i<e;i+=4)r=ei[s.charCodeAt(i)],o=ei[s.charCodeAt(i+1)],l=ei[s.charCodeAt(i+2)],a=ei[s.charCodeAt(i+3)],c[n++]=r<<2|o>>4,c[n++]=(o&15)<<4|l>>2,c[n++]=(l&3)<<6|a&63;return u},_0=typeof ArrayBuffer=="function",Io=(s,t)=>{if(typeof s!="string")return{type:"message",data:Lh(s,t)};const e=s.charAt(0);return e==="b"?{type:"message",data:w0(s.substring(1),t)}:nn[e]?s.length>1?{type:nn[e],data:s.substring(1)}:{type:nn[e]}:Gr},w0=(s,t)=>{if(_0){const e=y0(s);return Lh(e,t)}else return{base64:!0,data:s}},Lh=(s,t)=>t==="blob"?s instanceof Blob?s:new Blob([s]):s instanceof ArrayBuffer?s:s.buffer,Ph="",S0=(s,t)=>{const e=s.length,i=new Array(e);let n=0;s.forEach((r,o)=>{Do(r,!1,l=>{i[o]=l,++n===e&&t(i.join(Ph))})})},x0=(s,t)=>{const e=s.split(Ph),i=[];for(let n=0;n<e.length;n++){const r=Io(e[n],t);if(i.push(r),r.type==="error")break}return i};function C0(){return new TransformStream({transform(s,t){b0(s,e=>{const i=e.length;let n;if(i<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,i);else if(i<65536){n=new Uint8Array(3);const r=new DataView(n.buffer);r.setUint8(0,126),r.setUint16(1,i)}else{n=new Uint8Array(9);const r=new DataView(n.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(i))}s.data&&typeof s.data!="string"&&(n[0]|=128),t.enqueue(n),t.enqueue(e)})}})}let wr;function Ki(s){return s.reduce((t,e)=>t+e.length,0)}function ji(s,t){if(s[0].length===t)return s.shift();const e=new Uint8Array(t);let i=0;for(let n=0;n<t;n++)e[n]=s[0][i++],i===s[0].length&&(s.shift(),i=0);return s.length&&i<s[0].length&&(s[0]=s[0].slice(i)),e}function E0(s,t){wr||(wr=new TextDecoder);const e=[];let i=0,n=-1,r=!1;return new TransformStream({transform(o,l){for(e.push(o);;){if(i===0){if(Ki(e)<1)break;const a=ji(e,1);r=(a[0]&128)===128,n=a[0]&127,n<126?i=3:n===126?i=1:i=2}else if(i===1){if(Ki(e)<2)break;const a=ji(e,2);n=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),i=3}else if(i===2){if(Ki(e)<8)break;const a=ji(e,8),u=new DataView(a.buffer,a.byteOffset,a.length),c=u.getUint32(0);if(c>Math.pow(2,21)-1){l.enqueue(Gr);break}n=c*Math.pow(2,32)+u.getUint32(4),i=3}else{if(Ki(e)<n)break;const a=ji(e,n);l.enqueue(Io(r?a:wr.decode(a),t)),i=0}if(n===0||n>s){l.enqueue(Gr);break}}}})}const Rh=4;function Ot(s){if(s)return T0(s)}function T0(s){for(var t in Ot.prototype)s[t]=Ot.prototype[t];return s}Ot.prototype.on=Ot.prototype.addEventListener=function(s,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(t),this};Ot.prototype.once=function(s,t){function e(){this.off(s,e),t.apply(this,arguments)}return e.fn=t,this.on(s,e),this};Ot.prototype.off=Ot.prototype.removeListener=Ot.prototype.removeAllListeners=Ot.prototype.removeEventListener=function(s,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+s];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var i,n=0;n<e.length;n++)if(i=e[n],i===t||i.fn===t){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+s],this};Ot.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+s],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(e){e=e.slice(0);for(var i=0,n=e.length;i<n;++i)e[i].apply(this,t)}return this};Ot.prototype.emitReserved=Ot.prototype.emit;Ot.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};Ot.prototype.hasListeners=function(s){return!!this.listeners(s).length};const Bn=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),he=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),k0="arraybuffer";function Nh(s,...t){return t.reduce((e,i)=>(s.hasOwnProperty(i)&&(e[i]=s[i]),e),{})}const M0=he.setTimeout,A0=he.clearTimeout;function Vn(s,t){t.useNativeTimers?(s.setTimeoutFn=M0.bind(he),s.clearTimeoutFn=A0.bind(he)):(s.setTimeoutFn=he.setTimeout.bind(he),s.clearTimeoutFn=he.clearTimeout.bind(he))}const O0=1.33;function L0(s){return typeof s=="string"?P0(s):Math.ceil((s.byteLength||s.size)*O0)}function P0(s){let t=0,e=0;for(let i=0,n=s.length;i<n;i++)t=s.charCodeAt(i),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(i++,e+=4);return e}function $h(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function R0(s){let t="";for(let e in s)s.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(s[e]));return t}function N0(s){let t={},e=s.split("&");for(let i=0,n=e.length;i<n;i++){let r=e[i].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}class $0 extends Error{constructor(t,e,i){super(t),this.description=e,this.context=i,this.type="TransportError"}}class Bo extends Ot{constructor(t){super(),this.writable=!1,Vn(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,i){return super.emitReserved("error",new $0(t,e,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=Io(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=R0(t);return e.length?"?"+e:""}}class D0 extends Bo{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||e()})),this.writable||(i++,this.once("drain",function(){--i||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};x0(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,S0(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=$h()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let Dh=!1;try{Dh=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const I0=Dh;function B0(){}class V0 extends D0{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let i=location.port;i||(i=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e),i.on("error",(n,r)=>{this.onError("xhr post error",n,r)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,i)=>{this.onError("xhr poll error",e,i)}),this.pollXhr=t}}class Oe extends Ot{constructor(t,e,i){super(),this.createRequest=t,Vn(this,i),this._opts=i,this._method=i.method||"GET",this._uri=e,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var t;const e=Nh(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(e);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&i.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var n;i.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=Oe.requestsCount++,Oe.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=B0,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Oe.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Oe.requestsCount=0;Oe.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Pa);else if(typeof addEventListener=="function"){const s="onpagehide"in he?"pagehide":"unload";addEventListener(s,Pa,!1)}}function Pa(){for(let s in Oe.requests)Oe.requests.hasOwnProperty(s)&&Oe.requests[s].abort()}const F0=(function(){const s=Ih({xdomain:!1});return s&&s.responseType!==null})();class U0 extends V0{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=F0&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Oe(Ih,this.uri(),t)}}function Ih(s){const t=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||I0))return new XMLHttpRequest}catch{}if(!t)try{return new he[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Bh=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class z0 extends Bo{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,i=Bh?{}:Nh(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,i)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],n=e===t.length-1;Do(i,this.supportsBinary,r=>{try{this.doWrite(i,r)}catch{}n&&Bn(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=$h()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const Sr=he.WebSocket||he.MozWebSocket;class q0 extends z0{createSocket(t,e,i){return Bh?new Sr(t,e,i):e?new Sr(t,e):new Sr(t)}doWrite(t,e){this.ws.send(e)}}class W0 extends Bo{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=E0(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(e).getReader(),n=C0();n.readable.pipeTo(t.writable),this._writer=n.writable.getWriter();const r=()=>{i.read().then(({done:l,value:a})=>{l||(this.onPacket(a),r())}).catch(l=>{})};r();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],n=e===t.length-1;this._writer.write(i).then(()=>{n&&Bn(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const H0={websocket:q0,webtransport:W0,polling:U0},K0=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,j0=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Jr(s){if(s.length>8e3)throw"URI too long";const t=s,e=s.indexOf("["),i=s.indexOf("]");e!=-1&&i!=-1&&(s=s.substring(0,e)+s.substring(e,i).replace(/:/g,";")+s.substring(i,s.length));let n=K0.exec(s||""),r={},o=14;for(;o--;)r[j0[o]]=n[o]||"";return e!=-1&&i!=-1&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=G0(r,r.path),r.queryKey=J0(r,r.query),r}function G0(s,t){const e=/\/{2,9}/g,i=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function J0(s,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,r){n&&(e[n]=r)}),e}const Xr=typeof addEventListener=="function"&&typeof removeEventListener=="function",rn=[];Xr&&addEventListener("offline",()=>{rn.forEach(s=>s())},!1);class rs extends Ot{constructor(t,e){if(super(),this.binaryType=k0,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const i=Jr(t);e.hostname=i.host,e.secure=i.protocol==="https"||i.protocol==="wss",e.port=i.port,i.query&&(e.query=i.query)}else e.host&&(e.hostname=Jr(e.host).host);Vn(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(i=>{const n=i.prototype.name;this.transports.push(n),this._transportsByName[n]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=N0(this.opts.query)),Xr&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},rn.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=Rh,e.transport=t,this.id&&(e.sid=this.id);const i=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&rs.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",rs.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let i=0;i<this.writeBuffer.length;i++){const n=this.writeBuffer[i].data;if(n&&(e+=L0(n)),i>0&&e>this._maxPayload)return this.writeBuffer.slice(0,i);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Bn(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,i){return this._sendPacket("message",t,e,i),this}send(t,e,i){return this._sendPacket("message",t,e,i),this}_sendPacket(t,e,i,n){if(typeof e=="function"&&(n=e,e=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const r={type:t,data:e,options:i};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},i=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}_onError(t){if(rs.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Xr&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=rn.indexOf(this._offlineEventListener);i!==-1&&rn.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}rs.protocol=Rh;class X0 extends rs{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),i=!1;rs.priorWebsocketSuccess=!1;const n=()=>{i||(e.send([{type:"ping",data:"probe"}]),e.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;rs.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=e.name,this.emitReserved("upgradeError",f)}}))};function r(){i||(i=!0,c(),e.close(),e=null)}const o=d=>{const f=new Error("probe error: "+d);f.transport=e.name,r(),this.emitReserved("upgradeError",f)};function l(){o("transport closed")}function a(){o("socket closed")}function u(d){e&&d.name!==e.name&&r()}const c=()=>{e.removeListener("open",n),e.removeListener("error",o),e.removeListener("close",l),this.off("close",a),this.off("upgrading",u)};e.once("open",n),e.once("error",o),e.once("close",l),this.once("close",a),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}}let Y0=class extends X0{constructor(t,e={}){const i=typeof t=="object"?t:e;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(n=>H0[n]).filter(n=>!!n)),super(t,i)}};function Q0(s,t="",e){let i=s;e=e||typeof location<"u"&&location,s==null&&(s=e.protocol+"//"+e.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=e.protocol+s:s=e.host+s),/^(https?|wss?):\/\//.test(s)||(typeof e<"u"?s=e.protocol+"//"+s:s="https://"+s),i=Jr(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+t,i.href=i.protocol+"://"+r+(e&&e.port===i.port?"":":"+i.port),i}const Z0=typeof ArrayBuffer=="function",ty=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,Vh=Object.prototype.toString,ey=typeof Blob=="function"||typeof Blob<"u"&&Vh.call(Blob)==="[object BlobConstructor]",sy=typeof File=="function"||typeof File<"u"&&Vh.call(File)==="[object FileConstructor]";function Vo(s){return Z0&&(s instanceof ArrayBuffer||ty(s))||ey&&s instanceof Blob||sy&&s instanceof File}function on(s,t){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let e=0,i=s.length;e<i;e++)if(on(s[e]))return!0;return!1}if(Vo(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return on(s.toJSON(),!0);for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e)&&on(s[e]))return!0;return!1}function iy(s){const t=[],e=s.data,i=s;return i.data=Yr(e,t),i.attachments=t.length,{packet:i,buffers:t}}function Yr(s,t){if(!s)return s;if(Vo(s)){const e={_placeholder:!0,num:t.length};return t.push(s),e}else if(Array.isArray(s)){const e=new Array(s.length);for(let i=0;i<s.length;i++)e[i]=Yr(s[i],t);return e}else if(typeof s=="object"&&!(s instanceof Date)){const e={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=Yr(s[i],t));return e}return s}function ny(s,t){return s.data=Qr(s.data,t),delete s.attachments,s}function Qr(s,t){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<t.length)return t[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let e=0;e<s.length;e++)s[e]=Qr(s[e],t);else if(typeof s=="object")for(const e in s)Object.prototype.hasOwnProperty.call(s,e)&&(s[e]=Qr(s[e],t));return s}const ry=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],oy=5;var ot;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(ot||(ot={}));class ly{constructor(t){this.replacer=t}encode(t){return(t.type===ot.EVENT||t.type===ot.ACK)&&on(t)?this.encodeAsBinary({type:t.type===ot.EVENT?ot.BINARY_EVENT:ot.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===ot.BINARY_EVENT||t.type===ot.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=iy(t),i=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(i),n}}function Ra(s){return Object.prototype.toString.call(s)==="[object Object]"}class Fo extends Ot{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const i=e.type===ot.BINARY_EVENT;i||e.type===ot.BINARY_ACK?(e.type=i?ot.EVENT:ot.ACK,this.reconstructor=new ay(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(Vo(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(ot[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===ot.BINARY_EVENT||i.type===ot.BINARY_ACK){const r=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const o=t.substring(r,e);if(o!=Number(o)||t.charAt(e)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(t.charAt(e+1)==="/"){const r=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););i.nsp=t.substring(r,e)}else i.nsp="/";const n=t.charAt(e+1);if(n!==""&&Number(n)==n){const r=e+1;for(;++e;){const o=t.charAt(e);if(o==null||Number(o)!=o){--e;break}if(e===t.length)break}i.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){const r=this.tryParse(t.substr(e));if(Fo.isPayloadValid(i.type,r))i.data=r;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case ot.CONNECT:return Ra(e);case ot.DISCONNECT:return e===void 0;case ot.CONNECT_ERROR:return typeof e=="string"||Ra(e);case ot.EVENT:case ot.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&ry.indexOf(e[0])===-1);case ot.ACK:case ot.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ay{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=ny(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const uy=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Fo,Encoder:ly,get PacketType(){return ot},protocol:oy},Symbol.toStringTag,{value:"Module"}));function de(s,t,e){return s.on(t,e),function(){s.off(t,e)}}const hy=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Fh extends Ot{constructor(t,e,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[de(t,"open",this.onopen.bind(this)),de(t,"packet",this.onpacket.bind(this)),de(t,"error",this.onerror.bind(this)),de(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var i,n,r;if(hy.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const o={type:ot.EVENT,data:e};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const c=this.ids++,d=e.pop();this._registerAckCallback(c,d),o.id=c}const l=(n=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||n===void 0?void 0:n.writable,a=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!l||(a?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,e){var i;const n=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(n===void 0){this.acks[t]=e;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);e.call(this,new Error("operation has timed out"))},n),o=(...l)=>{this.io.clearTimeoutFn(r),e.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...e){return new Promise((i,n)=>{const r=(o,l)=>o?n(o):i(l);r.withError=!0,e.push(r),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((n,...r)=>i!==this._queue[0]?void 0:(n!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(n)):(this._queue.shift(),e&&e(null,...r)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:ot.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){const i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ot.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ot.EVENT:case ot.BINARY_EVENT:this.onevent(t);break;case ot.ACK:case ot.BINARY_ACK:this.onack(t);break;case ot.DISCONNECT:this.ondisconnect();break;case ot.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let i=!1;return function(...n){i||(i=!0,e.packet({type:ot.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ot.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const i of e)i.apply(this,t.data)}}}function Ks(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}Ks.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*s);s=(Math.floor(t*10)&1)==0?s-e:s+e}return Math.min(s,this.max)|0};Ks.prototype.reset=function(){this.attempts=0};Ks.prototype.setMin=function(s){this.ms=s};Ks.prototype.setMax=function(s){this.max=s};Ks.prototype.setJitter=function(s){this.jitter=s};class Zr extends Ot{constructor(t,e){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Vn(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Ks({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||uy;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Y0(this.uri,this.opts);const e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const n=de(e,"open",function(){i.onopen(),t&&t()}),r=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=de(e,"error",r);if(this._timeout!==!1){const l=this._timeout,a=this.setTimeoutFn(()=>{n(),r(new Error("timeout")),e.close()},l);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}return this.subs.push(n),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(de(t,"ping",this.onping.bind(this)),de(t,"data",this.ondata.bind(this)),de(t,"error",this.onerror.bind(this)),de(t,"close",this.onclose.bind(this)),de(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){Bn(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new Fh(this,t,e),this.nsps[t]=i),i}_destroy(t){const e=Object.keys(this.nsps);for(const i of e)if(this.nsps[i].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(n=>{n?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",n)):t.onreconnect()}))},e);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Zs={};function ln(s,t){typeof s=="object"&&(t=s,s=void 0),t=t||{};const e=Q0(s,t.path||"/socket.io"),i=e.source,n=e.id,r=e.path,o=Zs[n]&&r in Zs[n].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let a;return l?a=new Zr(i,t):(Zs[n]||(Zs[n]=new Zr(i,t)),a=Zs[n]),e.query&&!t.query&&(t.query=e.queryKey),a.socket(e.path,t)}Object.assign(ln,{Manager:Zr,Socket:Fh,io:ln,connect:ln});let ds=null;function cy(){const s=Ge(),t=ht(()=>s.token.value);function e(){t.value&&(ds&&ds.connected||(ds=ln("/saas",{transports:["websocket","polling"],auth:{token:t.value}})))}function i(){ds&&(ds.disconnect(),ds=null)}return ns(t,n=>{if(!n)return i();i(),e()}),e(),Hs(i),{socket:()=>ds}}const dy={key:0,class:"card"},fy={key:1,class:"card"},py={class:"card-content"},my={class:"input-with-button"},vy=["disabled"],gy={key:0,class:"form-error"},by={key:1,class:"form-success"},yy={key:2,class:"grid grid-2"},_y={class:"card",style:{"grid-column":"1 / -1"}},wy={class:"card-content"},Sy={class:"grid grid-3"},xy={class:"stat-row"},Cy={class:"stat-value"},Ey={class:"stat-row"},Ty={class:"stat-value"},ky={class:"stat-row"},My={class:"stat-value"},Ay={key:0},Oy={key:1,class:"text-muted"},Ly={key:0,class:"form-error"},Py={key:1,class:"form-error"},Ry={class:"card"},Ny={class:"card-content"},$y={class:"form-group"},Dy=["disabled"],Iy={class:"form-group"},By=["disabled"],Vy=["value"],Fy={class:"form-group"},Uy=["disabled"],zy={class:"form-group"},qy={class:"input-with-button"},Wy={class:"text-muted",style:{display:"flex","align-items":"center",gap:"0.5rem"}},Hy=["disabled"],Ky={key:0,class:"form-group"},jy=["disabled"],Gy=["value"],Jy={class:"input-with-button"},Xy=["disabled"],Yy=["disabled"],Qy={key:1,class:"form-error"},Zy={class:"card"},t_={class:"card-content"},e_={key:0,class:"grid grid-2",style:{gap:"0.75rem"}},s_={class:"stat-row"},i_={class:"stat-value"},n_={class:"stat-row"},r_={class:"stat-value"},o_={key:0,class:"stat-row"},l_={class:"stat-value"},a_={key:1,class:"stat-row"},u_={class:"stat-value"},h_={key:2,class:"stat-row"},c_={class:"stat-value"},d_={key:3,class:"stat-row"},f_={class:"stat-value"},p_={key:1,class:"text-muted"},m_={key:2,class:"mt-16"},v_={class:"stat-row"},g_={class:"stat-value",style:{"text-align":"right","max-width":"70%"}},b_={key:3,class:"mt-16"},y_={class:"card",style:{"grid-column":"1 / -1"}},__={class:"card",style:{"grid-column":"1 / -1"}},w_={class:"card-content"},S_={key:0,class:"grid grid-2"},x_={key:0},C_={key:1,style:{"grid-column":"1 / -1"}},E_={key:1,class:"text-muted"},T_={__name:"AIStrategyPage",setup(s){const t=["1m","5m","15m","30m","1h","4h","1d"],e=$(!0),i=$(""),n=$(!1),r=$(""),o=$(""),l=Gt({subscription:null,subscriptionActive:!1,credit:null,providers:{selectedId:null,items:[]}}),a=Gt({symbol:"BTCUSDT",timeframe:"1h",bars:200,enable4x:!1,auxTimeframe:""}),u=$(!1),c=$(null),d=$(""),f=$([]),p=$(""),v=$(null),g=Gt({base:null,aux:null,vlm:null}),_=ht(()=>l.providers.items.find(W=>W.id===l.providers.selectedId)||null),w=ht(()=>!!_.value&&!!_.value.hasKey);function y(W,R,G){G&&d.value&&G!==d.value||f.value.push({type:W,data:R,timestamp:Date.now()})}function M(){return`sess_${Date.now()}_${Math.random().toString(36).slice(2,10)}`}function D(W){if(W==null||W===0)return"-";if(W==="market")return"";const R=Number(W);return Number.isFinite(R)?R.toFixed(6):"-"}function X(W){if(!W)return"-";try{return new Date(W).toISOString().slice(0,10)}catch{return String(W)}}function nt(W){return{long:"",short:"",buy:"",sell:""}[String(W).toLowerCase()]||W}async function Z(){const W=await st.request("/api/saas/ai/state");l.subscription=W.subscription||null,l.subscriptionActive=!!W.subscriptionActive,l.credit=W.credit||null,l.providers=W.providers||{selectedId:null,items:[]}}async function V(){r.value="",o.value="",n.value=!0;try{const W=await st.request("/api/billing/redeem-activation-code",{method:"POST",body:{code:i.value}});l.subscription=W.subscription||null,l.subscriptionActive=!0,o.value="",i.value="",await Z()}catch(W){r.value=W?.message||""}finally{n.value=!1}}async function O(){p.value="",f.value=[],v.value=null,g.base=null,g.aux=null,g.vlm=null,d.value=M(),u.value=!0;const W=["--symbol",a.symbol,"--timeframe",a.timeframe,"--bars",String(a.bars),"--wait","1000","--session-id",d.value];a.enable4x&&(W.push("--enable-4x-chart"),a.auxTimeframe&&W.push("--aux-timeframe",a.auxTimeframe));try{const R=await st.request("/api/saas/run-script",{method:"POST",body:{script:"main",args:W,sessionId:d.value}});if(c.value=R.pid||null,!c.value)throw new Error("");R.charged?.remainingCredits!==void 0&&l.credit&&(l.credit.remainingCredits=Number(R.charged.remainingCredits),l.credit.periodEnd=R.charged.nextResetAt||l.credit.periodEnd)}catch(R){p.value=R?.message||"",u.value=!1}}function B(){c.value&&Tt().emit("kill-process",c.value)}async function mt(){if(!d.value)return;const W=await st.request(`/api/saas/chart-data/${encodeURIComponent(d.value)}`);g.base=W.base||null,g.aux=W.aux||null,g.vlm=W.vlm||null,v.value=W.decision||null}const{socket:Tt}=cy();function At(W){y(W.type,W.data,W.sessionId)}async function Qt(W){if(!(W.sessionId&&W.sessionId!==d.value)&&(y("stdout",`Process exited with code ${W.code}`,W.sessionId),u.value=!1,c.value=null,W.code===0))try{await mt()}catch(R){y("error",`: ${R?.message||String(R)}`,W.sessionId)}}function qt(W){W===c.value&&(y("stderr","Process terminated.",d.value),u.value=!1,c.value=null)}return ae(async()=>{try{await Z()}finally{e.value=!1}Tt().on("log",At),Tt().on("process-exit",Qt),Tt().on("process-killed",qt)}),Hs(()=>{Tt()?.off?.("log",At),Tt()?.off?.("process-exit",Qt),Tt()?.off?.("process-killed",qt)}),(W,R)=>(C(),Xt(Ln,{title:"AI ",subtitle:""},{default:bt(()=>[e.value?(C(),k("div",dy,[...R[6]||(R[6]=[h("p",{class:"text-muted"},"...",-1)])])):l.subscriptionActive?(C(),k("div",yy,[h("div",_y,[h("div",wy,[h("div",Sy,[h("div",xy,[R[9]||(R[9]=h("span",{class:"stat-label"},"",-1)),h("span",Cy,x((l.credit?.remainingCredits??0).toFixed(2)),1)]),h("div",Ey,[R[10]||(R[10]=h("span",{class:"stat-label"},"",-1)),h("span",Ty,x(X(l.credit?.periodEnd)),1)]),h("div",ky,[R[11]||(R[11]=h("span",{class:"stat-label"},"",-1)),h("span",My,[_.value?(C(),k("span",Ay,x(_.value.display_name),1)):(C(),k("span",Oy,""))])])]),_.value?_.value.hasKey?K("",!0):(C(),k("p",Py,"")):(C(),k("p",Ly,"AI "))])]),h("div",Ry,[R[19]||(R[19]=h("h2",{class:"card-title"},"",-1)),h("div",Ny,[h("div",$y,[R[12]||(R[12]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":R[1]||(R[1]=G=>a.symbol=G),class:"form-input",placeholder:"BTCUSDT",disabled:u.value},null,8,Dy),[[lt,a.symbol]])]),h("div",Iy,[R[13]||(R[13]=h("label",{class:"form-label"},"",-1)),et(h("select",{"onUpdate:modelValue":R[2]||(R[2]=G=>a.timeframe=G),class:"form-input",disabled:u.value},[(C(),k(pt,null,Jt(t,G=>h("option",{key:G,value:G},x(G),9,Vy)),64))],8,By),[[Ae,a.timeframe]])]),h("div",Fy,[R[14]||(R[14]=h("label",{class:"form-label"},"K",-1)),et(h("input",{"onUpdate:modelValue":R[3]||(R[3]=G=>a.bars=G),class:"form-input",type:"number",min:"50",max:"2000",disabled:u.value},null,8,Uy),[[lt,a.bars,void 0,{number:!0}]])]),h("div",zy,[R[16]||(R[16]=h("label",{class:"form-label"},"4x ",-1)),h("div",qy,[h("label",Wy,[et(h("input",{"onUpdate:modelValue":R[4]||(R[4]=G=>a.enable4x=G),type:"checkbox",disabled:u.value},null,8,Hy),[[tf,a.enable4x]]),R[15]||(R[15]=kt("  ",-1))])])]),a.enable4x?(C(),k("div",Ky,[R[18]||(R[18]=h("label",{class:"form-label"},"",-1)),et(h("select",{"onUpdate:modelValue":R[5]||(R[5]=G=>a.auxTimeframe=G),class:"form-input",disabled:u.value},[R[17]||(R[17]=h("option",{value:""},"",-1)),(C(),k(pt,null,Jt(t,G=>h("option",{key:G,value:G},x(G),9,Gy)),64))],8,jy),[[Ae,a.auxTimeframe]])])):K("",!0),h("div",Jy,[h("button",{class:"btn btn-primary",type:"button",disabled:u.value||!w.value,onClick:O},x(u.value?"...":""),9,Xy),h("button",{class:"btn btn-danger",type:"button",disabled:!c.value,onClick:B},"",8,Yy)]),p.value?(C(),k("p",Qy,x(p.value),1)):K("",!0)])]),h("div",Zy,[R[27]||(R[27]=h("h2",{class:"card-title"},"",-1)),h("div",t_,[v.value?(C(),k("div",e_,[h("div",s_,[R[20]||(R[20]=h("span",{class:"stat-label"},"",-1)),h("span",i_,x(v.value.enter?"":""),1)]),h("div",n_,[R[21]||(R[21]=h("span",{class:"stat-label"},"",-1)),h("span",r_,x(Math.round((v.value.confidence||0)*100))+"%",1)]),v.value.enter?(C(),k("div",o_,[R[22]||(R[22]=h("span",{class:"stat-label"},"",-1)),h("span",l_,x(nt(v.value.direction)),1)])):K("",!0),v.value.enter?(C(),k("div",a_,[R[23]||(R[23]=h("span",{class:"stat-label"},"",-1)),h("span",u_,x(D(v.value.entry_price)),1)])):K("",!0),v.value.enter?(C(),k("div",h_,[R[24]||(R[24]=h("span",{class:"stat-label"},"",-1)),h("span",c_,x(D(v.value.stop_loss_price)),1)])):K("",!0),v.value.enter?(C(),k("div",d_,[R[25]||(R[25]=h("span",{class:"stat-label"},"",-1)),h("span",f_,x(D(v.value.take_profit_price)),1)])):K("",!0)])):(C(),k("p",p_,"")),v.value?.reason?(C(),k("div",m_,[h("div",v_,[R[26]||(R[26]=h("span",{class:"stat-label"},"",-1)),h("span",g_,x(v.value.reason),1)])])):K("",!0),v.value?.indicator_views?(C(),k("div",b_,[at(g0,{views:v.value.indicator_views},null,8,["views"])])):K("",!0)])]),h("div",y_,[R[28]||(R[28]=h("h2",{class:"card-title"},"",-1)),at(l0,{logs:f.value},null,8,["logs"])]),h("div",__,[R[32]||(R[32]=h("h2",{class:"card-title"},"",-1)),h("div",w_,[g.base?(C(),k("div",S_,[h("div",null,[R[29]||(R[29]=h("p",{class:"text-muted",style:{"margin-bottom":"0.5rem"}},"Base",-1)),at(yr,{data:g.base,title:`${g.base.symbol} ${g.base.timeframe}`,height:420},null,8,["data","title"])]),g.aux?(C(),k("div",x_,[R[30]||(R[30]=h("p",{class:"text-muted",style:{"margin-bottom":"0.5rem"}},"Aux",-1)),at(yr,{data:g.aux,title:`${g.aux.symbol} ${g.aux.timeframe}`,height:420},null,8,["data","title"])])):K("",!0),g.vlm?(C(),k("div",C_,[R[31]||(R[31]=h("p",{class:"text-muted",style:{"margin-bottom":"0.5rem"}},"VLM Overlays",-1)),at(yr,{data:g.vlm,title:`VLM ${g.vlm.symbol} ${g.vlm.timeframe}`,height:460},null,8,["data","title"])])):K("",!0)])):(C(),k("p",E_,""))])])])):(C(),k("div",fy,[R[8]||(R[8]=h("h2",{class:"card-title"},"",-1)),h("div",py,[R[7]||(R[7]=h("p",{class:"text-muted"},"",-1)),h("div",my,[et(h("input",{"onUpdate:modelValue":R[0]||(R[0]=G=>i.value=G),class:"form-input",placeholder:""},null,512),[[lt,i.value]]),h("button",{class:"btn btn-primary",type:"button",disabled:n.value,onClick:V},x(n.value?"...":""),9,vy)]),r.value?(C(),k("p",gy,x(r.value),1)):K("",!0),o.value?(C(),k("p",by,x(o.value),1)):K("",!0)])]))]),_:1}))}},k_={key:0,class:"card"},M_={key:1,class:"grid grid-2"},A_={class:"card"},O_={class:"card-content"},L_={class:"stat-row"},P_={class:"stat-value"},R_={key:0,class:"stat-row"},N_={class:"stat-value"},$_={key:1,class:"stat-row"},D_={class:"stat-value"},I_={key:2,class:"stat-row"},B_={class:"stat-value"},V_={key:3,class:"stat-row"},F_={class:"stat-value"},U_={key:4,class:"stat-row"},z_={class:"stat-value"},q_={key:5,class:"text-muted"},W_={class:"card"},H_={class:"card-content"},K_={key:0,class:"text-muted"},j_={key:1},G_={class:"stat-row"},J_={class:"stat-value"},X_={class:"stat-row"},Y_={class:"stat-value"},Q_={class:"stat-row"},Z_={class:"stat-value"},t1={key:0,class:"form-error"},e1={key:1,class:"text-muted"},s1={class:"card",style:{"grid-column":"1 / -1"}},i1={class:"card-content"},n1={key:0,class:"form-error"},r1={class:"data-table"},o1={key:0},l1={key:0},a1={key:0,class:"form-success"},u1={key:1,class:"text-muted"},h1=["disabled","onClick"],c1={key:1,class:"mt-16"},d1={class:"grid grid-2"},f1={class:"form-group"},p1=["value"],m1={class:"form-group"},v1={key:0,class:"form-error"},g1={key:1,class:"form-success"},b1=["disabled"],y1={key:2,class:"text-muted mt-16"},_1={__name:"AIProvidersPage",setup(s){const t=$(!0),e=$(""),i=Gt({subscription:null,subscriptionActive:!1,credit:null,providers:{selectedId:null,items:[]}}),n=$(""),r=Gt({providerId:"",apiKey:""}),o=$(!1),l=$(""),a=$(""),u=Ge(),c=ht(()=>u.isAdmin.value),d=ht(()=>i.providers.items.find(w=>w.id===i.providers.selectedId)||null);function f(w){if(!w)return"-";try{return new Date(w).toISOString().slice(0,10)}catch{return String(w)}}function p(w){return{monthly:"",quarterly:"",yearly:"",free:""}[w]||w}async function v(){e.value="";const w=await st.request("/api/saas/ai/state");i.subscription=w.subscription||null,i.subscriptionActive=!!w.subscriptionActive,i.credit=w.credit||null,i.providers=w.providers||{selectedId:null,items:[]}}async function g(w){n.value=w;try{await st.request("/api/saas/ai/providers/select",{method:"POST",body:{providerId:w}}),await v()}catch(y){e.value=y?.message||""}finally{n.value=""}}async function _(){l.value="",a.value="",o.value=!0;try{if(!r.providerId)throw new Error(" Provider");if(!r.apiKey.trim())throw new Error(" apiKey");await st.request("/api/saas/ai/providers/set-key",{method:"POST",body:{providerId:r.providerId,apiKey:r.apiKey.trim()}}),a.value="",r.apiKey="",await v()}catch(w){l.value=w?.message||""}finally{o.value=!1}}return ae(async()=>{try{await v()}catch(w){e.value=w?.message||""}finally{t.value=!1}}),(w,y)=>(C(),Xt(Ln,{title:"AI ",subtitle:" AI "},{default:bt(()=>[t.value?(C(),k("div",k_,[...y[2]||(y[2]=[h("p",{class:"text-muted"},"...",-1)])])):(C(),k("div",M_,[h("div",A_,[y[9]||(y[9]=h("h2",{class:"card-title"},"",-1)),h("div",O_,[h("div",L_,[y[3]||(y[3]=h("span",{class:"stat-label"},"",-1)),h("span",P_,x(i.subscriptionActive?"":""),1)]),i.subscription?(C(),k("div",R_,[y[4]||(y[4]=h("span",{class:"stat-label"},"",-1)),h("span",N_,x(p(i.subscription.plan_code)),1)])):K("",!0),i.credit?(C(),k("div",$_,[y[5]||(y[5]=h("span",{class:"stat-label"},"",-1)),h("span",D_,x(i.credit.allowanceCredits.toFixed(2)),1)])):K("",!0),i.credit?(C(),k("div",I_,[y[6]||(y[6]=h("span",{class:"stat-label"},"",-1)),h("span",B_,x(i.credit.usedCredits.toFixed(2)),1)])):K("",!0),i.credit?(C(),k("div",V_,[y[7]||(y[7]=h("span",{class:"stat-label"},"",-1)),h("span",F_,x(i.credit.remainingCredits.toFixed(2)),1)])):K("",!0),i.credit?(C(),k("div",U_,[y[8]||(y[8]=h("span",{class:"stat-label"},"",-1)),h("span",z_,x(f(i.credit.periodEnd)),1)])):K("",!0),i.subscriptionActive?K("",!0):(C(),k("p",q_,"  Provider "))])]),h("div",W_,[y[13]||(y[13]=h("h2",{class:"card-title"},"",-1)),h("div",H_,[d.value?(C(),k("div",j_,[h("div",G_,[y[10]||(y[10]=h("span",{class:"stat-label"},"",-1)),h("span",J_,x(d.value.display_name),1)]),h("div",X_,[y[11]||(y[11]=h("span",{class:"stat-label"},"",-1)),h("span",Y_,x(d.value.model_name),1)]),h("div",Q_,[y[12]||(y[12]=h("span",{class:"stat-label"},"",-1)),h("span",Z_,x((d.value.multiplier_x100/100).toFixed(2))+"x",1)]),!d.value.hasKey&&c.value?(C(),k("p",t1,"")):d.value.hasKey?K("",!0):(C(),k("p",e1,""))])):(C(),k("p",K_,""))])]),h("div",s1,[y[22]||(y[22]=h("h2",{class:"card-title"},"",-1)),h("div",i1,[e.value?(C(),k("p",n1,x(e.value),1)):K("",!0),h("table",r1,[h("thead",null,[h("tr",null,[y[14]||(y[14]=h("th",null,"",-1)),y[15]||(y[15]=h("th",null,"",-1)),y[16]||(y[16]=h("th",null,"",-1)),c.value?(C(),k("th",o1,"")):K("",!0),y[17]||(y[17]=h("th",null,"",-1))])]),h("tbody",null,[(C(!0),k(pt,null,Jt(i.providers.items,M=>(C(),k("tr",{key:M.id},[h("td",null,x(M.display_name),1),h("td",null,x(M.model_name),1),h("td",null,x((M.multiplier_x100/100).toFixed(2))+"x",1),c.value?(C(),k("td",l1,[M.hasKey?(C(),k("span",a1,"")):(C(),k("span",u1,""))])):K("",!0),h("td",null,[h("button",{class:"btn btn-secondary btn-sm",type:"button",disabled:n.value===M.id,onClick:D=>g(M.id)},x(i.providers.selectedId===M.id?"":n.value===M.id?"...":""),9,h1)])]))),128))])]),c.value?(C(),k("div",c1,[y[21]||(y[21]=h("h3",{class:"card-title",style:{"margin-bottom":"0.75rem"}},"",-1)),h("div",d1,[h("div",f1,[y[19]||(y[19]=h("label",{class:"form-label"},"",-1)),et(h("select",{"onUpdate:modelValue":y[0]||(y[0]=M=>r.providerId=M),class:"form-input"},[y[18]||(y[18]=h("option",{value:""},"",-1)),(C(!0),k(pt,null,Jt(i.providers.items,M=>(C(),k("option",{key:M.id,value:M.id},x(M.display_name)+" ("+x(M.model_name)+") ",9,p1))),128))],512),[[Ae,r.providerId]])]),h("div",m1,[y[20]||(y[20]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":y[1]||(y[1]=M=>r.apiKey=M),class:"form-input",placeholder:"sk-..."},null,512),[[lt,r.apiKey]]),l.value?(C(),k("p",v1,x(l.value),1)):K("",!0),a.value?(C(),k("p",g1,x(a.value),1)):K("",!0)])]),h("button",{class:"btn btn-primary",type:"button",disabled:o.value,onClick:_},x(o.value?"...":""),9,b1)])):(C(),k("p",y1,""))])])]))]),_:1}))}},w1={class:"app-layout"},S1={class:"sidebar"},x1={class:"nav-menu"},C1={class:"main-content"},E1={class:"topbar"},T1={class:"topbar-title"},k1={key:0},M1={class:"topbar-user"},A1={class:"user-name"},O1={class:"content-wrapper"},L1={key:0,class:"card card-warn"},P1={class:"card-content banner-row"},R1={key:0,class:"banner-msg"},N1=["disabled"],$1={key:0,class:"card-content"},D1=["href"],js={__name:"AdminShell",props:{title:{type:String,required:!0},subtitle:{type:String,default:""}},setup(s){const t=Ge(),e=xs(),i=ht(()=>t.user.value?.display_name||t.user.value?.email||""),n=ht(()=>!!t.user.value&&!t.user.value?.email_verified_at),r=$(!1),o=$(""),l=$("");async function a(){await t.logout(),await e.push("/login")}async function u(){o.value="",l.value="",r.value=!0;try{const c=await st.request("/api/auth/email-verifications/send",{method:"POST"});o.value=c?.alreadyVerified?"":"",l.value=c?.debugLink||"",await t.refreshUser().catch(()=>null)}catch(c){o.value=c?.message||""}finally{r.value=!1}}return(c,d)=>(C(),k("div",w1,[h("aside",S1,[d[7]||(d[7]=h("div",{class:"sidebar-header"},[h("div",{class:"logo"},[h("img",{src:Oi,alt:"Arkilo"}),h("span",null,"Arkilo Admin")])],-1)),h("nav",x1,[at(Ct(Dt),{class:"nav-item",to:"/admin/overview"},{default:bt(()=>[...d[0]||(d[0]=[kt("",-1)])]),_:1}),at(Ct(Dt),{class:"nav-item",to:"/admin/users"},{default:bt(()=>[...d[1]||(d[1]=[kt("",-1)])]),_:1}),at(Ct(Dt),{class:"nav-item",to:"/admin/organizations"},{default:bt(()=>[...d[2]||(d[2]=[kt("",-1)])]),_:1}),at(Ct(Dt),{class:"nav-item",to:"/admin/subscriptions"},{default:bt(()=>[...d[3]||(d[3]=[kt("",-1)])]),_:1}),at(Ct(Dt),{class:"nav-item",to:"/admin/activation-codes"},{default:bt(()=>[...d[4]||(d[4]=[kt("",-1)])]),_:1}),at(Ct(Dt),{class:"nav-item",to:"/admin/providers"},{default:bt(()=>[...d[5]||(d[5]=[kt("",-1)])]),_:1}),at(Ct(Dt),{class:"nav-item",to:"/app"},{default:bt(()=>[...d[6]||(d[6]=[kt("",-1)])]),_:1})]),h("div",{class:"sidebar-footer"},[h("button",{class:"btn btn-secondary btn-full",type:"button",onClick:a},"")])]),h("main",C1,[h("header",E1,[h("div",T1,[h("h1",null,x(s.title),1),s.subtitle?(C(),k("p",k1,x(s.subtitle),1)):K("",!0)]),h("div",M1,[h("span",A1,x(i.value),1)])]),h("div",O1,[n.value?(C(),k("div",L1,[h("div",P1,[h("div",null,[d[8]||(d[8]=h("div",{class:"banner-title"},"",-1)),d[9]||(d[9]=h("div",{class:"text-muted"},"",-1)),o.value?(C(),k("div",R1,x(o.value),1)):K("",!0)]),h("button",{class:"btn btn-primary",type:"button",disabled:r.value,onClick:u},x(r.value?"...":""),9,N1)]),l.value?(C(),k("div",$1,[d[10]||(d[10]=h("div",{class:"text-muted"}," SMTP",-1)),h("a",{class:"link",href:l.value},x(l.value),9,D1)])):K("",!0)])):K("",!0),bu(c.$slots,"default")])])]))}},I1={class:"grid grid-3"},B1={class:"card"},V1={class:"card-content"},F1={class:"metric"},U1={class:"card"},z1={class:"card-content"},q1={class:"metric"},W1={class:"card"},H1={class:"card-content"},K1={class:"metric"},j1={class:"card"},G1={class:"card-content banner-row"},J1={class:"input-with-button"},X1=["disabled"],Y1={class:"card-content"},Q1={class:"grid grid-2"},Z1={key:0,class:"form-error mt-16"},tw={class:"card"},ew={class:"card-content"},sw={class:"mt-16"},iw={class:"data-table"},nw={key:0},rw={__name:"AdminDashboardPage",setup(s){const t=$(null),e=$(null),i=$(30),n=$(!1),r=$(""),o=$({users:0,organizations:0,activeSubscriptions:0}),l=$([]);let a=null,u=null,c=null,d=null;function f(g){return Array.isArray(g)?g.map(_=>({time:_.day,value:Number(_.count||0)})).filter(_=>typeof _.time=="string"&&Number.isFinite(_.value)):[]}function p(){!t.value||!e.value||(a||(a=jr(t.value,{height:220,layout:{background:{color:"transparent"}}}),c=a.addLineSeries()),u||(u=jr(e.value,{height:220,layout:{background:{color:"transparent"}}}),d=u.addLineSeries()))}async function v(){r.value="",n.value=!0;try{const g=await st.request(`/api/admin/stats/overview?days=${encodeURIComponent(i.value)}`);o.value=g.totals||o.value,l.value=g.byPlan||[],p(),c?.setData(f(g.series?.users||[])),d?.setData(f(g.series?.subscriptions||[])),a?.timeScale().fitContent(),u?.timeScale().fitContent()}catch(g){r.value=g?.message||""}finally{n.value=!1}}return ae(()=>{p(),v()}),gu(()=>{a?.remove(),u?.remove(),a=null,u=null,c=null,d=null}),(g,_)=>(C(),Xt(js,{title:"",subtitle:""},{default:bt(()=>[h("div",I1,[h("div",B1,[h("div",V1,[_[1]||(_[1]=h("div",{class:"text-muted"},"",-1)),h("div",F1,x(o.value.users),1)])]),h("div",U1,[h("div",z1,[_[2]||(_[2]=h("div",{class:"text-muted"},"",-1)),h("div",q1,x(o.value.organizations),1)])]),h("div",W1,[h("div",H1,[_[3]||(_[3]=h("div",{class:"text-muted"},"",-1)),h("div",K1,x(o.value.activeSubscriptions),1)])])]),h("div",j1,[h("div",G1,[_[5]||(_[5]=h("div",null,[h("div",{class:"card-title"},""),h("div",{class:"text-muted"}," Stripe/")],-1)),h("div",J1,[et(h("select",{"onUpdate:modelValue":_[0]||(_[0]=w=>i.value=w),class:"form-input"},[..._[4]||(_[4]=[h("option",{value:7}," 7 ",-1),h("option",{value:30}," 30 ",-1),h("option",{value:90}," 90 ",-1)])],512),[[Ae,i.value,void 0,{number:!0}]]),h("button",{class:"btn btn-secondary",type:"button",disabled:n.value,onClick:v},x(n.value?"...":""),9,X1)])]),h("div",Y1,[h("div",Q1,[h("div",null,[_[6]||(_[6]=h("div",{class:"text-muted"},"",-1)),h("div",{ref_key:"usersChartEl",ref:t,class:"chart-box"},null,512)]),h("div",null,[_[7]||(_[7]=h("div",{class:"text-muted"},"",-1)),h("div",{ref_key:"subsChartEl",ref:e,class:"chart-box"},null,512)])]),r.value?(C(),k("p",Z1,x(r.value),1)):K("",!0)])]),h("div",tw,[h("div",ew,[_[10]||(_[10]=h("div",{class:"card-title"},"",-1)),_[11]||(_[11]=h("div",{class:"text-muted"},"",-1)),h("div",sw,[h("table",iw,[_[9]||(_[9]=h("thead",null,[h("tr",null,[h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,"")])],-1)),h("tbody",null,[(C(!0),k(pt,null,Jt(l.value,w=>(C(),k("tr",{key:w.planCode},[h("td",null,x(w.planCode),1),h("td",null,x(w.activeOrganizations),1),h("td",null,x(w.activeSubscriptions),1),h("td",null,x(w.totalSubscriptions),1),h("td",null,x(w.totalOrganizations),1)]))),128)),l.value.length?K("",!0):(C(),k("tr",nw,[..._[8]||(_[8]=[h("td",{colspan:"5",class:"text-muted"},"",-1)])]))])])])])])]),_:1}))}},ow=$o(rw,[["__scopeId","data-v-3c840957"]]),lw={class:"card"},aw={class:"card-content banner-row"},uw={class:"input-with-button",style:{width:"100%"}},hw=["disabled"],cw={class:"card-content"},dw={key:0,class:"form-error"},fw={class:"data-table"},pw={class:"input-with-button"},mw=["disabled","onClick"],vw=["disabled","onClick"],gw=["disabled","onClick"],bw=["onClick"],yw=["disabled","onClick"],_w={key:0},ww={class:"mt-16 input-with-button"},Sw=["disabled"],xw={class:"text-muted"},Cw=["disabled"],Ew={key:0,class:"card"},Tw={class:"card-content"},kw={class:"grid grid-3 mt-16"},Mw={class:"form-group"},Aw={class:"form-group"},Ow={class:"form-group"},Lw={class:"input-with-button mt-16"},Pw=["disabled"],Rw=["disabled"],Nw={key:0,class:"form-error mt-16"},Gi=50,$w={__name:"AdminUsersPage",setup(s){const t=$(""),e=$([]),i=$(0),n=$(!1),r=$(""),o=$(""),l=$(0),a=$(null),u=$({id:"",email:"",displayName:"",status:"active"}),c=$(!1),d=$("");function f(V){if(!V)return"-";try{return new Date(V).toISOString().replace("T"," ").slice(0,19)}catch{return String(V)}}async function p(){r.value="",n.value=!0;try{const V=new URLSearchParams({limit:String(Gi),offset:String(l.value),q:t.value.trim()}),O=await st.request(`/api/admin/users?${V.toString()}`);e.value=O.items||[],i.value=Number(O.total||0)}catch(V){r.value=V?.message||""}finally{n.value=!1}}async function v(){l.value=0,await p()}async function g(V){const O=V.status==="disabled"?"active":"disabled",B=O==="disabled"?"":"";if(window.confirm(`${B}${V.email}`)){o.value=V.id;try{await st.request(`/api/admin/users/${encodeURIComponent(V.id)}`,{method:"PATCH",body:{status:O}}),await p()}catch(mt){r.value=mt?.message||""}finally{o.value=""}}}async function _(V){if(window.confirm(`${V.email}`)){o.value=V.id;try{await st.request(`/api/admin/users/${encodeURIComponent(V.id)}/revoke-sessions`,{method:"POST"})}catch(O){r.value=O?.message||""}finally{o.value=""}}}function w(V){a.value=V,u.value={id:V.id,email:V.email,displayName:V.display_name||"",status:V.status||"active"},d.value=""}function y(){a.value=null}async function M(){d.value="",c.value=!0;try{const V={email:u.value.email.trim(),displayName:u.value.displayName.trim()||null,status:u.value.status};await st.request(`/api/admin/users/${encodeURIComponent(u.value.id)}`,{method:"PATCH",body:V}),a.value=null,await p()}catch(V){d.value=V?.message||""}finally{c.value=!1}}async function D(V){const O=window.prompt(" IDUUIDID","");if(O===null)return;if(O.trim()!==V.id)return r.value="ID  UUID/";const B=window.prompt("","");if(B===null)return;if(B.trim().toLowerCase()!==String(V.email||"").toLowerCase())return r.value="";const mt=window.prompt(" DELETE","");if(mt===null)return;if(mt.trim()!=="DELETE")return r.value=" DELETE";const Tt=window.prompt("","")??"";o.value=V.id;try{await st.request(`/api/admin/users/${encodeURIComponent(V.id)}/delete`,{method:"POST",body:{confirmUserId:V.id,confirmEmail:V.email,confirmText:"DELETE",note:Tt.trim()||void 0}}),a.value=null,await p()}catch(At){r.value=At?.message||""}finally{o.value=""}}async function X(V){const O=String(V||"").trim();if(O)try{await navigator.clipboard.writeText(O)}catch{window.prompt("",O)}}function nt(){l.value=Math.max(0,l.value-Gi),p()}function Z(){l.value+=Gi,p()}return ae(p),(V,O)=>(C(),Xt(js,{title:"",subtitle:"/"},{default:bt(()=>[h("div",lw,[h("div",aw,[h("div",uw,[et(h("input",{"onUpdate:modelValue":O[0]||(O[0]=B=>t.value=B),class:"form-input",placeholder:" / ",onKeydown:yo(v,["enter"])},null,544),[[lt,t.value]]),h("button",{class:"btn btn-secondary",type:"button",disabled:n.value,onClick:v},x(n.value?"...":""),9,hw)])]),h("div",cw,[r.value?(C(),k("p",dw,x(r.value),1)):K("",!0),h("table",fw,[O[5]||(O[5]=h("thead",null,[h("tr",null,[h("th",null,"ID"),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,"/"),h("th",null,""),h("th",null,"")])],-1)),h("tbody",null,[(C(!0),k(pt,null,Jt(e.value,B=>(C(),k("tr",{key:B.id},[h("td",null,[h("code",null,x(B.id),1)]),h("td",null,x(B.email),1),h("td",null,x(B.display_name||"-"),1),h("td",null,x(B.status),1),h("td",null,x(B.email_verified_at?"":"-"),1),h("td",null,x(B.deleted_at?f(B.deleted_at):"-"),1),h("td",null,x(f(B.created_at)),1),h("td",null,[h("div",pw,[h("button",{class:"btn btn-secondary btn-sm",type:"button",disabled:o.value===B.id||!!B.deleted_at,onClick:mt=>g(B)},x(B.status==="disabled"?"":""),9,mw),h("button",{class:"btn btn-danger btn-sm",type:"button",disabled:o.value===B.id||!!B.deleted_at,onClick:mt=>_(B)},"  ",8,vw),h("button",{class:"btn btn-secondary btn-sm",type:"button",disabled:o.value===B.id||!!B.deleted_at,onClick:mt=>w(B)},"  ",8,gw),h("button",{class:"btn btn-secondary btn-sm",type:"button",onClick:mt=>X(B.id)}," ID ",8,bw),h("button",{class:"btn btn-danger btn-sm",type:"button",disabled:o.value===B.id||!!B.deleted_at,onClick:mt=>D(B)},"  ",8,yw)])])]))),128)),!e.value.length&&!n.value?(C(),k("tr",_w,[...O[4]||(O[4]=[h("td",{colspan:"8",class:"text-muted"},"",-1)])])):K("",!0)])]),h("div",ww,[h("button",{class:"btn btn-secondary",type:"button",disabled:n.value||l.value===0,onClick:nt},"  ",8,Sw),h("div",xw," "+x(i.value)+" ",1),h("button",{class:"btn btn-secondary",type:"button",disabled:n.value||l.value+Gi>=i.value,onClick:Z},"  ",8,Cw)])])]),a.value?(C(),k("div",Ew,[h("div",Tw,[O[10]||(O[10]=h("div",{class:"card-title"},"",-1)),h("div",kw,[h("div",Mw,[O[6]||(O[6]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":O[1]||(O[1]=B=>u.value.email=B),class:"form-input"},null,512),[[lt,u.value.email]])]),h("div",Aw,[O[7]||(O[7]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":O[2]||(O[2]=B=>u.value.displayName=B),class:"form-input"},null,512),[[lt,u.value.displayName]])]),h("div",Ow,[O[9]||(O[9]=h("label",{class:"form-label"},"",-1)),et(h("select",{"onUpdate:modelValue":O[3]||(O[3]=B=>u.value.status=B),class:"form-input"},[...O[8]||(O[8]=[h("option",{value:"active"},"active",-1),h("option",{value:"disabled"},"disabled",-1)])],512),[[Ae,u.value.status]])])]),h("div",Lw,[h("button",{class:"btn btn-primary",type:"button",disabled:c.value,onClick:M},x(c.value?"...":""),9,Pw),h("button",{class:"btn btn-secondary",type:"button",disabled:c.value,onClick:y},"",8,Rw)]),d.value?(C(),k("p",Nw,x(d.value),1)):K("",!0)])])):K("",!0)]),_:1}))}},Dw={class:"card"},Iw={class:"card-content banner-row"},Bw={class:"input-with-button",style:{width:"100%"}},Vw=["disabled"],Fw={class:"card-content"},Uw={key:0,class:"form-error"},zw={class:"data-table"},qw={key:0},Ww={class:"mt-16 input-with-button"},Hw=["disabled"],Kw={class:"text-muted"},jw=["disabled"],Ji=50,Gw={__name:"AdminOrganizationsPage",setup(s){const t=$(""),e=$([]),i=$(0),n=$(!1),r=$(""),o=$(0);function l(f){if(!f)return"-";try{return new Date(f).toISOString().slice(0,10)}catch{return String(f)}}async function a(){r.value="",n.value=!0;try{const f=new URLSearchParams({limit:String(Ji),offset:String(o.value),q:t.value.trim()}),p=await st.request(`/api/admin/organizations?${f.toString()}`);e.value=p.items||[],i.value=Number(p.total||0)}catch(f){r.value=f?.message||""}finally{n.value=!1}}async function u(){o.value=0,await a()}function c(){o.value=Math.max(0,o.value-Ji),a()}function d(){o.value+=Ji,a()}return ae(a),(f,p)=>(C(),Xt(js,{title:"",subtitle:""},{default:bt(()=>[h("div",Dw,[h("div",Iw,[h("div",Bw,[et(h("input",{"onUpdate:modelValue":p[0]||(p[0]=v=>t.value=v),class:"form-input",placeholder:" / slug",onKeydown:yo(u,["enter"])},null,544),[[lt,t.value]]),h("button",{class:"btn btn-secondary",type:"button",disabled:n.value,onClick:u},x(n.value?"...":""),9,Vw)])]),h("div",Fw,[r.value?(C(),k("p",Uw,x(r.value),1)):K("",!0),h("table",zw,[p[2]||(p[2]=h("thead",null,[h("tr",null,[h("th",null,""),h("th",null,"Slug"),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,"")])],-1)),h("tbody",null,[(C(!0),k(pt,null,Jt(e.value,v=>(C(),k("tr",{key:v.id},[h("td",null,x(v.name),1),h("td",null,[h("code",null,x(v.slug),1)]),h("td",null,x(v.member_count),1),h("td",null,x(v.subscription_plan_code||"-"),1),h("td",null,x(v.subscription_status||"-"),1),h("td",null,x(l(v.subscription_current_period_end)),1),h("td",null,x(l(v.created_at)),1)]))),128)),!e.value.length&&!n.value?(C(),k("tr",qw,[...p[1]||(p[1]=[h("td",{colspan:"7",class:"text-muted"},"",-1)])])):K("",!0)])]),h("div",Ww,[h("button",{class:"btn btn-secondary",type:"button",disabled:n.value||o.value===0,onClick:c},"  ",8,Hw),h("div",Kw," "+x(i.value)+" ",1),h("button",{class:"btn btn-secondary",type:"button",disabled:n.value||o.value+Ji>=i.value,onClick:d},"  ",8,jw)])])])]),_:1}))}},Jw={class:"card"},Xw={class:"card-content"},Yw={class:"grid grid-3"},Qw={class:"form-group"},Zw={class:"form-group"},tS={class:"form-group"},eS={class:"input-with-button"},sS=["disabled"],iS={key:0,class:"form-error mt-16"},nS={class:"mt-16"},rS={class:"data-table"},oS={class:"text-muted"},lS={class:"input-with-button"},aS=["disabled","onClick"],uS=["disabled","onClick"],hS={key:0},cS={class:"mt-16 input-with-button"},dS=["disabled"],fS={class:"text-muted"},pS=["disabled"],mS={key:0,class:"card"},vS={class:"card-content"},gS={class:"grid grid-3 mt-16"},bS={class:"form-group"},yS={class:"form-group"},_S={class:"form-group"},wS={class:"grid grid-3 mt-16"},SS={class:"form-group"},xS={class:"form-group"},CS={class:"input-with-button mt-16"},ES=["disabled"],TS=["disabled"],kS={key:0,class:"form-error mt-16"},Xi=50,MS={__name:"AdminSubscriptionsPage",setup(s){const t=$(""),e=$(""),i=$(""),n=$([]),r=$(0),o=$(!1),l=$(""),a=$(null),u=$({planCode:"",status:"",currentPeriodEndLocal:"",extendDays:null,cancelAtPeriodEnd:null}),c=$(""),d=$(""),f=$(0);function p(V){if(!V)return"-";try{return new Date(V).toISOString().replace("T"," ").slice(0,19)}catch{return String(V)}}function v(V){if(!V)return"";try{const O=new Date(V),B=mt=>String(mt).padStart(2,"0");return`${O.getFullYear()}-${B(O.getMonth()+1)}-${B(O.getDate())}T${B(O.getHours())}:${B(O.getMinutes())}`}catch{return""}}function g(V){const O=String(V||"").trim();if(!O)return"";const B=new Date(O);return Number.isFinite(B.getTime())?B.toISOString():""}async function _(){l.value="",o.value=!0;try{const V=new URLSearchParams({limit:String(Xi),offset:String(f.value),q:t.value.trim(),provider:e.value,status:i.value}),O=await st.request(`/api/admin/subscriptions?${V.toString()}`);n.value=O.items||[],r.value=Number(O.total||0)}catch(V){l.value=V?.message||""}finally{o.value=!1}}function w(V){a.value=V,u.value={planCode:V.plan_code||"",status:V.status||"",currentPeriodEndLocal:v(V.current_period_end),extendDays:null,cancelAtPeriodEnd:null},d.value=""}function y(){a.value=null}async function M(){if(a.value){d.value="",c.value=a.value.id;try{const V={planCode:u.value.planCode.trim()||void 0,status:u.value.status.trim()||void 0,currentPeriodEnd:g(u.value.currentPeriodEndLocal)||void 0,extendDays:u.value.extendDays?Number(u.value.extendDays):void 0,cancelAtPeriodEnd:u.value.cancelAtPeriodEnd===null?void 0:!!u.value.cancelAtPeriodEnd};if(V.currentPeriodEnd&&V.extendDays)return d.value="";await st.request(`/api/admin/subscriptions/${encodeURIComponent(a.value.id)}`,{method:"PATCH",body:V}),a.value=null,await _()}catch(V){d.value=V?.message||""}finally{c.value=""}}}async function D(V){c.value=V.id;try{await st.request("/api/admin/stripe/subscriptions/sync",{method:"POST",body:{organizationId:V.organization_id}}),await _()}catch(O){l.value=O?.message||""}finally{c.value=""}}async function X(){f.value=0,await _()}function nt(){f.value=Math.max(0,f.value-Xi),_()}function Z(){f.value+=Xi,_()}return ae(_),(V,O)=>(C(),Xt(js,{title:"",subtitle:""},{default:bt(()=>[h("div",Jw,[h("div",Xw,[h("div",Yw,[h("div",Qw,[O[8]||(O[8]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":O[0]||(O[0]=B=>t.value=B),class:"form-input",placeholder:" / slug",onKeydown:yo(X,["enter"])},null,544),[[lt,t.value]])]),h("div",Zw,[O[10]||(O[10]=h("label",{class:"form-label"},"Provider",-1)),et(h("select",{"onUpdate:modelValue":O[1]||(O[1]=B=>e.value=B),class:"form-input"},[...O[9]||(O[9]=[h("option",{value:""},"",-1),h("option",{value:"stripe"},"stripe",-1),h("option",{value:"activation_code"},"activation_code",-1)])],512),[[Ae,e.value]])]),h("div",tS,[O[12]||(O[12]=h("label",{class:"form-label"},"",-1)),et(h("select",{"onUpdate:modelValue":O[2]||(O[2]=B=>i.value=B),class:"form-input"},[...O[11]||(O[11]=[h("option",{value:""},"",-1),h("option",{value:"active"},"active",-1),h("option",{value:"canceled"},"canceled",-1),h("option",{value:"incomplete"},"incomplete",-1),h("option",{value:"incomplete_expired"},"incomplete_expired",-1),h("option",{value:"past_due"},"past_due",-1),h("option",{value:"unpaid"},"unpaid",-1)])],512),[[Ae,i.value]])])]),h("div",eS,[h("button",{class:"btn btn-secondary",type:"button",disabled:o.value,onClick:X},x(o.value?"...":""),9,sS)]),l.value?(C(),k("p",iS,x(l.value),1)):K("",!0),h("div",nS,[h("table",rS,[O[14]||(O[14]=h("thead",null,[h("tr",null,[h("th",null,""),h("th",null,""),h("th",null,"Provider"),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,"")])],-1)),h("tbody",null,[(C(!0),k(pt,null,Jt(n.value,B=>(C(),k("tr",{key:B.id},[h("td",null,[kt(x(B.organization_name)+" ",1),h("span",oS,"("+x(B.organization_slug)+")",1)]),h("td",null,x(B.plan_code),1),h("td",null,x(B.provider),1),h("td",null,x(B.status),1),h("td",null,x(p(B.current_period_end)),1),h("td",null,x(p(B.created_at)),1),h("td",null,[h("div",lS,[h("button",{class:"btn btn-secondary btn-sm",type:"button",disabled:c.value===B.id||B.provider!=="activation_code",onClick:mt=>w(B)},"  ",8,aS),h("button",{class:"btn btn-secondary btn-sm",type:"button",disabled:c.value===B.id||B.provider!=="stripe",onClick:mt=>D(B)},"  ",8,uS)])])]))),128)),!n.value.length&&!o.value?(C(),k("tr",hS,[...O[13]||(O[13]=[h("td",{colspan:"7",class:"text-muted"},"",-1)])])):K("",!0)])])]),h("div",cS,[h("button",{class:"btn btn-secondary",type:"button",disabled:o.value||f.value===0,onClick:nt},"  ",8,dS),h("div",fS," "+x(r.value)+" ",1),h("button",{class:"btn btn-secondary",type:"button",disabled:o.value||f.value+Xi>=r.value,onClick:Z},"  ",8,pS)])])]),a.value?(C(),k("div",mS,[h("div",vS,[O[21]||(O[21]=h("div",{class:"card-title"},"",-1)),O[22]||(O[22]=h("div",{class:"text-muted mt-16"},"Stripe  Stripe ",-1)),h("div",gS,[h("div",bS,[O[15]||(O[15]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":O[3]||(O[3]=B=>u.value.planCode=B),class:"form-input"},null,512),[[lt,u.value.planCode]])]),h("div",yS,[O[16]||(O[16]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":O[4]||(O[4]=B=>u.value.status=B),class:"form-input"},null,512),[[lt,u.value.status]])]),h("div",_S,[O[17]||(O[17]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":O[5]||(O[5]=B=>u.value.currentPeriodEndLocal=B),class:"form-input",type:"datetime-local"},null,512),[[lt,u.value.currentPeriodEndLocal]])])]),h("div",wS,[h("div",SS,[O[18]||(O[18]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":O[6]||(O[6]=B=>u.value.extendDays=B),class:"form-input",type:"number",min:"1",max:"3650"},null,512),[[lt,u.value.extendDays,void 0,{number:!0}]])]),h("div",xS,[O[20]||(O[20]=h("label",{class:"form-label"},"",-1)),et(h("select",{"onUpdate:modelValue":O[7]||(O[7]=B=>u.value.cancelAtPeriodEnd=B),class:"form-input"},[...O[19]||(O[19]=[h("option",{value:null},"",-1),h("option",{value:!0},"true",-1),h("option",{value:!1},"false",-1)])],512),[[Ae,u.value.cancelAtPeriodEnd]])])]),h("div",CS,[h("button",{class:"btn btn-primary",type:"button",disabled:c.value===a.value.id,onClick:M},x(c.value===a.value.id?"...":""),9,ES),h("button",{class:"btn btn-secondary",type:"button",disabled:c.value===a.value.id,onClick:y},"",8,TS)]),d.value?(C(),k("p",kS,x(d.value),1)):K("",!0)])])):K("",!0)]),_:1}))}},AS={class:"card"},OS={class:"grid grid-3"},LS={class:"form-group"},PS={class:"form-group"},RS={class:"form-group"},NS={class:"grid grid-3"},$S={class:"form-group"},DS={class:"form-group"},IS={class:"form-group"},BS=["disabled"],VS={key:0,class:"form-error"},FS={key:1,class:"form-success"},US={key:2,class:"mt-16"},zS={class:"data-table"},qS={class:"card"},WS={class:"card-content"},HS=["disabled"],KS={key:0,class:"form-error"},jS={class:"mt-16"},GS={class:"data-table"},JS=["disabled","onClick"],XS={__name:"AdminActivationCodesPage",setup(s){const t=xs(),e=Gt({planCode:"monthly",durationDays:30,count:1,maxRedemptions:1,expiresAt:"",note:""}),i=$([]),n=$([]),r=$(!1),o=$(""),l=$(!1),a=$(""),u=$("");function c(v){if(!v)return"-";try{return new Date(v).toISOString().slice(0,10)}catch{return String(v)}}async function d(){a.value="",l.value=!0;try{const v=await st.request("/api/admin/activation-codes?limit=50&offset=0");i.value=v.items||[]}catch(v){if(v?.status===403)return t.push("/app");a.value=v?.message||""}finally{l.value=!1}}async function f(){o.value="",n.value=[],r.value=!0;try{const v={planCode:e.planCode.trim(),durationDays:Number(e.durationDays),count:Number(e.count||1),maxRedemptions:Number(e.maxRedemptions||1),note:e.note.trim()||void 0};e.expiresAt.trim()&&(v.expiresAt=e.expiresAt.trim());const g=await st.request("/api/admin/activation-codes",{method:"POST",body:v});n.value=g.codes||[],await d()}catch(v){if(v?.status===403)return t.push("/app");o.value=v?.message||""}finally{r.value=!1}}async function p(v){u.value=v;try{await st.request(`/api/admin/activation-codes/${encodeURIComponent(v)}/revoke`,{method:"POST"}),await d()}catch(g){a.value=g?.message||""}finally{u.value=""}}return ae(d),(v,g)=>(C(),Xt(js,{title:"",subtitle:""},{default:bt(()=>[h("div",AS,[g[13]||(g[13]=h("h2",{class:"card-title"},"",-1)),h("form",{class:"card-content",onSubmit:ys(f,["prevent"])},[h("div",OS,[h("div",LS,[g[6]||(g[6]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":g[0]||(g[0]=_=>e.planCode=_),class:"form-input",placeholder:"monthly / yearly",required:""},null,512),[[lt,e.planCode]])]),h("div",PS,[g[7]||(g[7]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":g[1]||(g[1]=_=>e.durationDays=_),class:"form-input",type:"number",min:"1",required:""},null,512),[[lt,e.durationDays,void 0,{number:!0}]])]),h("div",RS,[g[8]||(g[8]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":g[2]||(g[2]=_=>e.count=_),class:"form-input",type:"number",min:"1",max:"100"},null,512),[[lt,e.count,void 0,{number:!0}]])])]),h("div",NS,[h("div",$S,[g[9]||(g[9]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":g[3]||(g[3]=_=>e.maxRedemptions=_),class:"form-input",type:"number",min:"1",max:"1000"},null,512),[[lt,e.maxRedemptions,void 0,{number:!0}]])]),h("div",DS,[g[10]||(g[10]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":g[4]||(g[4]=_=>e.expiresAt=_),class:"form-input",placeholder:"2026-01-01T00:00:00.000Z"},null,512),[[lt,e.expiresAt]])]),h("div",IS,[g[11]||(g[11]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":g[5]||(g[5]=_=>e.note=_),class:"form-input",maxlength:"2000"},null,512),[[lt,e.note]])])]),h("button",{class:"btn btn-primary",type:"submit",disabled:r.value},x(r.value?"...":""),9,BS),o.value?(C(),k("p",VS,x(o.value),1)):K("",!0),n.value.length?(C(),k("p",FS," "+x(n.value.length)+" ",1)):K("",!0),n.value.length?(C(),k("div",US,[h("table",zS,[g[12]||(g[12]=h("thead",null,[h("tr",null,[h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,"")])],-1)),h("tbody",null,[(C(!0),k(pt,null,Jt(n.value,_=>(C(),k("tr",{key:_.id},[h("td",null,[h("code",null,x(_.plaintext),1)]),h("td",null,x(_.plan_code),1),h("td",null,x(_.duration_days),1),h("td",null,x(_.max_redemptions),1),h("td",null,x(c(_.expires_at)),1)]))),128))])])])):K("",!0)],32)]),h("div",qS,[g[15]||(g[15]=h("h2",{class:"card-title"},"",-1)),h("div",WS,[h("button",{class:"btn btn-secondary",type:"button",onClick:d,disabled:l.value},x(l.value?"...":""),9,HS),a.value?(C(),k("p",KS,x(a.value),1)):K("",!0),h("div",jS,[h("table",GS,[g[14]||(g[14]=h("thead",null,[h("tr",null,[h("th",null,"ID"),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,"")])],-1)),h("tbody",null,[(C(!0),k(pt,null,Jt(i.value,_=>(C(),k("tr",{key:_.id},[h("td",null,[h("code",null,x(_.id),1)]),h("td",null,x(_.plan_code),1),h("td",null,x(_.duration_days),1),h("td",null,x(_.redeemed_count),1),h("td",null,x(_.max_redemptions),1),h("td",null,x(c(_.expires_at)),1),h("td",null,x(_.revoked_at?"":"-"),1),h("td",null,x(c(_.created_at)),1),h("td",null,[h("button",{class:"btn btn-danger btn-sm",type:"button",disabled:!!_.revoked_at||u.value===_.id,onClick:w=>p(_.id)},x(u.value===_.id?"...":""),9,JS)])]))),128))])])])])])]),_:1}))}},YS={class:"card"},QS={class:"grid grid-3"},ZS={class:"form-group"},tx={class:"form-group"},ex={class:"form-group"},sx={class:"grid grid-3"},ix={class:"form-group"},nx={class:"form-group"},rx={class:"form-group"},ox=["disabled"],lx={key:0,class:"form-error"},ax={class:"card"},ux={class:"card-content"},hx=["disabled"],cx={key:0,class:"form-error"},dx={class:"mt-16"},fx={class:"data-table"},px=["onClick"],mx={key:0,class:"card"},vx={class:"grid grid-3"},gx={class:"form-group"},bx={class:"form-group"},yx={class:"form-group"},_x={class:"grid grid-3"},wx={class:"form-group"},Sx={class:"form-group"},xx={class:"input-with-button"},Cx=["disabled"],Ex={key:0,class:"form-error"},Tx={__name:"AdminAIProvidersPage",setup(s){const t=xs(),e=$([]),i=$(!1),n=$(""),r=Gt({code:"",displayName:"",modelName:"",baseUrl:"",multiplier:1,isActive:!0}),o=$(!1),l=$(""),a=$(null),u=Gt({id:"",displayName:"",modelName:"",baseUrl:"",multiplier:1,isActive:!0}),c=$(!1),d=$("");async function f(){n.value="",i.value=!0;try{const w=await st.request("/api/admin/ai-providers?limit=200&offset=0");e.value=w.items||[]}catch(w){if(w?.status===403)return t.push("/app");n.value=w?.message||""}finally{i.value=!1}}async function p(){l.value="",o.value=!0;try{const w={code:r.code.trim(),displayName:r.displayName.trim(),modelName:r.modelName.trim(),baseUrl:r.baseUrl.trim()||void 0,multiplier:Number(r.multiplier||1),isActive:!!r.isActive};await st.request("/api/admin/ai-providers",{method:"POST",body:w}),r.code="",r.displayName="",r.modelName="",r.baseUrl="",r.multiplier=1,r.isActive=!0,await f()}catch(w){if(w?.status===403)return t.push("/app");l.value=w?.message||""}finally{o.value=!1}}function v(w){a.value=w,u.id=w.id,u.displayName=w.display_name,u.modelName=w.model_name,u.baseUrl=w.base_url||"",u.multiplier=Number(w.multiplier_x100||100)/100,u.isActive=!!w.is_active,d.value=""}function g(){a.value=null}async function _(){d.value="",c.value=!0;try{const w={displayName:u.displayName.trim(),modelName:u.modelName.trim(),baseUrl:u.baseUrl.trim()||null,multiplier:Number(u.multiplier||1),isActive:!!u.isActive};await st.request(`/api/admin/ai-providers/${encodeURIComponent(u.id)}`,{method:"PUT",body:w}),a.value=null,await f()}catch(w){if(w?.status===403)return t.push("/app");d.value=w?.message||""}finally{c.value=!1}}return ae(f),(w,y)=>(C(),Xt(js,{title:"",subtitle:""},{default:bt(()=>[h("div",YS,[y[18]||(y[18]=h("h2",{class:"card-title"},"",-1)),h("form",{class:"card-content",onSubmit:ys(p,["prevent"])},[h("div",QS,[h("div",ZS,[y[11]||(y[11]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":y[0]||(y[0]=M=>r.code=M),class:"form-input",placeholder:"openai_gpt4o",required:""},null,512),[[lt,r.code]])]),h("div",tx,[y[12]||(y[12]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":y[1]||(y[1]=M=>r.displayName=M),class:"form-input",placeholder:"OpenAI GPT-4o",required:""},null,512),[[lt,r.displayName]])]),h("div",ex,[y[13]||(y[13]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":y[2]||(y[2]=M=>r.modelName=M),class:"form-input",placeholder:"gpt-4o-mini",required:""},null,512),[[lt,r.modelName]])])]),h("div",sx,[h("div",ix,[y[14]||(y[14]=h("label",{class:"form-label"},"API ",-1)),et(h("input",{"onUpdate:modelValue":y[3]||(y[3]=M=>r.baseUrl=M),class:"form-input",placeholder:"https://api.openai.com/v1"},null,512),[[lt,r.baseUrl]])]),h("div",nx,[y[15]||(y[15]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":y[4]||(y[4]=M=>r.multiplier=M),class:"form-input",type:"number",min:"0.01",step:"0.01"},null,512),[[lt,r.multiplier,void 0,{number:!0}]])]),h("div",rx,[y[17]||(y[17]=h("label",{class:"form-label"},"",-1)),et(h("select",{"onUpdate:modelValue":y[5]||(y[5]=M=>r.isActive=M),class:"form-input"},[...y[16]||(y[16]=[h("option",{value:!0},"",-1),h("option",{value:!1},"",-1)])],512),[[Ae,r.isActive]])])]),h("button",{class:"btn btn-primary",type:"submit",disabled:o.value},x(o.value?"...":""),9,ox),l.value?(C(),k("p",lx,x(l.value),1)):K("",!0)],32)]),h("div",ax,[y[20]||(y[20]=h("h2",{class:"card-title"},"",-1)),h("div",ux,[h("button",{class:"btn btn-secondary",type:"button",onClick:f,disabled:i.value},x(i.value?"...":""),9,hx),n.value?(C(),k("p",cx,x(n.value),1)):K("",!0),h("div",dx,[h("table",fx,[y[19]||(y[19]=h("thead",null,[h("tr",null,[h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,""),h("th",null,"")])],-1)),h("tbody",null,[(C(!0),k(pt,null,Jt(e.value,M=>(C(),k("tr",{key:M.id},[h("td",null,x(M.code),1),h("td",null,x(M.display_name),1),h("td",null,x(M.model_name),1),h("td",null,x((M.multiplier_x100/100).toFixed(2))+"x",1),h("td",null,x(M.is_active?"":""),1),h("td",null,[h("button",{class:"btn btn-secondary btn-sm",type:"button",onClick:D=>v(M)},"",8,px)])]))),128))])])])])]),a.value?(C(),k("div",mx,[y[27]||(y[27]=h("h2",{class:"card-title"},"",-1)),h("form",{class:"card-content",onSubmit:ys(_,["prevent"])},[h("div",vx,[h("div",gx,[y[21]||(y[21]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":y[6]||(y[6]=M=>u.displayName=M),class:"form-input",required:""},null,512),[[lt,u.displayName]])]),h("div",bx,[y[22]||(y[22]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":y[7]||(y[7]=M=>u.modelName=M),class:"form-input",required:""},null,512),[[lt,u.modelName]])]),h("div",yx,[y[23]||(y[23]=h("label",{class:"form-label"},"API ",-1)),et(h("input",{"onUpdate:modelValue":y[8]||(y[8]=M=>u.baseUrl=M),class:"form-input"},null,512),[[lt,u.baseUrl]])])]),h("div",_x,[h("div",wx,[y[24]||(y[24]=h("label",{class:"form-label"},"",-1)),et(h("input",{"onUpdate:modelValue":y[9]||(y[9]=M=>u.multiplier=M),class:"form-input",type:"number",min:"0.01",step:"0.01"},null,512),[[lt,u.multiplier,void 0,{number:!0}]])]),h("div",Sx,[y[26]||(y[26]=h("label",{class:"form-label"},"",-1)),et(h("select",{"onUpdate:modelValue":y[10]||(y[10]=M=>u.isActive=M),class:"form-input"},[...y[25]||(y[25]=[h("option",{value:!0},"",-1),h("option",{value:!1},"",-1)])],512),[[Ae,u.isActive]])])]),h("div",xx,[h("button",{class:"btn btn-primary",type:"submit",disabled:c.value},x(c.value?"...":""),9,Cx),h("button",{class:"btn btn-secondary",type:"button",onClick:g},"")]),d.value?(C(),k("p",Ex,x(d.value),1)):K("",!0)],32)])):K("",!0)]),_:1}))}},kx=[{path:"/",redirect:"/app"},{path:"/login",component:Op,meta:{guestOnly:!0}},{path:"/register",component:Fp,meta:{guestOnly:!0}},{path:"/verify-email",component:Qp},{path:"/app",component:Hm,meta:{requiresAuth:!0}},{path:"/app/ai",component:T_,meta:{requiresAuth:!0}},{path:"/app/providers",component:_1,meta:{requiresAuth:!0}},{path:"/app/subscription",component:Ov,meta:{requiresAuth:!0}},{path:"/app/admin/codes",redirect:"/admin/activation-codes"},{path:"/app/admin/providers",redirect:"/admin/providers"},{path:"/admin",redirect:"/admin/overview"},{path:"/admin/overview",component:ow,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/users",component:$w,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/organizations",component:Gw,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/subscriptions",component:MS,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/activation-codes",component:XS,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/admin/providers",component:Tx,meta:{requiresAuth:!0,requiresAdmin:!0}}],Uh=fp({history:jf(),routes:kx});Uh.beforeEach(async s=>{const t=Ge();return t.initialized.value||await t.init(),s.meta.requiresAuth&&!t.user.value?"/login":s.meta.requiresAdmin&&!t.isAdmin.value||s.meta.guestOnly&&t.user.value?"/app":!0});const zh=lf(pp),Mx=Ge();await Mx.init();zh.use(Uh);zh.mount("#app");
